{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui/assets\\scripts\\battle\\ui\\ItemRank.js"],"names":["UIUtil","require","Tools","PlayerData","ConfigData","cc","Class","extends","Component","properties","iconSprite","Sprite","nameLabel","Label","goldRateLabel","achieveNode","Node","keepNode","kingNode","kingLabel","unlockRootNode","unlockBuffNode","unlockBuffLabel","unlockBuffIcon","unlockMapNode","unlockMapLabel","unlockMapIcon","unlockSpecialNode","unlockSpecialLabel","unlockSpecialIcon","unlockBoxNode","unlockBoxLabel","unlockBoxIcon","unlockWaitNode","rankStarNode","rankNoStarNode","init","data","isAchieve","isKeep","str","name","string","replace","getStringByFormat","instance","getUITipStr","Math","ceil","goldMultiRate","loadResSprite","url","active","isKing","levelUpStar","star","rankStar","refreshRankStar","refreshUnlock","unlockBuff","unlockTips","unlockBuffIcons","children","unlockMap","unlockMapTips","unlockMapIcons","unlockSpecial","unlockSpecialTips","unlockSpecialIcons","unlockBox","unlockBoxTips","unlockBoxIcons","unlockWait","curStar","rankData","stars","noStars","interval","i","length","isGet","isShow","opacity","x","y","abs"],"mappings":"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","file":"ItemRank.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui","sourcesContent":["const UIUtil = require('UIUtil');\r\nconst Tools = require('Tools');\r\nconst PlayerData = require('PlayerData');\r\nconst ConfigData = require('ConfigData');\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n\r\n        iconSprite: cc.Sprite,\r\n        nameLabel: cc.Label,\r\n        goldRateLabel: cc.Label,\r\n\r\n        achieveNode: cc.Node,\r\n        keepNode: cc.Node,\r\n\r\n\r\n        kingNode: cc.Node,\r\n        kingLabel: cc.Label,\r\n\r\n        unlockRootNode: cc.Node,\r\n\r\n        unlockBuffNode: cc.Node,\r\n        unlockBuffLabel: cc.Label,\r\n        unlockBuffIcon: cc.Node,\r\n\r\n        unlockMapNode: cc.Node,\r\n        unlockMapLabel: cc.Label,\r\n        unlockMapIcon: cc.Node,\r\n\r\n        unlockSpecialNode: cc.Node,\r\n        unlockSpecialLabel: cc.Label,\r\n        unlockSpecialIcon: cc.Node,\r\n\r\n        unlockBoxNode: cc.Node,\r\n        unlockBoxLabel: cc.Label,\r\n        unlockBoxIcon: cc.Node,\r\n\r\n        unlockWaitNode: cc.Node,\r\n\r\n        rankStarNode: cc.Node,\r\n        rankNoStarNode: cc.Node,\r\n    },\r\n\r\n\r\n\r\n    init: function (data, isAchieve, isKeep) {\r\n        this.data = data;\r\n        this.isKeep = isKeep;\r\n        var str = data.name;\r\n        this.nameLabel.string = str.replace(/[0-9]/ig, '');\r\n        this.goldRateLabel.string = Tools.getStringByFormat(ConfigData.instance.getUITipStr(12), Math.ceil((data.goldMultiRate * 100 + 100)));\r\n        UIUtil.loadResSprite(this.iconSprite, data.url);\r\n\r\n\r\n\r\n        this.achieveNode.active = isAchieve;\r\n        this.keepNode.active = isKeep;\r\n\r\n\r\n\r\n        var isKing = data.levelUpStar === 0;\r\n        this.kingNode.active = isKing ? true : false;\r\n        var star = PlayerData.instance.rankStar - data.star;\r\n        star = star < 0 ? 0 : star;\r\n        this.kingLabel.string = 'x' + star;\r\n\r\n        if (!isKing) {\r\n            this.refreshRankStar();\r\n        }\r\n\r\n    },\r\n\r\n\r\n    refreshUnlock(data) {\r\n        this.unlockBuffNode.active = false;\r\n        if (data.unlockBuff || data.unlockBuff === 0) {\r\n            this.unlockBuffNode.active = true;\r\n            this.unlockBuffLabel.string = data.unlockTips;\r\n            var unlockBuffIcons = this.unlockBuffIcon.children;\r\n            unlockBuffIcons[data.unlockBuff].active = true;\r\n        }\r\n\r\n        this.unlockMapNode.active = false;\r\n        if (data.unlockMap || data.unlockMap === 0) {\r\n            this.unlockMapNode.active = true;\r\n            this.unlockMapLabel.string = data.unlockMapTips;\r\n            var unlockMapIcons = this.unlockMapIcon.children;\r\n            unlockMapIcons[data.unlockMap].active = true;\r\n        }\r\n\r\n        this.unlockSpecialNode.active = false;\r\n        if (data.unlockSpecial || data.unlockSpecial === 0) {\r\n            this.unlockSpecialNode.active = true;\r\n            this.unlockSpecialLabel.string = data.unlockSpecialTips;\r\n            var unlockSpecialIcons = this.unlockSpecialIcon.children;\r\n            unlockSpecialIcons[data.unlockSpecial].active = true;\r\n        }\r\n\r\n        this.unlockBoxNode.active = false;\r\n        if (data.unlockBox || data.unlockBox === 0) {\r\n            this.unlockBoxNode.active = true;\r\n            this.unlockBoxLabel.string = data.unlockBoxTips;\r\n            var unlockBoxIcons = this.unlockBoxIcon.children;\r\n            unlockBoxIcons[data.unlockBox].active = true;\r\n        }\r\n\r\n        this.unlockWaitNode.active = data.unlockWait;\r\n\r\n    },\r\n    // update (dt) {},\r\n    refreshRankStar() {\r\n        var curStar = PlayerData.instance.rankStar;\r\n        var rankData = this.data;\r\n        var stars = this.rankStarNode.children;\r\n        var noStars = this.rankNoStarNode.children;\r\n        var interval = 60 / rankData.levelUpStar + 5;\r\n        for (let i = 0; i < stars.length; i++) {\r\n            var isGet = curStar > rankData.star + i;\r\n            var isShow = i < rankData.levelUpStar;\r\n            if (stars[i]) {\r\n                stars[i].opacity = isGet && isShow ? 255 : 0;\r\n                if (rankData.levelUpStar === 1) {\r\n                    stars[i].x = 0;\r\n                    stars[i].y = 0;\r\n                } else {\r\n                    stars[i].x = i * interval * 2 - interval * (rankData.levelUpStar - 1);\r\n                    if (stars[i].x === 0) {\r\n                        stars[i].y = 0;\r\n                    } else {\r\n                        stars[i].y += (Math.abs(stars[i].x)) / 2 - 7.5;\r\n                    }\r\n                }\r\n            }\r\n            // console.log(stars[i].x, stars[i].y)\r\n            if (noStars[i]) {\r\n                noStars[i].opacity = isShow ? 255 : 0;\r\n                noStars[i].x = stars[i].x;\r\n                noStars[i].y = stars[i].y;\r\n            }\r\n        }\r\n    },\r\n});"]}