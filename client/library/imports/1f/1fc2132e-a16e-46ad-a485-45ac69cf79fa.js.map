{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\entity/assets\\scripts\\battle\\entity\\EntityGuide.js"],"names":["Tools","require","GameData","AudioEngine","SoundID","NAME_COLOR","UIUtil","FrenzyAddType","HeroSkinProperty","HeroRebornEffectState","StageType","KnifeState","cc","Class","extends","Component","properties","ctx","Graphics","canDraw","beforeAnim","Animation","startAnim","endAnim","bgAnim","shadowNode","Node","colliderNode","init","player","bodyCollider","getComponent","Collider","tag","teamID","heroMove","getOrAddComponent","node","changeSpeedRate","moveTo","position","speedShadow","width","instance","screenWidth","height","screenHeight","on","catchEnemy","setShadow","active","pos","emit","playBeforeAnim","play","playStartAnim","isLocal","playEndAnim","once","setDraw","draw","updateGameLogic","dt","moveFix","myCamera","scale","camera","zoomRatio","updateDraw","v2","sub","lineTo","stroke","initWalls","type","walls","followPlayer","refresh"],"mappings":"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","file":"EntityGuide.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\entity","sourcesContent":["const Tools = require('Tools');\r\nconst GameData = require('GameData');\r\nconst AudioEngine = require('AudioEngine');\r\nconst SoundID = require('Types').SoundID;\r\nconst NAME_COLOR = require('Types').NAME_COLOR;\r\nconst UIUtil = require('UIUtil');\r\nconst FrenzyAddType = require('Types').FrenzyAddType;\r\nconst HeroSkinProperty = require('Types').HeroSkinProperty;\r\nconst HeroRebornEffectState = require('Types').HeroRebornEffectState;\r\nconst StageType = require('Types').StageType;\r\nconst KnifeState = require('Types').KnifeState;\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        ctx: cc.Graphics,\r\n        canDraw: true,\r\n        beforeAnim: cc.Animation,\r\n        startAnim: cc.Animation,\r\n        endAnim: cc.Animation,\r\n        bgAnim: cc.Animation,\r\n        shadowNode: cc.Node,\r\n        colliderNode: cc.Node,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    init(player) {\r\n        this.player = player;\r\n        this.bodyCollider = this.colliderNode.getComponent(cc.Collider);\r\n        this.bodyCollider.tag = player.teamID;;\r\n        this.heroMove = Tools.getOrAddComponent(this.node, 'HeroMove');\r\n        this.heroMove.changeSpeedRate(1.5);\r\n        this.ctx.moveTo(this.node.position);\r\n        this.speedShadow = Tools.getOrAddComponent(this.node, 'SpeedShadow');\r\n        this.speedShadow.init('texture/hero/effect-batman-06', this.shadowNode);\r\n        this.bgAnim.node.width = GameData.instance.screenWidth;\r\n        this.bgAnim.node.height = GameData.instance.screenHeight;\r\n\r\n        this.node.on('catchEnemy', this.catchEnemy, this)\r\n    },\r\n\r\n    setShadow(active) {\r\n        this.shadowNode.active = active;\r\n    },\r\n\r\n    catchEnemy(pos) {\r\n        this.node.position = pos;\r\n        this.player.node.emit('catchEnemyByBatMan');\r\n    },\r\n\r\n\r\n    playBeforeAnim() {\r\n        this.beforeAnim.node.active = true;\r\n        this.beforeAnim.play();\r\n    },\r\n\r\n    playStartAnim() {\r\n        this.endAnim.node.active = false;\r\n        this.startAnim.node.active = true;\r\n        this.startAnim.play();\r\n\r\n        if(this.player.isLocal){\r\n            this.bgAnim.node.active = true;\r\n            this.bgAnim.play();\r\n        }\r\n    },\r\n\r\n    playEndAnim() {\r\n        this.endAnim.node.active = true;\r\n        this.startAnim.node.active = false;\r\n        this.endAnim.play();\r\n        this.endAnim.once('finished', () => {\r\n            this.node.active = false;\r\n            this.bgAnim.node.active = false;\r\n        })\r\n    },\r\n\r\n    setDraw(draw) {\r\n        if (draw) {\r\n            this.canDraw = true;\r\n            this.ctx.moveTo(this.node.position)\r\n        } else {\r\n            this.canDraw = false;\r\n            // this.ctx.clear();\r\n        }\r\n    },\r\n\r\n    updateGameLogic(dt) {\r\n        // if (this.player) this.node.scale = this.player.node.scale;\r\n        if (this.heroMove) this.heroMove.updateGameLogic(dt);\r\n        if (this.speedShadow) this.speedShadow.updateGameLogic(dt);\r\n        if (this.moveFix) {\r\n            this.moveFix.updateGameLogic(dt);\r\n        }\r\n        if (this.player.myCamera) {\r\n            this.bgAnim.node.scale = 1 / this.player.myCamera.camera.zoomRatio / this.node.scale;\r\n        }\r\n\r\n        // this.updateDraw(dt);\r\n    },\r\n\r\n    updateDraw(dt) {\r\n        if (this.canDraw) {\r\n            this.ctx.node.position = cc.v2(0, 0).sub(this.node.position);\r\n            this.ctx.lineTo(this.node.position)\r\n            this.ctx.stroke();\r\n            this.ctx.moveTo(this.node.position)\r\n        }\r\n    },\r\n\r\n    initWalls: function (type, walls, width, height) {\r\n        switch (type) {\r\n            case 0:\r\n                this.moveFix = Tools.getOrAddComponent(this.node, 'HeroMoveFix');\r\n                this.moveFix.init(this.colliderNode.getComponent(cc.Collider));\r\n                this.moveFix.initWalls(walls);\r\n                break;\r\n            case 1:\r\n                this.moveFix = Tools.getOrAddComponent(this.node, 'HeroMoveFixByCircle');\r\n                this.moveFix.init(this.colliderNode.getComponent(cc.Collider), this.player.followPlayer);\r\n                this.moveFix.refresh(width, height);\r\n                break;\r\n        }\r\n    }\r\n});"]}