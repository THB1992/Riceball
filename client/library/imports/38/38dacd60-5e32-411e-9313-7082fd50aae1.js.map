{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui/assets\\scripts\\battle\\ui\\PanelHeroShop.js"],"names":["Tools","require","ConfigData","PlayerData","AdvertMgr","AdverType","ShareMgr","ShareType","TaskType","GameData","PlatformMgr","cc","Class","extends","Component","properties","topNode","Node","itemScrollView","ScrollView","itemScrollViewBar","itemScrollViewWindow","content","itemHeroSkin","Prefab","buyNode","unLockNode","nameLabel","Label","introduceLabel","initCountLabel","countLabel","propertyNode","propertyLabel","taskStartLabel","taskProgressLabel","taskFinalLabel","taskInfoNode","watchAdverBtnNode","downNode","watchAdverLabel","buyLangLabel","goLangLabel","jumpNode","shareIcon","adverIcon","_itemCells","_itemNodes","suitNode","suitNameLabel","suiProcessLabel","suitCloseIcon","suitActiveIcon","suitHeroNameLabel","suitKnifeNameLabel","suitSkillLabel","suitHeroFlag","suitKnifeFlag","suitHeroFalseFlag","suitKnifeFalseFlag","suitIconNode","init","world","instance","isPad","y","node","height","localPlayer","heroSkinDatas","slice","curTime","getCurTime","ownHeroSkins","filterDataByTime","clientData","hideSpecialSkin","isIOS","isApp","sort","a","b","newDate","isBeforeOtherTime","i","length","data","itemNode","instantiate","parent","itemComp","getComponent","setOnItemClick","refresh","onScrollView","curScrollHeight","getScrollOffset","Math","floor","active","count","isGet","isOwnHeroSkin","id","canUnlock","arrContains","completeTaskIds","taskId","needCheck","needCheckTaskIds","isNew","processStr","getWay","taskType","RANK","DUANWU","process","getTaskProcess","taskParam","heroSkin","onItemClick","setCheck","string","buyBtnClick","lastCheckItem","item","priceType","gold","price","addHeroSkin","updateGold","uiMgr","showTips","zongZi","updateZongZi","jumpBtnClick","closePanelShop","jumpParam","showPanelInvite","showPanelDailyTask","showPanelAddTop","showPanelSign","showPanelHolidayRank","unLockBtnClick","self","closeFunc","success","LOGIN","updateSignCount","refreshRedDot","showShare","showAdver","share","UnlockSkin","errFunc","event","customEventData","isInit","index","indexOf","scrollToOffset","v2","onEquipHeroSkin","lastEquipItem","setEquip","unlockWay","ADVERCOUNT","name","introduce","propertyTips","str","getStringByFormat","getUITipStr","suit","suitData","getSuitData","heroData","knifeData","getKnifeSkinById","knifeSkin","isOwnKnifeSkin","equipHero","isCurEquipHeroSkin","equipKnife","isCurEquipKnifeSkin","skillTips","children","showActiveSuitEffect","onWathAdverBtnClick","taskMgr","refreshTaskInHome","WatchAdver","close","closeCallcack","clearNeedCheckTaskIds","setCloseCallback","callback"],"mappings":"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","file":"PanelHeroShop.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui","sourcesContent":["const Tools = require('Tools');\r\nconst ConfigData = require('ConfigData');\r\nconst PlayerData = require('PlayerData');\r\nconst AdvertMgr = require('AdvertMgr');\r\nconst AdverType = require('Types').AdverType;\r\nconst ShareMgr = require('ShareMgr');\r\nconst ShareType = require('Types').ShareType;\r\nconst TaskType = require('Types').TaskType;\r\nconst GameData = require('GameData');\r\nconst PlatformMgr = require('PlatformMgr');\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        topNode: cc.Node,\r\n        itemScrollView: cc.ScrollView,\r\n        itemScrollViewBar: cc.Node,\r\n        itemScrollViewWindow: cc.Node,\r\n        content: cc.Node,\r\n        itemHeroSkin: cc.Prefab,\r\n\r\n        buyNode: cc.Node,\r\n        unLockNode: cc.Node,\r\n        nameLabel: cc.Label,\r\n        introduceLabel: cc.Label,\r\n        initCountLabel: cc.Label,\r\n        countLabel: cc.Label,\r\n\r\n        propertyNode: cc.Node,\r\n        propertyLabel: cc.Label,\r\n\r\n        taskStartLabel: cc.Label,\r\n        taskProgressLabel: cc.Label,\r\n        taskFinalLabel: cc.Label,\r\n\r\n        taskInfoNode: cc.Node,\r\n        watchAdverBtnNode: cc.Node,\r\n        downNode: cc.Node,\r\n\r\n        watchAdverLabel: cc.Label,\r\n        buyLangLabel: cc.Label,\r\n        goLangLabel: cc.Label,\r\n\r\n        jumpNode: cc.Node,\r\n        //解锁btn的图标\r\n        shareIcon: cc.Node,\r\n        adverIcon: cc.Node,\r\n\r\n        _itemCells: [],\r\n        _itemNodes: [],\r\n\r\n\r\n        //套装\r\n        suitNode: cc.Node,\r\n        suitNameLabel: cc.Label,\r\n        suiProcessLabel: cc.Label,\r\n        suitCloseIcon: cc.Node,\r\n        suitActiveIcon: cc.Node,\r\n        suitHeroNameLabel: cc.Label,\r\n        suitKnifeNameLabel: cc.Label,\r\n        suitSkillLabel: cc.Label,\r\n        suitHeroFlag: cc.Node,\r\n        suitKnifeFlag: cc.Node,\r\n        suitHeroFalseFlag: cc.Node,\r\n        suitKnifeFalseFlag: cc.Node,\r\n        suitIconNode: cc.Node,\r\n        // adverUnlockIcon: cc.Node,\r\n        // shareUnlockIcon: cc.Node,\r\n    },\r\n\r\n    init: function (world) {\r\n\r\n        if (GameData.instance.isPad()) {\r\n            this.topNode.y = -200;\r\n            this.itemScrollView.node.height = 200;\r\n            this.itemScrollViewWindow.height = 200;\r\n            this.itemScrollViewBar.height = 200;\r\n        } else {\r\n            this.topNode.y = 0;\r\n            this.itemScrollView.node.height = 400;\r\n            this.itemScrollViewWindow.height = 400;\r\n            this.itemScrollViewBar.height = 400;\r\n        }\r\n\r\n\r\n        this.world = world;\r\n        this.localPlayer = world.localPlayer;\r\n        var heroSkinDatas = ConfigData.instance.heroSkinDatas.slice();\r\n\r\n        var curTime = PlayerData.instance.getCurTime();\r\n        var ownHeroSkins = PlayerData.instance.ownHeroSkins;\r\n        Tools.filterDataByTime(heroSkinDatas, ownHeroSkins, curTime, GameData.instance, ConfigData.instance.clientData.hideSpecialSkin, PlatformMgr.isIOS(), PlatformMgr.isApp());\r\n\r\n        heroSkinDatas.sort((a, b) => {\r\n            if (a.newDate && Tools.isBeforeOtherTime(a.newDate, curTime)) {\r\n                return -1;\r\n            } else if (b.newDate && Tools.isBeforeOtherTime(b.newDate, curTime)) {\r\n                return 1;\r\n            } else {\r\n                return a.sort - b.sort;\r\n            }\r\n        })\r\n\r\n        for (let i = 0; i < heroSkinDatas.length; i++) {\r\n            var data = heroSkinDatas[i];\r\n            if (!this._itemNodes[i]) {\r\n                let itemNode = cc.instantiate(this.itemHeroSkin);\r\n                itemNode.parent = this.content;\r\n                this._itemNodes[i] = itemNode;\r\n                var itemComp = itemNode.getComponent('ItemHeroSkin')\r\n                itemComp.init(data);\r\n                // itemComp.iconSprite.node.scale = 0.5;\r\n                this._itemCells[i] = itemComp;\r\n                itemComp.setOnItemClick(this, itemComp);\r\n            } else {\r\n                var itemComp = this._itemNodes[i].getComponent('ItemHeroSkin')\r\n                itemComp.init(data);\r\n            }\r\n        }\r\n        // var scrollViewCulling = Tools.getOrAddComponent(this.itemScrollView.node, 'ScrollViewCulling');\r\n        // scrollViewCulling.init(this.itemScrollView, this._itemCells, {\r\n        //     countPerLine: 3,\r\n        // });\r\n        this.refresh();\r\n        this.onScrollView();\r\n\r\n        // AdvertMgr.instance.loadAdver(AdverType.UnlockSkin, (hasAdver) => {\r\n        //     this.adverUnlockIcon.active = hasAdver;\r\n        //     this.shareUnlockIcon.active = !hasAdver;\r\n        // });\r\n\r\n    },\r\n\r\n\r\n    onScrollView: function () {\r\n        //当前滑动所在位置\r\n        var curScrollHeight = this.itemScrollView.getScrollOffset().y;\r\n        if (curScrollHeight < Math.floor((this._itemCells.length - 1) / 3) * 180 - 360) {\r\n            if (!this.downNode.active) this.downNode.active = true;\r\n        } else {\r\n            if (this.downNode.active) this.downNode.active = false;\r\n        };\r\n    },\r\n\r\n\r\n    refresh: function () {\r\n        var count = 0;\r\n        for (const itemComp of this._itemCells) {\r\n            var data = itemComp.data;\r\n            var isGet = PlayerData.instance.isOwnHeroSkin(data.id);\r\n            var canUnlock = Tools.arrContains(PlayerData.instance.completeTaskIds, data.taskId);\r\n            var needCheck = Tools.arrContains(PlayerData.instance.needCheckTaskIds, data.taskId);\r\n            var isNew = data.newDate && Tools.isBeforeOtherTime(data.newDate, PlayerData.instance.getCurTime());\r\n\r\n            var processStr = '';\r\n            if (data.getWay === 1) {\r\n                if (data.taskType !== TaskType.RANK && data.taskType !== TaskType.DUANWU) {\r\n                    var process = PlayerData.instance.getTaskProcess(data.taskType);\r\n                    processStr = process + '/' + data.taskParam;\r\n                }\r\n            }\r\n\r\n            itemComp.refresh(isGet, canUnlock, needCheck, isNew, processStr);\r\n            if (isGet) count++;\r\n            if (PlayerData.instance.heroSkin.id === data.id) {\r\n                this.onItemClick(null, itemComp, true);\r\n                itemComp.setCheck(false);\r\n            }\r\n        }\r\n        this.countLabel.string = count + '/' + this._itemCells.length;\r\n    },\r\n\r\n    buyBtnClick: function () {\r\n        if (this.lastCheckItem) {\r\n            var item = this.lastCheckItem;\r\n            switch (item.data.priceType) {\r\n                case 0: {\r\n                    if (PlayerData.instance.gold >= item.data.price) {\r\n                        PlayerData.instance.addHeroSkin(item.data.id);\r\n                        PlayerData.instance.updateGold(-(item.data.price));\r\n                        this.refresh();\r\n                        this.onItemClick(null, item);\r\n                    } else {\r\n                        this.world.uiMgr.showTips(7)\r\n                    }\r\n                    break\r\n                }\r\n                case 1: {\r\n                    if (PlayerData.instance.zongZi >= item.data.price) {\r\n                        PlayerData.instance.addHeroSkin(item.data.id);\r\n                        PlayerData.instance.updateZongZi(-(item.data.price));\r\n                        this.refresh();\r\n                        this.onItemClick(null, item);\r\n                    } else {\r\n                        this.world.uiMgr.showTips('Insufficient Diamond');\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    jumpBtnClick: function () {\r\n        if (this.lastCheckItem) {\r\n            // this.close();\r\n            this.world.uiMgr.closePanelShop();\r\n            var item = this.lastCheckItem;\r\n            switch (item.data.jumpParam) {\r\n                case 'PanelInvite': {\r\n                    this.world.uiMgr.showPanelInvite();\r\n                    break;\r\n                }\r\n                case 'PanelDailyTask': {\r\n                    this.world.uiMgr.showPanelDailyTask();\r\n                    break;\r\n                }\r\n                case 'PanelAddTop': {\r\n                    this.world.uiMgr.showPanelAddTop();\r\n                    break;\r\n                }\r\n                case 'PanelSign': {\r\n                    this.world.uiMgr.showPanelSign();\r\n                    break;\r\n                }\r\n                case 'PanelHolidayRank': {\r\n                    this.world.uiMgr.showPanelHolidayRank(true);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    unLockBtnClick: function () {\r\n        var self = this;\r\n        // 关闭广告时回调\r\n        var closeFunc = (success) => {\r\n            if (self.lastCheckItem && success) {\r\n                var item = self.lastCheckItem;\r\n                PlayerData.instance.addHeroSkin(item.data.id);\r\n                self.refresh();\r\n                self.onItemClick(null, item);\r\n                if (item.data.taskType === TaskType.LOGIN) {\r\n                    PlayerData.instance.updateSignCount();\r\n                }\r\n                self.world.uiMgr.refreshRedDot();\r\n            }\r\n        }\r\n\r\n        if (this.shareIcon.active) {\r\n            this.showShare(closeFunc);\r\n        } else {\r\n            this.showAdver(closeFunc);\r\n        }\r\n    },\r\n\r\n    showShare: function (closeFunc) {\r\n        ShareMgr.share(ShareType.UnlockSkin, closeFunc);\r\n    },\r\n\r\n    showAdver: function (closeFunc) {\r\n        var self = this;\r\n        var errFunc = () => {\r\n            this.showShare(closeFunc);\r\n        }\r\n        AdvertMgr.instance.showAdver(AdverType.UnlockSkin, closeFunc, errFunc);\r\n    },\r\n\r\n    onItemClick: function (event, customEventData, isInit = false) {\r\n        var itemComp = customEventData;\r\n        var data = itemComp.data;\r\n\r\n        // if (data.sort > 6) {\r\n\r\n        var index = this._itemCells.indexOf(itemComp);\r\n        this.itemScrollView.scrollToOffset(cc.v2(0, Math.floor(index / 3) * 180 - 120 + (GameData.instance.isPad() ? 180 : 0)), 1);\r\n        // }\r\n\r\n        if (this.lastCheckItem) this.lastCheckItem.setCheck(false);\r\n        itemComp.setCheck(true);\r\n        this.lastCheckItem = itemComp;\r\n\r\n        this.buyNode.active = false;\r\n        this.unLockNode.active = false;\r\n        this.watchAdverBtnNode.active = false;\r\n        this.jumpNode.active = false;\r\n\r\n        this.world.onEquipHeroSkin(data, itemComp.isGet, false);\r\n        if (itemComp.isGet) {\r\n            if (this.lastEquipItem) this.lastEquipItem.setEquip(false)\r\n            this.lastEquipItem = itemComp;\r\n            itemComp.setEquip(true);\r\n        } else {\r\n            if (data.getWay === 0) {\r\n                this.buyNode.active = true;\r\n            } else if (data.getWay === 1) {\r\n                if (Tools.arrContains(PlayerData.instance.completeTaskIds, data.taskId)) {\r\n                    this.unLockNode.active = true;\r\n                    this.shareIcon.active = data.unlockWay === 1;\r\n                    this.adverIcon.active = data.unlockWay === 2;\r\n\r\n                    // if (data.unlockWay === 1) {\r\n                    //     if (GameData.instance.isInReview) {\r\n                    //         this.shareIcon.active = false;\r\n                    //         this.adverIcon.active = true;\r\n                    //     } \r\n                    // }\r\n\r\n                } else if (data.taskType === TaskType.ADVERCOUNT) {\r\n                    this.watchAdverBtnNode.active = true;\r\n                } else if (data.jumpParam) {\r\n                    this.jumpNode.active = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        this.nameLabel.string = data.name;\r\n        this.introduceLabel.string = data.introduce;\r\n        this.propertyNode.active = data.propertyTips ? true : false;\r\n        this.propertyLabel.string = data.propertyTips ? data.propertyTips : '';\r\n\r\n        this.taskInfoNode.active = data.getWay === 1;\r\n        if (this.taskInfoNode.active) {\r\n            var process = PlayerData.instance.getTaskProcess(data.taskType);\r\n            var str = process < data.taskParam ? process : data.taskParam;\r\n            this.taskStartLabel.string = '(';\r\n            this.taskProgressLabel.string = str ? str : 0;\r\n            this.taskFinalLabel.string = '/' + data.taskParam + ')';\r\n\r\n            if (data.taskType === TaskType.RANK || data.taskType === TaskType.DUANWU) {\r\n                this.taskStartLabel.string = '';\r\n                this.taskProgressLabel.string = '';\r\n                this.taskFinalLabel.string = '';\r\n            }\r\n            this.watchAdverLabel.string = Tools.getStringByFormat(ConfigData.instance.getUITipStr(20), str, data.taskParam)\r\n        }\r\n        this.buyLangLabel.string = 'Buy'\r\n        this.goLangLabel.string = 'Go'\r\n\r\n\r\n\r\n        this.suitNode.active = data.suit;\r\n        if (data.suit) {\r\n            var suitData = ConfigData.instance.getSuitData(data.suit);\r\n            var heroData = data;\r\n            var knifeData = ConfigData.instance.getKnifeSkinById(suitData.knifeSkin);\r\n            var isOwnHeroSkin = PlayerData.instance.isOwnHeroSkin(suitData.heroSkin);\r\n            var isOwnKnifeSkin = PlayerData.instance.isOwnKnifeSkin(suitData.knifeSkin);\r\n            var equipHero = PlayerData.instance.isCurEquipHeroSkin(heroData.id);\r\n            var equipKnife = PlayerData.instance.isCurEquipKnifeSkin(knifeData.id);\r\n\r\n\r\n            this.suitNameLabel.string = suitData.name;\r\n            var process = 0;\r\n            if (isOwnHeroSkin) process++;\r\n            if (isOwnKnifeSkin) process++;\r\n            this.suiProcessLabel.string = '(' + process + '/2)';\r\n            this.suitHeroNameLabel.string = heroData.name;\r\n            this.suitKnifeNameLabel.string = knifeData.name;\r\n            this.suitSkillLabel.string = suitData.skillTips;\r\n            for (let i = 0; i < this.suitIconNode.children.length; i++) {\r\n                if (this.suitIconNode.children[i]) {\r\n                    this.suitIconNode.children[i].active = (i + 1) == data.suit;\r\n                }\r\n            }\r\n\r\n            this.suitHeroFlag.active = equipHero;\r\n            this.suitKnifeFlag.active = equipKnife;\r\n            this.suitHeroFalseFlag.active = !equipHero;\r\n            this.suitKnifeFalseFlag.active = !equipKnife;\r\n\r\n\r\n            this.suitActiveIcon.active = isOwnHeroSkin && isOwnKnifeSkin && equipHero && equipKnife;\r\n            this.suitCloseIcon.active = !(isOwnHeroSkin && isOwnKnifeSkin && equipHero && equipKnife);\r\n\r\n            if (this.suitActiveIcon.active && !isInit) {\r\n                this.world.uiMgr.showActiveSuitEffect();\r\n            }\r\n        }\r\n    },\r\n\r\n    //累计看广告按钮\r\n    onWathAdverBtnClick: function () {\r\n        var self = this;\r\n        // 关闭广告时回调\r\n        var closeFunc = function (success) {\r\n            if (self.lastCheckItem && success) {\r\n                var item = self.lastCheckItem;\r\n                self.world.taskMgr.refreshTaskInHome();\r\n                self.refresh();\r\n                self.onItemClick(null, item);\r\n                // self.world.uiMgr.showTips('累计观看广告次数+1')\r\n            }\r\n        }\r\n        // 打开广告失败时回调,失败回调\r\n        var errFunc = function () {\r\n            self.world.uiMgr.showTips(4);\r\n        }\r\n\r\n        AdvertMgr.instance.showAdver(AdverType.WatchAdver, closeFunc, errFunc);\r\n\r\n    },\r\n\r\n    close: function () {\r\n        this.lastEquipItem.setEquip(false);\r\n        if (this.lastCheckItem) this.lastCheckItem.setCheck(false);\r\n        if (this.closeCallcack) this.closeCallcack();\r\n        this.world.onEquipHeroSkin(PlayerData.instance.heroSkin, true);\r\n        PlayerData.instance.clearNeedCheckTaskIds();\r\n    },\r\n\r\n    setCloseCallback: function (callback) {\r\n        this.closeCallcack = callback;\r\n    },\r\n    // update (dt) {},\r\n});"]}