{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\component\\player\\AI/assets\\scripts\\battle\\component\\player\\AI\\ConditionFindNextPos.js"],"names":["ConditionBaseComponent","require","GameData","Tools","MapType","ConditionFindNextPos","cc","Class","extends","properties","_Width","_height","_min","_max","_dir","init","speed","_speed","setMapSize","instance","mapWidth","mapHeight","node","on","initWalls","type","wallType","detail","width","height","getReal","v2","value","ret","Circle","doResult","getRandomInt","normalizeSelf","result","mulSelf","getRandomFloat","addSelf","position","clampf"],"mappings":";;;;;;AAAA;;;;;AAKC,IAAMA,yBAAyBC,QAAQ,wBAAR,CAA/B;AACA,IAAMC,WAAWD,QAAQ,UAAR,CAAjB;AACA,IAAME,QAAQF,QAAQ,OAAR,CAAd;AACA,IAAMG,UAAUH,QAAQ,OAAR,EAAiBG,OAAjC;;AAED,IAAMC,uBAAuBC,GAAGC,KAAH,CAAS;AAClCC,aAASR,sBADyB;;AAGlCS,gBAAY;AACRC,gBAAQ,CADA;AAERC,iBAAS,CAFD;AAGRC,cAAM,IAHE;AAIRC,cAAM,IAJE;AAKRC,cAAM;AALE,KAHsB;;AAWlCC,UAAM,cAAUC,KAAV,EAAiB;AACnB,aAAKC,MAAL,GAAcD,KAAd;AACA,aAAKE,UAAL,CAAgB,CAAChB,SAASiB,QAAT,CAAkBC,QAAnB,EAA6BlB,SAASiB,QAAT,CAAkBE,SAA/C,CAAhB;;AAEA,aAAKC,IAAL,CAAUC,EAAV,CAAa,YAAb,EAA2B,KAAKL,UAAhC,EAA4C,IAA5C;AACA,aAAKI,IAAL,CAAUC,EAAV,CAAa,WAAb,EAA0B,KAAKC,SAA/B,EAA0C,IAA1C;AACH,KAjBiC;;AAmBlCA,eAAW,mBAAUC,IAAV,EAAgB;AACvB,aAAKC,QAAL,GAAgBD,IAAhB;AACA,aAAKP,UAAL,CAAgB,CAAC,KAAKR,MAAN,EAAc,KAAKC,OAAnB,CAAhB;AACH,KAtBiC;;AAwBlCO,gBAAY,oBAAUS,MAAV,EAAkB;AAC1B,YAAMC,QAAQD,OAAO,CAAP,CAAd;AACA,YAAME,SAASF,OAAO,CAAP,CAAf;;AAEA,aAAKjB,MAAL,GAAc,KAAKoB,OAAL,CAAaF,KAAb,CAAd;AACA,aAAKjB,OAAL,GAAe,KAAKmB,OAAL,CAAaD,MAAb,CAAf;;AAEA,aAAKjB,IAAL,GAAYN,GAAGyB,EAAH,CAAM,CAAC,KAAKrB,MAAN,GAAe,CAArB,EAAwB,CAAC,KAAKC,OAAN,GAAgB,CAAxC,CAAZ;AACA,aAAKE,IAAL,GAAYP,GAAGyB,EAAH,CAAM,KAAKrB,MAAL,GAAc,CAApB,EAAuB,KAAKC,OAAL,GAAe,CAAtC,CAAZ;AACH,KAjCiC;;AAmClCmB,aAAS,iBAAUE,KAAV,EAAiB;AACtB,YAAIC,MAAMD,QAAQ,GAAlB;;AAEA,YAAG,KAAKN,QAAR,EAAkB;AACd,gBAAG,KAAKA,QAAL,KAAkBtB,QAAQ8B,MAA7B,EAAqC;AACjCD,sBAAMA,MAAM,GAAZ;AACH;AACJ;;AAED,eAAOA,GAAP;AACH,KA7CiC;;AA+ClC;AACAE,cAAU,oBAAW;;AAEjB,aAAKrB,IAAL,GAAYR,GAAGyB,EAAH,CAAM5B,MAAMiC,YAAN,CAAmB,CAAC,GAApB,EAAyB,GAAzB,CAAN,EAAqCjC,MAAMiC,YAAN,CAAmB,CAAC,GAApB,EAAyB,GAAzB,CAArC,EAAoEC,aAApE,EAAZ;AACA;AACA,aAAKC,MAAL,GAAc,KAAKxB,IAAL,CAAUyB,OAAV,CAAkB,KAAKtB,MAAvB,EAA+BsB,OAA/B,CAAuCpC,MAAMqC,cAAN,CAAqB,GAArB,EAAyB,GAAzB,CAAvC,EAAsEC,OAAtE,CAA8E,KAAKnB,IAAL,CAAUoB,QAAxF,EAAkGC,MAAlG,CAAyG,KAAK/B,IAA9G,EAAoH,KAAKC,IAAzH,CAAd;AACH;;AAGD;;AAEA;AA1DkC,CAAT,CAA7B","file":"ConditionFindNextPos.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\component\\player\\AI","sourcesContent":["/**\n * @fileoverview 寻找路点条件\n * @author meifan@gameley.cn (梅凡)\n */\n\n const ConditionBaseComponent = require('ConditionBaseComponent');\n const GameData = require('GameData');\n const Tools = require('Tools');\n const MapType = require('Types').MapType;\n\nconst ConditionFindNextPos = cc.Class({\n    extends: ConditionBaseComponent,\n\n    properties: {\n        _Width: 0,\n        _height: 0,\n        _min: null,\n        _max: null,\n        _dir: null,\n    },\n\n    init: function (speed) {\n        this._speed = speed;\n        this.setMapSize([GameData.instance.mapWidth, GameData.instance.mapHeight]);\n\n        this.node.on('setMapSize', this.setMapSize, this);\n        this.node.on('initWalls', this.initWalls, this);\n    },\n\n    initWalls: function (type) {\n        this.wallType = type;\n        this.setMapSize([this._Width, this._height]);\n    },\n\n    setMapSize: function (detail) {\n        const width = detail[0];\n        const height = detail[1];\n\n        this._Width = this.getReal(width);\n        this._height = this.getReal(height);\n\n        this._min = cc.v2(-this._Width / 2, -this._height / 2);\n        this._max = cc.v2(this._Width / 2, this._height / 2);\n    },\n\n    getReal: function (value) {\n        var ret = value * 0.9;\n        \n        if(this.wallType) {\n            if(this.wallType === MapType.Circle) {\n                ret = ret / 1.5;\n            }\n        }\n\n        return ret;\n    },\n\n    /** overwrite */\n    doResult: function() {\n\n        this._dir = cc.v2(Tools.getRandomInt(-100, 100), Tools.getRandomInt(-100, 100)).normalizeSelf();\n        // Tools.getRandomFloat(2.0,4.0)保证正常情况下走2-4s的距离\n        this.result = this._dir.mulSelf(this._speed).mulSelf(Tools.getRandomFloat(2.0,4.0)).addSelf(this.node.position).clampf(this._min, this._max);\n    },\n\n\n    // updateGameLogic: function (dt) {}\n\n    // update: {}\n });"]}