{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\sdk/assets\\scripts\\sdk\\WeiShuSdk.js"],"names":["WeiShuSdk","baseUrl","constellUrl","appName","uinfo","token","uid","is_new","channelCode","userData","Init","susCbk","cc","sys","platform","WECHAT_GAME","launchOpt","wx","getLaunchOptionsSync","query","scene","launchData","decodeURIComponent","reg","RegExp","r","match","unescape","cid","console","log","onLogin","openStatis","self","login","success","res","code","$post","app","rh","data","getUserData","warn","errMsg","retainStatis","cidList","td_Stamp","getTimeSpanAt0","indexOf","push","saveUserData","authStatis","failCbk","JSON","parse","Date","now","stringify","adStatis","navIf","spotId","middle_id","appid","ad_appid","distid","middle_appid","ad_id","navgateTo","path","search","Math","round","getTime","length","substr","window","navigateToMiniProgram","appId","fail","onPreView","preIf","url","previewImage","current","urls","d","toDateString","resolve","reject","request","method","overVer","expVer","libVer","getSystemInfoSync","SDKVersion","_libArr","split","_expVer","len","max","i","num1","parseInt","num2","module","exports"],"mappings":"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","file":"WeiShuSdk.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\sdk","sourcesContent":["/**SDK 封装了渠道上报、存取用户信息等常用功能接口 */\nvar WeiShuSdk = {\n    baseUrl:\"https://gamebix.oss-cn-shenzhen.aliyuncs.com/\", //需要加进mp后台服务器request、downloadFile合法域名里\n    constellUrl:\"https://constellation.mamapai.net/\", //需要加进mp后台服务器request合法域名里\n    appName:\"knife666\", //constell后端给的游戏标识，如未提供，联系鹏程万里(鹏程)\n    uinfo:{\n        token:\"\", //接口调用凭证\n        uid:\"\", //用户id\n        is_new:false //是否新用户\n    }, //https://constellation.mamapai.net后台登录返回的用户信息\n    channelCode:\"\", //渠道id\n    userData:{},\n    /**初始化\n     * @param susCbk 成功回调\n    */\n    Init(susCbk) { //在游戏拉起的时候调用 只调用一次\n        if (cc.sys.platform != cc.sys.WECHAT_GAME) return;\n        let launchOpt = wx.getLaunchOptionsSync ? wx.getLaunchOptionsSync():{}; //获取启动参数\n        this.channelCode = \"\";\n        if (launchOpt.query){ //获取渠道id\n            if (launchOpt.query.scene){ //渠道id获取场景一：玩家通过扫描带渠道参数二维码进入游戏 \n                //res.query.scene形如cid%3Djtdld 需要解码\n                let launchData=decodeURIComponent(launchOpt.query.scene); //解码\n                //\"cid\"是统计后台规定的渠道标识key值\n                let reg=new RegExp(\"(^|&)\"+\"cid\"+\"=([^&]*)(&|$)\"); \n                let r=launchData.match(reg); //查询是否带渠道参数\n                if (r !=null){\n                    this.channelCode = unescape(r[2]);\n                }\n            }else if (launchOpt.query.cid){ //渠道id获取场景二：玩家通过外部渠道点击跳转进入游戏\n                this.channelCode=launchOpt.query.cid;\n            }\n            console.log(\"获取到渠道id: \", this.channelCode);\n        }\n        this.onLogin(()=>{\n            susCbk && susCbk();\n            this.openStatis(launchOpt.scene); //打开上报 回传场景值\n        });\n    },\n    /**登录获取token */\n    onLogin(susCbk) { \n        let self = this;\n        wx.login({ \n            success(res) {\n                if (res.code) { //这里获取wx.login\n                    self.$post(self.constellUrl + 'user/login', {\n                        app: self.appName, //app\n                        code: res.code, //微信登录code (^^^code有5分钟的有效期，而且只能使用一次)\n                        cid: self.channelCode //渠道id 【渠道上报情形一：渠道访问上报】\n                    }, rh=>{\n                        if (rh.data.data && rh.data.data.token) {\n                            self.uinfo.token = rh.data.data.token;\n                            self.uinfo.uid = rh.data.data.uid;\n                            self.uinfo.is_new = rh.data.data.is_new;\n                            susCbk && susCbk();\n                            self.getUserData(null, null);\n                            console.log(\"获取token成功 token: \", self.uinfo.token);\n                        }else{\n                            console.warn(\"token不存在！\");\n                        }\n                    });\n                } else {\n                    console.log('登录失败！' + res.errMsg);\n                }\n            }\n        });\n    },\n\n    openStatis(scene){ //打开应用上报\n        this.$post(this.constellUrl + '/data-statistics/open-app', {\n            app: this.appName,\n            token: this.uinfo.token,\n            scene: scene\n        }, res=>{\n            console.log(\"打开应用上报:\", res);\n        });\n    },\n\n    retainStatis(){ //渠道留存上报统计 统计同一渠道每天用户的留存，每天上报一次即可\n        if(!this.userData.cidList || !this.userData.td_Stamp || this.userData.td_Stamp && (this.getTimeSpanAt0() > this.userData.td_Stamp)){\n            this.userData.cidList = []; //新的一天 清空已上报cid列表\n        }\n        if(this.userData.cidList.indexOf(this.channelCode) == -1){\n            this.userData.cidList.push(this.channelCode);\n            this.saveUserData(null, null);\n            this.$post(this.constellUrl + 'user/old-user-visit', {\n                app: this.appName, //【渠道上报情形二：渠道留存上报】\n                token: this.uinfo.token,\n                cid: this.channelCode\n            },res=>{\n\n            });\n        }\n    },\n\n    authStatis(){ //渠道授权上报统计 用户发起授权的时候手动调用一次\n        if(this.channelCode){\n            this.uinfo.token && this.$post(this.constellUrl + 'user/update-user-info', {\n                app: this.appName, //【渠道上报情形三：渠道授权上报】\n                token: this.uinfo.token,\n                cid: this.channelCode\n            },res=>{\n\n            });\n        }\n    },\n\n    getUserData(susCbk = null, failCbk = null) { //获取用户数据\n        let self = this;\n        this.uinfo.token && this.$post(this.constellUrl + 'common/download-data',{\n            app: this.appName,\n            token: this.uinfo.token\n        },res=>{\n            if(res.data && res.data.data && res.data.data.data){\n                self.userData = JSON.parse(res.data.data.data);\n                susCbk && susCbk();\n                console.log(\"获取到用户数据: \", self.userData); //获取成功\n            }else{\n                self.userData = {};\n                failCbk && failCbk();\n            }\n            self.channelCode && self.retainStatis();\n        });\n    },\n\n    saveUserData(susCbk = null, failCbk = null) { //保存用户数据\n        this.userData.td_Stamp = Date.now(); //记录最后一次保存时间\n        this.uinfo.token && this.$post(this.constellUrl + 'common/upload-data', {\n            app: this.appName,\n            token: this.uinfo.token,\n            data : JSON.stringify(this.userData) //用户数据\n        }, res=>{\n            console.log(\"保存用户数据成功: \", res); //保存成功\n            susCbk && susCbk();\n        });\n    },\n\n    /**\n     * 广告位统计-ad上报\n     * @param navIf 跳转信息配置\n     * @param spotId 中转识别id\n     */\n    adStatis(navIf, spotId = \"\"){\n        let middle_id = \"\";\n        if(spotId) middle_id = navIf.appid;\n        this.$post(this.constellUrl + 'data-statistics/ad', {\n            app: this.appName,\n            token: this.uinfo.token,\n            ad_appid: navIf.distid,\n            middle_appid: middle_id,\n            ad_id:spotId\n        }, res=>{\n            console.log(\"广告位统计-ad上报: \", res);\n        });\n    },\n    /**\n     * 小游戏跳转\n     * @param navIf 跳转信息配置\n     * @param susCbk 成功回调\n     * @param failCbk 失败回调\n     */\n    navgateTo(navIf, susCbk = null, failCbk = null){\n        let spotId = \"\";\n        if(navIf.path.search(new RegExp('(^|&)?reJ=([^&]*)(&|$)')) != -1){ //是中转模式\n            spotId = this.appName + this.uinfo.uid + Math.round((new Date()).getTime() / 1000) + \"\";\n            if(spotId.length > 25) spotId = spotId.substr(spotId.length - 25, spotId.length); //若超过25字符，截取后面25字符\n            navIf.path += \"&ad_id=\" + spotId; //把中转识别id带过去\n        }\n\n        let self = this;\n        if (window['wx'].navigateToMiniProgram){\n            window['wx'].navigateToMiniProgram({\n                appId: navIf.appid,\n                path: navIf.path,\n                success(res) {\n                    if(spotId){\n                        self.adStatis(navIf, spotId); //广告位中转上报\n                    }else{\n                        self.adStatis(navIf); //广告位上报(不中转)\n                    }\n                    susCbk && susCbk();\n                    // console.log(\"nav successed\");\n                },\n                fail(){\n                    failCbk && failCbk();\n                }\n            });\n        }\n    },\n\n    /**\n     * 预览二维码\n     * @param preIf 预览信息\n     * @param susCbk 成功回调\n     */\n    onPreView(preIf, susCbk = null){\n        let url = this.baseUrl + \"QR_code/\" + preIf.path;\n        let self = this;\n        window['wx'].previewImage({\n            current: url, // 当前显示图片的http链接\n            urls: [url], // 需要预览的图片http链接列表\n            success(){\n                // console.log(\"prev successed\");\n                self.adStatis(preIf);\n                susCbk && susCbk();\n            }\n        });\n    },\n\n    //获取当天零点时间戳\n    getTimeSpanAt0(){\n        let d = new Date(new Date().toDateString());\n        return d.getTime();\n    },\n\n    $post(url, data, resolve = null, reject = null) { //封装POST方法\n        window['wx'].request({\n            url: url,\n            data: data,\n            method: \"POST\",\n            success: resolve,\n            fail: reject\n        });\n    },\n\n    /**\n     * 比较版本号\n     * @param   expVer 期望版本号\n     * @return 基础库版本号是否大于等于期望版本号\n     */\n    overVer(expVer){\n        let libVer = wx.getSystemInfoSync().SDKVersion;\n        let _libArr = libVer.split(\".\");\n        let _expVer = expVer.split(\".\");\n        let len = Math.max(_libArr.length, _expVer.length);\n\n        if (_libArr.length < len) {\n            _libArr.push('0');\n        }\n        if(_expVer.length < len) {\n            _expVer.push('0');\n        }\n        for (let i = 0; i < len; i++) {\n            let num1 = parseInt(_libArr[i]);\n            let num2 = parseInt(_expVer[i]);\n            if (num1 > num2) {\n                return true;\n            } else if (num1 < num2) {\n                return false;\n            }\n        }\n        return true;\n    }\n}\n\nmodule.exports = WeiShuSdk"]}