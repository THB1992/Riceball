{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\component\\player/assets\\scripts\\battle\\component\\player\\PlayerFrenzyComponent.js"],"names":["FrenzyAddType","require","FrenzyAddNums","BuffState","ConfigData","PlayerFrenzyComponent","cc","Class","extends","Component","properties","_count","_max","_time","_isFrenzy","_speed","init","data","instance","getBuffDataById","Frenzy","keepTime","_normalSpeed","_frenzySpeed","_normalTime","_frenzyTime","node","on","onFrenzyAdd","addType","length","tryFrenzy","customTime","emit","onFrenzyEnd","update","dt","getFrenzyRate","isFrenzy"],"mappings":";;;;;;AAAA;;;;;AAKA,IAAMA,gBAAgBC,QAAQ,OAAR,EAAiBD,aAAvC;AACA,IAAME,gBAAgB,CAAC,CAAD,EAAI,CAAJ,EAAO,GAAP,EAAY,IAAZ,EAAkB,IAAlB,EAAwB,GAAxB,CAAtB;AACA,IAAMC,YAAYF,QAAQ,OAAR,EAAiBE,SAAnC;AACA,IAAMC,aAAaH,QAAQ,YAAR,CAAnB;;AAEA,IAAMI,wBAAwBC,GAAGC,KAAH,CAAS;AACnCC,aAASF,GAAGG,SADuB;;AAGnCC,gBAAY;AACRC,gBAAQ,CADA;AAERC,cAAM,IAFE;AAGRC,eAAO,CAHC;AAIRC,mBAAW,KAJH;AAKRC,gBAAQ;AALA,KAHuB;;AAYnCC,UAAM,gBAAY;;AAEd,YAAIC,OAAOb,WAAWc,QAAX,CAAoBC,eAApB,CAAoChB,UAAUiB,MAA9C,CAAX;AACA,aAAKT,MAAL,GAAc,CAAd;AACA,aAAKC,IAAL,GAAY,IAAZ;AACA,aAAKC,KAAL,GAAaI,KAAKI,QAAlB;AACA,aAAKC,YAAL,GAAoB,KAAKV,IAAL,GAAY,GAAZ,GAAkB,KAAKC,KAA3C;AACA,aAAKU,YAAL,GAAoB,KAAKX,IAAL,GAAY,GAAZ,GAAkB,GAAtC;AACA,aAAKG,MAAL,GAAc,KAAKO,YAAnB;AACA,aAAKE,WAAL,GAAmB,KAAKX,KAAxB;AACA,aAAKY,WAAL,GAAmB,GAAnB;;AAEA,aAAKC,IAAL,CAAUC,EAAV,CAAa,aAAb,EAA4B,KAAKC,WAAjC,EAA8C,IAA9C;AACA,aAAKF,IAAL,CAAUC,EAAV,CAAa,mBAAb,EAAkC,KAAKC,WAAvC,EAAoD,IAApD;AACH,KA1BkC;;AA4BnCA,iBAAa,qBAAUC,OAAV,EAAmB;AAC5B,YAAI,KAAKf,SAAT,EAAoB;AAChB;AACH;;AAED,YAAIe,UAAU,CAAV,IAAeA,WAAW3B,cAAc4B,MAA5C,EAAoD;AAChD;AACH;;AAED,aAAKnB,MAAL,IAAeT,cAAc2B,OAAd,CAAf;;AAEA,YAAI,KAAKlB,MAAL,IAAe,KAAKC,IAAxB,EAA8B;AAC1B,iBAAKD,MAAL,GAAc,KAAKC,IAAnB;AACA,iBAAKG,MAAL,GAAec,YAAY7B,cAAc+B,SAA3B,GAAwC,KAAKR,YAA7C,GAA4D,KAAKD,YAA/E;AACA,gBAAIU,aAAcH,YAAY7B,cAAc+B,SAA3B,GAAwC,KAAKN,WAA7C,GAA2D,CAAC,CAA7E;AACA,iBAAKX,SAAL,GAAiB,IAAjB;AACA,iBAAKY,IAAL,CAAUO,IAAV,CAAe,iBAAf,EAAkC9B,UAAUiB,MAA5C,EAAoDY,UAApD;AACH;AACJ,KA9CkC;;AAgDnCE,iBAAa,uBAAY;AACrB,aAAKpB,SAAL,GAAiB,KAAjB;AACA,aAAKH,MAAL,GAAc,CAAd;AACH,KAnDkC;;AAqDnCwB,UArDmC,kBAqD5BC,EArD4B,EAqDxB;AACP,YAAI,KAAKtB,SAAT,EAAoB;AAChB,iBAAKH,MAAL,IAAe,KAAKI,MAAL,GAAcqB,EAA7B;AACA,gBAAI,KAAKzB,MAAL,IAAe,CAAnB,EAAsB;AAClB,qBAAKuB,WAAL;AACH;AACJ;AACJ,KA5DkC;;;AA8DnCG,mBAAe,yBAAY;AACvB,eAAO,KAAK1B,MAAL,GAAc,GAAd,GAAoB,KAAKC,IAAhC;AACH,KAhEkC;;AAkEnC0B,cAAU,oBAAY;AAClB,eAAO,KAAKxB,SAAZ;AACH;AApEkC,CAAT,CAA9B","file":"PlayerFrenzyComponent.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\component\\player","sourcesContent":["/**\n * @fileoverview PlayerFrenzyComponent\n * @author meifan@gameley.cn (梅凡)\n */\n\nconst FrenzyAddType = require('Types').FrenzyAddType;\nconst FrenzyAddNums = [1, 1, 300, 1000, 1000, 300];\nconst BuffState = require('Types').BuffState;\nconst ConfigData = require('ConfigData');\n\nconst PlayerFrenzyComponent = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        _count: 0,\n        _max: 1000,\n        _time: 5,\n        _isFrenzy: false,\n        _speed: 1.0,\n    },\n\n\n    init: function () {\n\n        var data = ConfigData.instance.getBuffDataById(BuffState.Frenzy);\n        this._count = 0;\n        this._max = 1000;\n        this._time = data.keepTime;\n        this._normalSpeed = this._max * 1.0 / this._time;\n        this._frenzySpeed = this._max * 1.0 / 5.0;\n        this._speed = this._normalSpeed;\n        this._normalTime = this._time;\n        this._frenzyTime = 5.0;\n\n        this.node.on('onFrenzyAdd', this.onFrenzyAdd, this);\n        this.node.on('onReviveFrenzyAdd', this.onFrenzyAdd, this);\n    },\n\n    onFrenzyAdd: function (addType) {\n        if (this._isFrenzy) {\n            return;\n        }\n\n        if (addType < 0 || addType >= FrenzyAddNums.length) {\n            return;\n        }\n\n        this._count += FrenzyAddNums[addType];\n\n        if (this._count >= this._max) {\n            this._count = this._max;\n            this._speed = (addType === FrenzyAddType.tryFrenzy) ? this._frenzySpeed : this._normalSpeed;\n            var customTime = (addType === FrenzyAddType.tryFrenzy) ? this._frenzyTime : -1;\n            this._isFrenzy = true;\n            this.node.emit('updateBuffState', BuffState.Frenzy, customTime);\n        }\n    },\n\n    onFrenzyEnd: function () {\n        this._isFrenzy = false;\n        this._count = 0;\n    },\n\n    update(dt) {\n        if (this._isFrenzy) {\n            this._count -= this._speed * dt;\n            if (this._count <= 0) {\n                this.onFrenzyEnd();\n            }\n        }\n    },\n\n    getFrenzyRate: function () {\n        return this._count * 1.0 / this._max;\n    },\n\n    isFrenzy: function () {\n        return this._isFrenzy;\n    }\n});"]}