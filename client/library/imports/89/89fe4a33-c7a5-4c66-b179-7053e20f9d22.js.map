{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui/assets\\scripts\\battle\\ui\\ItemRankReward.js"],"names":["ListItemBase","require","PlayerData","ConfigData","UIUtil","ItemRankReward","cc","Class","extends","properties","skinRewardNode","Node","goldRewardNode","skinIconSprite","Sprite","skinNameLabel","Label","goldCountLabel","unLockNode","hasGetNode","iconSprite","nameLabel","goldLabel","achieveNode","notAchieveNode","adverIcon","normalIcon","kingNode","kingLabel","unlockRootNode","unlockBuffNode","unlockBuffLabel","unlockBuffIcon","unlockMapNode","unlockMapLabel","unlockMapIcon","init","data","item","isSkin","string","name","Math","ceil","goldMultiRate","loadResSprite","url","active","isKing","levelUpStar","achieve","instance","rankStar","star","node","y","itemData","loader","loadRes","SpriteFrame","error","resource","spriteFrame","num","unlockBuff","unlockTips","unlockBuffIcons","children","unlockMap","unlockMapTips","unlockMapIcons","refresh","isGet","canUnLock"],"mappings":"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","file":"ItemRankReward.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui","sourcesContent":["/**\r\n * @fileoverview 段位奖励item\r\n * @author zhangzhuang@gameley.cn (张庄)\r\n */\r\n\r\nconst ListItemBase = require('ListItemBase');\r\nconst PlayerData = require('PlayerData');\r\nconst ConfigData = require('ConfigData');\r\nconst UIUtil = require('UIUtil');\r\n\r\nconst ItemRankReward = cc.Class({\r\n    extends: ListItemBase,\r\n\r\n    properties: {\r\n        skinRewardNode: cc.Node,\r\n        goldRewardNode: cc.Node,\r\n        skinIconSprite: cc.Sprite,\r\n        skinNameLabel: cc.Label,\r\n        goldCountLabel: cc.Label,\r\n\r\n        unLockNode: cc.Node,\r\n        hasGetNode: cc.Node,\r\n\r\n        iconSprite: cc.Sprite,\r\n        nameLabel: cc.Label,\r\n        goldLabel: cc.Label,\r\n\r\n        achieveNode: cc.Node,\r\n        notAchieveNode: cc.Node,\r\n\r\n        adverIcon: cc.Node,\r\n        normalIcon: cc.Node,\r\n\r\n        kingNode: cc.Node,\r\n        kingLabel: cc.Label,\r\n\r\n        unlockRootNode: cc.Node,\r\n\r\n        unlockBuffNode: cc.Node,\r\n        unlockBuffLabel: cc.Label,\r\n        unlockBuffIcon: cc.Node,\r\n\r\n        unlockMapNode: cc.Node,\r\n        unlockMapLabel: cc.Label,\r\n        unlockMapIcon: cc.Node,\r\n    },\r\n\r\n    init: function (data, item, isSkin) {\r\n        this.data = data;\r\n        this.item = item;\r\n        this.isSkin = isSkin;\r\n\r\n\r\n        this.nameLabel.string = data.name;\r\n        this.goldLabel.string = 'bonus coin' + Math.ceil((data.goldMultiRate * 100 + 100)) + '%';\r\n\r\n        // cc.loader.loadRes(data.url, cc.SpriteFrame, (error, resource) => {\r\n        //     if (error) {\r\n        //         cc.error(error);\r\n        //     } else if (resource) {\r\n        //         this.iconSprite.spriteFrame = resource;\r\n        //     }\r\n        // })\r\n        // AddEntitySystem.instance.loadRankSprite(this.iconSprite, data.iconIndex);\r\n        UIUtil.loadResSprite(this.iconSprite, data.url);\r\n\r\n        this.skinRewardNode.active = item && isSkin ? true : false;\r\n        this.goldRewardNode.active = item && !isSkin ? true : false;;\r\n\r\n        var isKing = data.levelUpStar === 0;\r\n        var achieve = PlayerData.instance.rankStar - data.star >= 0;\r\n        this.goldLabel.node.y = isKing && achieve ? -120 : -92;\r\n        this.kingNode.active = isKing && achieve ? true : false;\r\n        this.kingLabel.string = 'x' + (PlayerData.instance.rankStar - data.star);\r\n        this.unlockRootNode.y = item ? (this.isSkin ? -80 : -60) : 20;\r\n\r\n        if (item) {\r\n            var data = item.itemData;\r\n            if (isSkin) {\r\n                this.skinNameLabel.string = data.name;\r\n                cc.loader.loadRes(data.url, cc.SpriteFrame, (error, resource) => {\r\n                    if (error) {\r\n                        cc.error(error);\r\n                    } else if (resource) {\r\n                        this.skinIconSprite.spriteFrame = resource;\r\n                    }\r\n                })\r\n            } else {\r\n                this.goldCountLabel.string = item.num;\r\n            }\r\n        }\r\n\r\n\r\n        this.unlockBuffNode.active = false;\r\n        if (this.data.unlockBuff || this.data.unlockBuff === 0) {\r\n            this.unlockBuffNode.active = true;\r\n            this.unlockBuffLabel.string = this.data.unlockTips;\r\n            var unlockBuffIcons = this.unlockBuffIcon.children;\r\n            unlockBuffIcons[this.data.unlockBuff].active = true;\r\n            // var data = ConfigData.instance.getBuffDataById(this.data.unlockBuff);\r\n            // if (data) {\r\n            // };\r\n        }\r\n\r\n        if (this.data.unlockMap || this.data.unlockMap === 0) {\r\n            this.unlockMapNode.active = true;\r\n            this.unlockMapLabel.string = this.data.unlockMapTips;\r\n            var unlockMapIcons = this.unlockMapIcon.children;\r\n            unlockMapIcons[this.data.unlockMap].active = true;\r\n        }\r\n    },\r\n\r\n    refresh: function (isGet, canUnLock) {\r\n        this.achieveNode.active = canUnLock ? true : false;\r\n        this.notAchieveNode.active = !this.achieveNode.active;\r\n        this.unLockNode.active = this.item && !isGet && canUnLock ? true : false;\r\n        this.hasGetNode.active = this.item && isGet ? true : false;\r\n\r\n        this.adverIcon.active = this.isSkin ? true : false;\r\n        this.normalIcon.active = !this.adverIcon.active;\r\n    },\r\n\r\n});"]}