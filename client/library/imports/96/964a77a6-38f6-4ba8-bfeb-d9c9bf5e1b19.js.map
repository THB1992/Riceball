{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\component\\sound/assets\\scripts\\battle\\component\\sound\\KnifeCollisionSoundCtrl.js"],"names":["AudioEngine","require","SoundID","KnifeCollisionSoundCtrl","cc","Class","extends","Component","properties","_time","_audioID","_soundTime","init","node","on","localHeroCollision","update","dt","instance","stopSound","playSound","HitFast","stop"],"mappings":";;;;;;AAAA;;;;;AAKA,IAAMA,cAAcC,QAAQ,aAAR,CAApB;AACA,IAAMC,UAAUD,QAAQ,OAAR,EAAiBC,OAAjC;;AAEA,IAAMC,0BAA0BC,GAAGC,KAAH,CAAS;AACrCC,aAASF,GAAGG,SADyB;AAErCC,gBAAY;AACRC,eAAO,CAAC,CADA;AAERC,kBAAU,IAFF;AAGRC,oBAAY,CAAC;AAHL,KAFyB;;AAQrCC,UAAM,gBAAY;AACd,aAAKC,IAAL,CAAUC,EAAV,CAAa,oBAAb,EAAmC,KAAKC,kBAAxC,EAA4D,IAA5D;AACH,KAVoC;;AAYrCC,YAAQ,gBAAUC,EAAV,EAAc;AAClB,YAAG,KAAKR,KAAL,GAAa,CAAhB,EAAmB;AACf,iBAAKA,KAAL,IAAcQ,EAAd;AACA,gBAAG,KAAKR,KAAL,IAAc,CAAjB,EAAoB;AAChB,qBAAKA,KAAL,GAAa,CAAC,CAAd;AACAT,4BAAYkB,QAAZ,CAAqBC,SAArB,CAA+B,KAAKT,QAApC;AACA,qBAAKA,QAAL,GAAgB,IAAhB;AACA,qBAAKC,UAAL,GAAkB,CAAC,CAAnB;AACH;AACJ;;AAED;AACA,YAAG,KAAKA,UAAL,GAAkB,CAArB,EAAwB;;AAEpB,iBAAKA,UAAL,IAAmBM,EAAnB;AACA,gBAAG,KAAKN,UAAL,IAAmB,CAAtB,EAAyB;AACrB,qBAAKD,QAAL,GAAgB,IAAhB;AACA,qBAAKU,SAAL;AACH;AACJ;AACJ,KAhCoC;;AAkCrCL,wBAAoB,8BAAY;AAC5B,aAAKK,SAAL;AACA,aAAKX,KAAL,GAAa,GAAb;AACH,KArCoC;;AAuCrCW,eAAW,qBAAY;AACnB,YAAG,CAAC,KAAKV,QAAT,EAAmB;AACf,iBAAKA,QAAL,GAAgBV,YAAYkB,QAAZ,CAAqBE,SAArB,CAA+BlB,QAAQmB,OAAvC,CAAhB;AACA,iBAAKV,UAAL,GAAkB,IAAlB;AACH;AACJ,KA5CoC;;AA8CrCW,UAAM,gBAAY;AACdtB,oBAAYkB,QAAZ,CAAqBC,SAArB,CAA+B,KAAKT,QAApC;AACA,aAAKA,QAAL,GAAgB,IAAhB;AACA,aAAKC,UAAL,GAAkB,CAAC,CAAnB;AACH;;AAlDoC,CAAT,CAAhC","file":"KnifeCollisionSoundCtrl.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\component\\sound","sourcesContent":["/**\n * @fileoverview KnifeCollisionSoundCtrl\n * @author meifan@gameley.cn (梅凡)\n */\n\nconst AudioEngine = require('AudioEngine');\nconst SoundID = require('Types').SoundID;\n\nconst KnifeCollisionSoundCtrl = cc.Class({\n    extends: cc.Component,\n    properties: {\n        _time: -1,\n        _audioID: null,\n        _soundTime: -1,\n    },\n\n    init: function () {\n        this.node.on('localHeroCollision', this.localHeroCollision, this);\n    },\n\n    update: function (dt) {\n        if(this._time > 0) {\n            this._time -= dt;\n            if(this._time <= 0) {\n                this._time = -1;\n                AudioEngine.instance.stopSound(this._audioID);\n                this._audioID = null;\n                this._soundTime = -1;\n            }\n        }\n\n        // 音效loop改成游戏侧逻辑重播，避免任何可能导致停不下来的问题\n        if(this._soundTime > 0) {\n\n            this._soundTime -= dt;\n            if(this._soundTime <= 0) {\n                this._audioID = null;\n                this.playSound();\n            }\n        }\n    },\n\n    localHeroCollision: function () {\n        this.playSound();\n        this._time = 0.5;\n    },\n\n    playSound: function () {\n        if(!this._audioID) {\n            this._audioID = AudioEngine.instance.playSound(SoundID.HitFast);\n            this._soundTime = 1.34;\n        }\n    },\n\n    stop: function () {\n        AudioEngine.instance.stopSound(this._audioID);\n        this._audioID = null;\n        this._soundTime = -1;\n    }\n\n});"]}