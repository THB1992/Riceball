{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\component\\player/assets\\scripts\\battle\\component\\player\\PlayerBuffComponent.js"],"names":["BuffState","require","ConfigData","cc","Class","extends","Component","properties","buffRemainTimes","onLoad","node","on","updateBuffState","die","i","length","data","instance","getBuffDataById","emit","buffState","customTime","keepTime","updateGameLogic","dt"],"mappings":";;;;;;AAAA,IAAMA,YAAYC,QAAQ,OAAR,EAAiBD,SAAnC;AACA,IAAME,aAAaD,QAAQ,YAAR,CAAnB;AACAE,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,yBAAiB;AADT,KAHP;;AAQLC,YAAQ,kBAAY;AAChB;AACA,aAAKC,IAAL,CAAUC,EAAV,CAAa,iBAAb,EAAgC,KAAKC,eAArC,EAAsD,IAAtD;AACH,KAXI;;AAaLC,SAAK,eAAY;AACb,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAI,KAAKN,eAAL,CAAqBO,MAAzC,EAAiDD,GAAjD,EAAsD;AAClD,gBAAI,KAAKN,eAAL,CAAqBM,CAArB,CAAJ,EAA6B;AACzB,oBAAIE,OAAOd,WAAWe,QAAX,CAAoBC,eAApB,CAAoCJ,CAApC,CAAX;AACA,qBAAKJ,IAAL,CAAUS,IAAV,CAAe,cAAf,EAA+BH,IAA/B,EAAqC,KAArC;AACA,qBAAKR,eAAL,CAAqBM,CAArB,IAA0B,CAA1B;AACH;AACJ;AACJ,KArBI;;AAuBLF,qBAAiB,yBAAUQ,SAAV,EAAsC;AAAA,YAAjBC,UAAiB,uEAAJ,CAAC,CAAG;;AACnD,YAAIL,OAAOd,WAAWe,QAAX,CAAoBC,eAApB,CAAoCE,SAApC,CAAX;AACA;AACA,YAAI,CAAC,KAAKZ,eAAL,CAAqBY,SAArB,CAAL,EAAsC;AAClC,iBAAKV,IAAL,CAAUS,IAAV,CAAe,cAAf,EAA+BH,IAA/B,EAAqC,IAArC;AACH;AACD,aAAKR,eAAL,CAAqBY,SAArB,IAAkCC,aAAa,CAAb,GAAiBA,UAAjB,GAA8BL,KAAKM,QAArE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AAEH,KA5CI;;AA8CLC,mBA9CK,2BA8CWC,EA9CX,EA8Ce;AAChB,aAAK,IAAIV,IAAI,CAAb,EAAgBA,IAAI,KAAKN,eAAL,CAAqBO,MAAzC,EAAiDD,GAAjD,EAAsD;AAClD,gBAAI,KAAKN,eAAL,CAAqBM,CAArB,CAAJ,EAA6B;AACzB,qBAAKN,eAAL,CAAqBM,CAArB,KAA2BU,EAA3B;AACA,oBAAI,KAAKhB,eAAL,CAAqBM,CAArB,KAA2B,CAA/B,EAAkC;AAC9B,yBAAKN,eAAL,CAAqBM,CAArB,IAA0B,CAA1B;AACA,wBAAIE,OAAOd,WAAWe,QAAX,CAAoBC,eAApB,CAAoCJ,CAApC,CAAX;AACA,yBAAKJ,IAAL,CAAUS,IAAV,CAAe,cAAf,EAA+BH,IAA/B,EAAqC,KAArC;AACH;AACJ;AACJ;AACJ;AAzDI,CAAT","file":"PlayerBuffComponent.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\component\\player","sourcesContent":["const BuffState = require('Types').BuffState;\r\nconst ConfigData = require('ConfigData');\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        buffRemainTimes: [],\r\n    },\r\n\r\n\r\n    onLoad: function () {\r\n        // this.node.on('die', this.die, this);\r\n        this.node.on('updateBuffState', this.updateBuffState, this);\r\n    },\r\n\r\n    die: function () {\r\n        for (let i = 0; i < this.buffRemainTimes.length; i++) {\r\n            if (this.buffRemainTimes[i]) {\r\n                var data = ConfigData.instance.getBuffDataById(i);\r\n                this.node.emit('onBuffChange', data, false)\r\n                this.buffRemainTimes[i] = 0;\r\n            }\r\n        }\r\n    },\r\n\r\n    updateBuffState: function (buffState, customTime = -1) {\r\n        var data = ConfigData.instance.getBuffDataById(buffState);\r\n        // var buffTime = this.buffRemainTimes[buffState] ? this.buffRemainTimes[buffState] : 0;\r\n        if (!this.buffRemainTimes[buffState]) {\r\n            this.node.emit('onBuffChange', data, true);\r\n        }\r\n        this.buffRemainTimes[buffState] = customTime > 0 ? customTime : data.keepTime;\r\n        // this.buffCount[buffState]++;\r\n        // setTimeout(() => {\r\n        //     this.buffCount[buffState]--;\r\n        //     if (this.buffCount[buffState] === 0) {\r\n        //         //通知回归\r\n        //     }\r\n        // }, this.buffKeepTimes)\r\n\r\n        // switch (buffState) {\r\n        //     case BuffState.BIG:\r\n\r\n        //         break;\r\n        // }\r\n\r\n    },\r\n\r\n    updateGameLogic(dt) {\r\n        for (let i = 0; i < this.buffRemainTimes.length; i++) {\r\n            if (this.buffRemainTimes[i]) {\r\n                this.buffRemainTimes[i] -= dt;\r\n                if (this.buffRemainTimes[i] <= 0) {\r\n                    this.buffRemainTimes[i] = 0;\r\n                    var data = ConfigData.instance.getBuffDataById(i);\r\n                    this.node.emit('onBuffChange', data, false)\r\n                }\r\n            }\r\n        }\r\n    },\r\n});"]}