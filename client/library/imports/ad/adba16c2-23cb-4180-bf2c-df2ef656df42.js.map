{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui/assets\\scripts\\battle\\ui\\PanelRank.js"],"names":["ConfigData","require","PlayerData","Tools","AdvertMgr","cc","Class","extends","Component","properties","itemRankPrefab","Prefab","itemMiniRankPrefab","itemRankParent","Node","itemMiniRankParent","greenBar","greenArrow","blackBar","blackArrow","bubbleNode","bubbleStar","bubbleLabel","Label","moveNode","finalWidth","widthPer","percent","index","init","isInit","maxInterval","minInterval","rankDatas","instance","getBigRankDatas","i","length","data","nextData","rankMiniNode","instantiate","parent","x","rankMiniComp","getComponent","rankNode","rankComp","isAchieve","rankStar","star","isKeep","refreshUnlock","keepIndex","levelUpStar","move","rankData","onLeft","onRight","refresh","active","stopAllActions","action","moveTo","v2","easing","easeBackOut","runAction","action2","easeIn","setTimeout","showBubble","width","children","refeshBubble","string","scaleY","node","scaleX","onClose","update","dt","startMove","fixBubble","finalWidthh"],"mappings":"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","file":"PanelRank.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui","sourcesContent":["const ConfigData = require('ConfigData');\r\nconst PlayerData = require('PlayerData');\r\nconst Tools = require('Tools');\r\nconst AdvertMgr = require('AdvertMgr');\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n        itemRankPrefab: cc.Prefab,\r\n        itemMiniRankPrefab: cc.Prefab,\r\n\r\n        itemRankParent: cc.Node,\r\n        itemMiniRankParent: cc.Node,\r\n\r\n        greenBar: cc.Node,\r\n        greenArrow: cc.Node,\r\n\r\n        blackBar: cc.Node,\r\n        blackArrow: cc.Node,\r\n\r\n        bubbleNode: cc.Node,\r\n        bubbleStar: cc.Node,\r\n        bubbleLabel: cc.Label,\r\n\r\n        moveNode: cc.Node,\r\n\r\n        finalWidth: 0,\r\n        widthPer: 1,\r\n        percent: 0,\r\n        index: 0,\r\n    },\r\n\r\n    init() {\r\n\r\n        this.isInit = true;\r\n        this.maxInterval = 600;\r\n        this.minInterval = 320;\r\n        this.rankDatas = ConfigData.instance.getBigRankDatas();\r\n\r\n        for (let i = 0; i < this.rankDatas.length; i++) {\r\n            var data = this.rankDatas[i];\r\n            var nextData = this.rankDatas[i + 1];\r\n\r\n            //小图标\r\n            var rankMiniNode = cc.instantiate(this.itemMiniRankPrefab);\r\n            rankMiniNode.parent = this.itemMiniRankParent;\r\n            rankMiniNode.x = i * this.minInterval;\r\n            // rankMiniNode.y = 0;\r\n            var rankMiniComp = rankMiniNode.getComponent('ItemRankMini');\r\n            rankMiniComp.init(data);\r\n\r\n\r\n            //大图标\r\n            var rankNode = cc.instantiate(this.itemRankPrefab);\r\n            rankNode.parent = this.itemRankParent;\r\n            rankNode.x = i * this.maxInterval;\r\n            // rankNode.y = 0;\r\n\r\n            var rankComp = rankNode.getComponent('ItemRank');\r\n\r\n            var isAchieve = nextData && PlayerData.instance.rankStar >= nextData.star;\r\n            var isKeep = (PlayerData.instance.rankStar >= (data.star)) && !isAchieve;\r\n            rankComp.refreshUnlock(data);\r\n\r\n            if (isKeep) {\r\n                this.index = i;\r\n                this.keepIndex = i;\r\n                if (data.levelUpStar) {\r\n                    this.percent = (PlayerData.instance.rankStar - data.star) / (nextData.star - data.star);\r\n                } else {\r\n                    this.percent = 0;\r\n                }\r\n                this.move();\r\n\r\n                data = PlayerData.instance.rankData;\r\n            }\r\n            rankComp.init(data, isAchieve, isKeep);\r\n\r\n\r\n        }\r\n\r\n        // this.itemRankParent.x = -index * this.maxInterval;\r\n        // this.itemMiniRankParent.x = -index * this.minInterval;\r\n    },\r\n\r\n\r\n    onLeft() {\r\n        if (this.index === 0) return\r\n        this.index--;\r\n        this.move();\r\n    },\r\n\r\n\r\n    onRight() {\r\n        if (this.index === (this.rankDatas.length - 1)) return\r\n        this.index++;\r\n        this.move();\r\n    },\r\n\r\n    refresh() {\r\n        if (this.index === this.keepIndex) return;\r\n        this.index = this.keepIndex;\r\n        this.move();\r\n    },\r\n\r\n    move() {\r\n\r\n        this.moveNode.active = false;\r\n        this.itemRankParent.stopAllActions();\r\n        this.itemMiniRankParent.stopAllActions();\r\n        var action = cc.moveTo(0.4, cc.v2(-this.index * this.maxInterval, 50)).easing(cc.easeBackOut(3));\r\n        this.itemRankParent.runAction(action);\r\n        var action2 = cc.moveTo(0.5, cc.v2(-this.index * this.minInterval, -197)).easing(cc.easeIn(3));;\r\n        this.itemMiniRankParent.runAction(action2);\r\n        setTimeout(() => {\r\n            this.moveNode.active = true;\r\n        }, 500);\r\n        // this.lerp = 0;\r\n        // this.startWidth = this.greenBar.width;\r\n        this.showBubble = true;\r\n        if (this.index === this.keepIndex) {\r\n            this.finalWidth = 360 + this.percent * 360;\r\n            this.greenArrow.active = true;\r\n        } else if (this.index === (this.keepIndex + 1)) {\r\n            this.finalWidth = this.percent * 360;\r\n            this.greenArrow.active = false;\r\n        } else if (this.index < this.keepIndex) {\r\n            this.finalWidth = 720;\r\n            this.greenArrow.active = true;\r\n            this.showBubble = false;\r\n        } else {\r\n            this.finalWidth = 0;\r\n            this.greenArrow.active = false;\r\n            this.showBubble = false;\r\n        }\r\n\r\n\r\n\r\n        this.blackBar.width = 720;\r\n        if (!this.moveNode.children[0].active) this.moveNode.children[0].active = true;\r\n        if (!this.moveNode.children[1].active) this.moveNode.children[1].active = true;\r\n        if (this.index === 0) {\r\n            this.blackArrow.active = false;\r\n            this.greenArrow.active = false;\r\n            this.moveNode.children[0].active = false;\r\n            if (this.isInit) {\r\n                this.greenBar.x = 360;\r\n                this.blackBar.x = 360;\r\n                this.isInit = false;\r\n            }\r\n            this.finalWidth -= 360;\r\n        } else if (this.index === (this.rankDatas.length - 1)) {\r\n            this.blackBar.width = 360;\r\n            this.blackArrow.active = false;\r\n            this.greenArrow.active = false;\r\n            this.moveNode.children[1].active = false;\r\n        }\r\n        this.widthPer = (this.finalWidth - this.greenBar.width) > 0 ? 1 : -1;\r\n\r\n\r\n        this.refeshBubble();\r\n    },\r\n\r\n    refeshBubble: function () {\r\n\r\n        this.bubbleLabel.string = PlayerData.instance.rankStar;\r\n\r\n        this.bubbleNode.scaleY = 1;\r\n        this.bubbleStar.scaleY = 0.4;\r\n        this.bubbleLabel.node.scaleY = 1;\r\n\r\n        this.bubbleNode.scaleX = 1;\r\n        this.bubbleStar.scaleX = 0.4;\r\n        this.bubbleLabel.node.scaleX = 1;\r\n\r\n\r\n        var width = this.finalWidth;\r\n        if (width < 70) {\r\n            this.bubbleNode.scaleY = -1;\r\n            this.bubbleStar.scaleY = -0.4;\r\n            this.bubbleLabel.node.scaleY = -1;\r\n        } else if (width > 245 && width < 360) {\r\n            this.bubbleNode.scaleX = -1;\r\n            this.bubbleStar.scaleX = -0.4;\r\n            this.bubbleLabel.node.scaleX = -1;\r\n            if (width >= 330) {\r\n                width = 330;\r\n            }\r\n        } else if (width >= 360 && width < 390) {\r\n            width = 390;\r\n        } else if (width > 580 && width < 660) {\r\n            this.bubbleNode.scaleX = -1;\r\n            this.bubbleStar.scaleX = -0.4;\r\n            this.bubbleLabel.node.scaleX = -1;\r\n        } else if (width >= 660) {\r\n            this.bubbleNode.scaleY = -1;\r\n            this.bubbleStar.scaleY = -0.4;\r\n            this.bubbleLabel.node.scaleY = -1;\r\n\r\n            this.bubbleNode.scaleX = -1;\r\n            this.bubbleStar.scaleX = -0.4;\r\n            this.bubbleLabel.node.scaleX = -1;\r\n        }\r\n\r\n        this.bubbleNode.active = this.showBubble;\r\n\r\n\r\n\r\n    },\r\n\r\n    onClose() {\r\n        this.node.active = false;\r\n        // AdvertMgr.instance.showBanner();\r\n    },\r\n\r\n    update(dt) {\r\n\r\n        if (this.startMove > 0) {\r\n            this.startMove -= dt;\r\n            if (this.startMove <= 0) {\r\n                this.startMove = 0;\r\n                this.move();\r\n            }\r\n        }\r\n\r\n\r\n        if (this.greenBar.width !== this.finalWidth) {\r\n            this.greenBar.width += 720 * this.widthPer * dt;\r\n            this.bubbleNode.x = this.greenBar.width;\r\n\r\n            if (this.widthPer > 0) {\r\n                if (this.greenBar.width > this.finalWidth) {\r\n                    this.greenBar.width = this.finalWidth;\r\n                    this.bubbleNode.x = this.finalWidth;\r\n                    this.fixBubble()\r\n                }\r\n            } else {\r\n                if (this.greenBar.width < this.finalWidth) {\r\n                    this.greenBar.width = this.finalWidth;\r\n                    this.bubbleNode.x = this.finalWidth;\r\n                    this.fixBubble()\r\n                }\r\n            }\r\n\r\n        }\r\n        // console.log(this.index)\r\n\r\n\r\n        if (this.index === 0) {\r\n            if (this.blackBar.x !== 360) {\r\n                this.blackBar.x += dt * 720;\r\n                if (this.blackBar.x >= 360) {\r\n                    this.blackBar.x = 360;\r\n                }\r\n            }\r\n\r\n            if (this.greenBar.x !== 360) {\r\n                this.greenBar.x += dt * 720;\r\n                if (this.greenBar.x >= 360) {\r\n                    this.greenBar.x = 360;\r\n                }\r\n            }\r\n        } else {\r\n            if (this.blackBar.x !== 0) {\r\n                this.blackBar.x -= dt * 720;\r\n                if (this.blackBar.x <= 0) {\r\n                    this.blackBar.x = 0;\r\n                }\r\n            }\r\n\r\n            if (this.greenBar.x !== 0) {\r\n                this.greenBar.x -= dt * 720;\r\n                if (this.greenBar.x <= 0) {\r\n                    this.greenBar.x = 0;\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n\r\n        // if (this.index === 0) {\r\n        //     if (this.greenBar.x !== 360) {\r\n        //         this.greenBar.x += 720 * dt;\r\n        //         this.blackBar.x += 720 * dt;\r\n        //         this.greenBar.width -= 720 * dt;\r\n        //         if (this.greenBar.x >= 360) {\r\n        //             this.greenBar.width += (this.greenBar.x - 360);\r\n        //             this.finalWidth -= 360;\r\n        //             this.greenBar.x = 360;\r\n        //             this.blackBar.x = 360;\r\n        //         }\r\n        //     }\r\n        // } else {\r\n        //     if (this.greenBar.x !== 0) {\r\n        //         this.greenBar.x -= 720 * dt;\r\n        //         if (this.greenBar.x <= 0) {\r\n        //             this.greenBar.x = 0;\r\n        //         }\r\n        //     }\r\n        //     if (this.blackBar.x !== 0) {\r\n        //         this.blackBar.x -= 720 * dt;\r\n        //         if (this.blackBar.x <= 0) {\r\n        //             this.blackBar.x = 0;\r\n        //         }\r\n        //     }\r\n        // }\r\n    },\r\n\r\n    fixBubble() {\r\n        if (this.finalWidth >= 360 && this.finalWidth < 390) {\r\n            this.bubbleNode.x = 390;\r\n        } else if (this.finalWidth >= 330 && this.finalWidthh < 360) {\r\n            this.bubbleNode.x = 330;\r\n        }\r\n    },\r\n    // update (dt) {},\r\n});"]}