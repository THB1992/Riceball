{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui/assets\\scripts\\battle\\ui\\PanelTrySuit.js"],"names":["Tools","require","ConfigData","PlayerData","AdvertMgr","AdverType","ShareMgr","ShareType","StageType","cc","Class","extends","Component","properties","suitNameLabel","Label","suitHeroNameLabel","suitKnifeNameLabel","suitSkillLabel","adverIcon","Node","shareIcon","suitIntroduce","noThanksLabel","init","suitData","callback","closeCallback","heroData","instance","getHeroSkinById","heroSkin","knifeData","getKnifeSkinById","knifeSkin","isOwnHeroSkin","id","isOwnKnifeSkin","string","name","skillTips","introduces","children","i","length","active","stage","getCurStageByPrizeCount","Free","Share","Adver","func","hasAdver","openAdver","TryOutSkin","loadAdver","closeBtnClick","isAdver","node","adverBtnClick","self","closeFunc","success","errFunc","showShare","showAdver","share"],"mappings":"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","file":"PanelTrySuit.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui","sourcesContent":["const Tools = require('Tools');\r\nconst ConfigData = require('ConfigData');\r\nconst PlayerData = require('PlayerData');\r\nconst AdvertMgr = require('AdvertMgr');\r\nconst AdverType = require('Types').AdverType;\r\nconst ShareMgr = require('ShareMgr');\r\nconst ShareType = require('Types').ShareType;\r\nconst StageType = require('Types').StageType;\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        suitNameLabel: cc.Label,\r\n        suitHeroNameLabel: cc.Label,\r\n        suitKnifeNameLabel: cc.Label,\r\n        suitSkillLabel: cc.Label,\r\n\r\n        adverIcon: cc.Node,\r\n        shareIcon: cc.Node,\r\n        suitIntroduce: cc.Node,\r\n\r\n        //language\r\n        noThanksLabel: cc.Label,\r\n    },\r\n\r\n\r\n    init: function (suitData, callback, closeCallback) {\r\n\r\n        var heroData = ConfigData.instance.getHeroSkinById(suitData.heroSkin);\r\n        var knifeData = ConfigData.instance.getKnifeSkinById(suitData.knifeSkin);\r\n        if (callback) callback(heroData, knifeData);\r\n        this.closeCallback = closeCallback;\r\n        var isOwnHeroSkin = PlayerData.instance.isOwnHeroSkin(heroData.id);\r\n        var isOwnKnifeSkin = PlayerData.instance.isOwnKnifeSkin(knifeData.id);\r\n\r\n        this.suitNameLabel.string = suitData.name;\r\n        this.suitHeroNameLabel.string = heroData.name;\r\n        // this.suitHeroNameLabel.node.color = isOwnHeroSkin ? cc.Color.GREEN : cc.Color.RED;\r\n        this.suitKnifeNameLabel.string = knifeData.name;\r\n        // this.suitKnifeNameLabel.node.color = isOwnKnifeSkin ? cc.Color.GREEN : cc.Color.RED;\r\n        this.suitSkillLabel.string = suitData.skillTips;\r\n\r\n        var introduces = this.suitIntroduce.children;\r\n        for (let i = 0; i < introduces.length; i++) {\r\n            introduces[i].active = (i + 1) === suitData.id;\r\n        }\r\n\r\n        var stage = ConfigData.instance.getCurStageByPrizeCount(PlayerData.instance);\r\n        switch (stage) {\r\n            case StageType.Free:\r\n                break;\r\n            case StageType.Share:\r\n                this.adverIcon.active = false;\r\n                this.shareIcon.active = true;\r\n                break;\r\n            case StageType.Adver:\r\n                var func = (hasAdver) => {\r\n                    this.adverIcon.active = hasAdver;\r\n                    this.shareIcon.active = !hasAdver;\r\n\r\n                    if (hasAdver) {\r\n                        AdvertMgr.instance.openAdver(AdverType.TryOutSkin);\r\n                    }\r\n                }\r\n\r\n                AdvertMgr.instance.loadAdver(AdverType.TryOutSkin, func);\r\n                break;\r\n        }\r\n        this.noThanksLabel.string = \"No,thanks\";\r\n    },\r\n\r\n\r\n    closeBtnClick: function () {\r\n        if (this.isAdver) return;\r\n        if (this.closeCallback) this.closeCallback(false);\r\n        this.node.active = false;\r\n        // AdvertMgr.instance.destoryBanner();\r\n    },\r\n\r\n    adverBtnClick: function () {\r\n        this.isAdver = true;\r\n        var self = this;\r\n        // 关闭广告时回调\r\n        var closeFunc = function (success) {\r\n            if (success) {\r\n                if (self.closeCallback) self.closeCallback(true);\r\n                // AdvertMgr.instance.destoryBanner();\r\n                self.node.active = false;\r\n            }\r\n            self.isAdver = false;\r\n        }\r\n        // 打开广告失败时回调,失败回调\r\n        var errFunc = function () {\r\n            self.showShare();\r\n            self.isAdver = false;\r\n        }\r\n\r\n        if (this.shareIcon.active) {\r\n            self.showShare();\r\n            self.isAdver = false;\r\n        } else {\r\n            AdvertMgr.instance.showAdver(AdverType.TryOutSkin, closeFunc, errFunc);\r\n        }\r\n\r\n    },\r\n\r\n    showShare: function () {\r\n        var self = this;\r\n        ShareMgr.share(ShareType.TryOutSkin, (success) => {\r\n            if (success) {\r\n                if (self.closeCallback) self.closeCallback(true);\r\n                // AdvertMgr.instance.destoryBanner();\r\n                self.node.active = false;\r\n            }\r\n        });\r\n    },\r\n});"]}