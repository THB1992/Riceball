{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui/assets\\scripts\\battle\\ui\\PanelTryFrenzy.js"],"names":["Tools","require","ConfigData","PlayerData","AdvertMgr","AdverType","ShareMgr","ShareType","StageType","cc","Class","extends","Component","properties","adverIcon","Node","shareIcon","init","closeCallback","stage","instance","getCurStageByPrizeCount","Free","active","Share","Adver","func","hasAdver","openAdver","TryOutSkin","loadAdver","closeBtnClick","isAdver","node","adverBtnClick","self","closeFunc","success","errFunc","showShare","showAdver","share"],"mappings":"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","file":"PanelTryFrenzy.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui","sourcesContent":["const Tools = require('Tools');\r\nconst ConfigData = require('ConfigData');\r\nconst PlayerData = require('PlayerData');\r\nconst AdvertMgr = require('AdvertMgr');\r\nconst AdverType = require('Types').AdverType;\r\nconst ShareMgr = require('ShareMgr');\r\nconst ShareType = require('Types').ShareType;\r\nconst StageType = require('Types').StageType;\r\n\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        adverIcon: cc.Node,\r\n        shareIcon: cc.Node,\r\n    },\r\n\r\n    init: function (closeCallback) {\r\n        this.closeCallback = closeCallback;\r\n        // AdvertMgr.instance.showBanner();\r\n\r\n        // var stage = ConfigData.instance.getCurStage(PlayerData.instance.playCount, ConfigData.instance.clientData.adverReviveLimit);\r\n        var stage = ConfigData.instance.getCurStageByPrizeCount(PlayerData.instance);\r\n\r\n        switch (stage) {\r\n            case StageType.Free:\r\n                this.adverIcon.active = false;\r\n                this.shareIcon.active = false;\r\n                break;\r\n            case StageType.Share:\r\n                this.adverIcon.active = false;\r\n                this.shareIcon.active = true;\r\n                break;\r\n            case StageType.Adver:\r\n                var func = (hasAdver) => {\r\n                    this.adverIcon.active = hasAdver;\r\n                    this.shareIcon.active = !hasAdver;\r\n\r\n                    if (hasAdver) {\r\n                        AdvertMgr.instance.openAdver(AdverType.TryOutSkin);\r\n                    }\r\n                }\r\n\r\n                AdvertMgr.instance.loadAdver(AdverType.TryOutSkin, func);\r\n                break;\r\n        }\r\n    },\r\n\r\n    closeBtnClick: function () {\r\n        if (this.isAdver) return;\r\n        if (this.closeCallback) this.closeCallback(false);\r\n        this.node.active = false;\r\n        // AdvertMgr.instance.destoryBanner();\r\n    },\r\n\r\n    adverBtnClick: function () {\r\n        this.isAdver = true;\r\n        var self = this;\r\n        // 关闭广告时回调\r\n        var closeFunc = function (success) {\r\n            if (success) {\r\n                if (self.closeCallback) self.closeCallback(true);\r\n                // AdvertMgr.instance.destoryBanner();\r\n                self.node.active = false;\r\n            }\r\n            self.isAdver = false;\r\n        }\r\n        // 打开广告失败时回调,失败回调\r\n        var errFunc = function () {\r\n            self.showShare();\r\n            self.isAdver = false;\r\n        }\r\n\r\n        if (this.shareIcon.active) {\r\n            self.showShare();\r\n            self.isAdver = false;\r\n        } else {\r\n            AdvertMgr.instance.showAdver(AdverType.TryOutSkin, closeFunc, errFunc);\r\n        }\r\n\r\n\r\n    },\r\n\r\n    showShare: function () {\r\n        var self = this;\r\n        ShareMgr.share(ShareType.TryOutSkin, (success) => {\r\n            if (success) {\r\n                if (self.closeCallback) self.closeCallback(true);\r\n                // AdvertMgr.instance.destoryBanner();\r\n                self.node.active = false;\r\n            }\r\n        });\r\n    },\r\n});"]}