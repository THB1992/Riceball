{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\entity/assets\\scripts\\battle\\entity\\EntityBlock.js"],"names":["Tools","require","EntityBase","cc","Class","extends","properties","defenceRects","init","x","y","node","position","v2","boxes","getComponentsInChildren","BoxCollider","rect","xMin","xMax","yMin","yMax","box","Math","min","size","width","max","height","parent","getOrAddComponent","push","circles","CircleCollider","circle","radius","defenceRect"],"mappings":"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","file":"EntityBlock.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\entity","sourcesContent":["/**\n * @fileoverview 障碍实体\n * @author meifan@gameley.cn (梅凡)\n */\n\nconst Tools = require('Tools');\nconst EntityBase = require('EntityBase');\n\ncc.Class({\n    extends: EntityBase,\n\n    properties: {\n        defenceRects: [],\n    },\n\n    // onLoad () {}\n\n    init: function (x, y) {\n        this.node.position = cc.v2(x, y);\n\n        // this.width = width;\n        // this.height = height;\n\n        // this.blockSpr.width = width;\n        // this.blockSpr.height = height;\n\n        // this.blockCollider.size.width = width;\n        // this.blockCollider.size.height = height;\n\n        const boxes = this.node.getComponentsInChildren(cc.BoxCollider);\n\n        var rect = null;\n        var xMin = x;\n        var xMax = x;\n        var yMin = y;\n        var yMax = y;\n        for (var box of boxes) {\n            xMin = Math.min(xMin, x + box.node.x - box.size.width / 2);\n            xMax = Math.max(xMax, x + box.node.x + box.size.width / 2);\n            yMin = Math.min(yMin, y + box.node.y - box.size.height / 2);\n            yMax = Math.max(yMax, y + box.node.y + box.size.height / 2);\n\n            // 把box里的碰撞层拿到父节点 为ai计算提供方便\n            box.node.parent = this.node.parent;\n            box.node.position = cc.v2(x + box.node.x, y + box.node.y);\n\n            rect = Tools.getOrAddComponent(box.node, 'DefenceRect');\n            rect.init(box.size.width * 2, box.size.height * 2); //, false, false, 1.0, x + box.node.x - box.size.width / 2, y + box.node.y - box.size.height / 2);\n            this.defenceRects.push(rect);\n        }\n\n        var circles = this.node.getComponentsInChildren(cc.CircleCollider);\n\n        for (var circle of circles) {\n            xMin = Math.min(xMin, x + circle.node.x - circle.radius / 2);\n            xMax = Math.max(xMax, x + circle.node.x + circle.radius / 2);\n            yMin = Math.min(yMin, y + circle.node.y - circle.radius / 2);\n            yMax = Math.max(yMax, y + circle.node.y + circle.radius / 2);\n\n            circle.node.parent = this.node.parent;\n            circle.node.position = cc.v2(x + circle.node.x, y + circle.node.y);\n\n            rect = Tools.getOrAddComponent(circle.node, 'DefenceRect');\n            rect.init(circle.radius * 2, circle.radius * 2); //, false, false, 1.0, x + box.node.x - box.size.width / 2, y + box.node.y - box.size.height / 2);\n            this.defenceRects.push(rect);\n        }\n\n        this.defenceRect = Tools.getOrAddComponent(this.node, 'DefenceRect');\n        this.defenceRect.init((xMax - xMin) * 2, (yMax - yMin) * 2);\n    },\n\n    // start() {},\n\n    // update (dt) {},\n});"]}