{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\sdk/assets\\scripts\\sdk\\Slot.js"],"names":["PlatformMgr","require","PlatformType","GameData","cc","Class","extends","Component","properties","bg","Sprite","img","lbl","Label","onLoad","platformType","WECHAT","rdmTitle","node","getComponent","string","Math","random","processCfg","active","start","update","instance","isInReview","self","url","baseUrl","listCfg","loader","load","err","res","error","swTimes","playPat","data","main","regBoards","schedule","len","length","curIdx","cfg","imgUrl","texture","sprite","SpriteFrame","spriteFrame","onNav","wx","navigateToMiniProgram","appId","appid","path","success","console","log","adStatis"],"mappings":"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","file":"Slot.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\sdk","sourcesContent":["// var WeiShuSdk = require(\"WeiShuSdk\");\nconst PlatformMgr = require('PlatformMgr');\nconst PlatformType = require('Types').PlatformType;\nconst GameData = require('GameData');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        bg: cc.Sprite,\n        img: cc.Sprite,\n        lbl: cc.Label\n    },\n\n    onLoad () {\n        if(PlatformMgr.platformType === PlatformType.WECHAT) {\n            let rdmTitle = ['时下流行', '热门游戏', '好友在玩'];\n            this.lbl.node.getComponent(cc.Label).string = rdmTitle[Math.random() * 3|0]; //随机采用一个标题\n            this.processCfg();\n        }\n        this.node.active = false;\n    },\n\n    start () {\n\n    },\n\n    update () {\n        if (this.node.active !== !GameData.instance.isInReview) {\n            this.node.active = !GameData.instance.isInReview;\n        }\n    },\n\n    processCfg() { //下载配置文件\n        let self = this;\n        let url = PlatformMgr.baseUrl + \"Try2play/knife666_play.json\";\n        this.listCfg = [];\n        cc.loader.load( url, function( err, res) {\n            if (err) {\n                cc.error(err);\n                self.node.active = false;\n                return;\n            }\n\n            self.node.active = !GameData.instance.isInReview;\n            let swTimes = 5;\n            if(res && res.playPat && res.playPat[3]){\n                (self.listCfg = res.playPat[3].data);\n                (res.main && res.main[1].swTimes) && (swTimes = res.main[1].swTimes);\n                self.regBoards();\n                self.schedule(self.regBoards, swTimes);\n            }\n        });\n    },\n\n    regBoards() { //更新广告位显示\n        let len = this.listCfg.length;\n        this.curIdx = Math.random() * len|0;\n        let cfg = this.listCfg[this.curIdx];\n\n        let self = this;\n        let url = PlatformMgr.baseUrl + \"Try2play/\" + cfg.imgUrl;\n        cc.loader.load(url, function (err, texture) {\n            let sprite  = new cc.SpriteFrame(texture);\n            self.img.node.getComponent(cc.Sprite).spriteFrame = sprite;\n        });\n    },\n\n    onNav() { //跳转到小游戏\n        if(!this.listCfg) return;\n        let cfg = this.listCfg[this.curIdx];\n        if (wx.navigateToMiniProgram){\n            wx.navigateToMiniProgram({\n                appId: cfg.appid,\n                path: cfg.path,\n                success: function(res) {\n                    console.log(\"nav successed\");\n                    PlatformMgr.adStatis(cfg);\n                }\n            });\n        }\n    }\n});\n"]}