{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\component\\player/assets\\scripts\\battle\\component\\player\\PlayerReviveFrenzyComponent.js"],"names":["FrenzyAddType","require","FrenzyAddNums","BuffState","ConfigData","PlayerFrenzyComponent","cc","Class","extends","Component","properties","_count","_max","_time","_isFrenzy","_speed","init","data","instance","getBuffDataById","Frenzy","keepTime","_normalSpeed","_frenzySpeed","_normalTime","_frenzyTime","node","on","onFrenzyAdd","addType","length","tryFrenzy","customTime","emit","onFrenzyEnd","update","dt","getFrenzyRate","isFrenzy"],"mappings":";;;;;;AAAA;;;;;AAKA,IAAMA,gBAAgBC,QAAQ,OAAR,EAAiBD,aAAvC;AACA,IAAME,gBAAgB,CAAC,CAAD,EAAI,CAAJ,EAAO,GAAP,EAAY,IAAZ,EAAkB,IAAlB,EAAwB,GAAxB,CAAtB;AACA,IAAMC,YAAYF,QAAQ,OAAR,EAAiBE,SAAnC;AACA,IAAMC,aAAaH,QAAQ,YAAR,CAAnB;;AAEA,IAAMI,wBAAwBC,GAAGC,KAAH,CAAS;AACnCC,aAASF,GAAGG,SADuB;;AAGnCC,gBAAY;AACRC,gBAAQ,CADA;AAERC,cAAM,IAFE;AAGRC,eAAO,CAHC;AAIRC,mBAAW,KAJH;AAKRC,gBAAQ;AALA,KAHuB;;AAYnCC,UAAM,gBAAY;;AAEd,YAAIC,OAAOb,WAAWc,QAAX,CAAoBC,eAApB,CAAoChB,UAAUiB,MAA9C,CAAX;AACA,aAAKT,MAAL,GAAc,CAAd;AACA,aAAKC,IAAL,GAAY,IAAZ;AACA,aAAKC,KAAL,GAAaI,KAAKI,QAAlB;AACA,aAAKC,YAAL,GAAoB,KAAKV,IAAL,GAAY,GAAZ,GAAkB,KAAKC,KAA3C;AACA,aAAKU,YAAL,GAAoB,KAAKX,IAAL,GAAY,GAAZ,GAAkB,GAAtC;AACA,aAAKG,MAAL,GAAc,KAAKO,YAAnB;AACA,aAAKE,WAAL,GAAmB,KAAKX,KAAxB;AACA,aAAKY,WAAL,GAAmB,GAAnB;;AAEA,aAAKC,IAAL,CAAUC,EAAV,CAAa,mBAAb,EAAkC,KAAKC,WAAvC,EAAoD,IAApD;AACH,KAzBkC;;AA2BnCA,iBAAa,qBAAUC,OAAV,EAAmB;AAC5B,YAAI,KAAKf,SAAT,EAAoB;AAChB;AACH;;AAED,YAAIe,UAAU,CAAV,IAAeA,WAAW3B,cAAc4B,MAA5C,EAAoD;AAChD;AACH;;AAED,aAAKnB,MAAL,IAAeT,cAAc2B,OAAd,CAAf;;AAEA,YAAI,KAAKlB,MAAL,IAAe,KAAKC,IAAxB,EAA8B;AAC1B,iBAAKD,MAAL,GAAc,KAAKC,IAAnB;AACA,iBAAKG,MAAL,GAAec,YAAY7B,cAAc+B,SAA3B,GAAwC,KAAKR,YAA7C,GAA4D,KAAKD,YAA/E;AACA,gBAAIU,aAAcH,YAAY7B,cAAc+B,SAA3B,GAAwC,KAAKN,WAA7C,GAA2D,CAAC,CAA7E;AACA,iBAAKX,SAAL,GAAiB,IAAjB;AACA,iBAAKY,IAAL,CAAUO,IAAV,CAAe,iBAAf,EAAkC9B,UAAUiB,MAA5C,EAAoDY,UAApD;AACH;AACJ,KA7CkC;;AA+CnCE,iBAAa,uBAAY;AACrB,aAAKpB,SAAL,GAAiB,KAAjB;AACA,aAAKH,MAAL,GAAc,CAAd;AACH,KAlDkC;;AAoDnCwB,UApDmC,kBAoD5BC,EApD4B,EAoDxB;AACP,YAAI,KAAKtB,SAAT,EAAoB;AAChB,iBAAKH,MAAL,IAAe,KAAKI,MAAL,GAAcqB,EAA7B;AACA,gBAAI,KAAKzB,MAAL,IAAe,CAAnB,EAAsB;AAClB,qBAAKuB,WAAL;AACH;AACJ;AACJ,KA3DkC;;;AA6DnCG,mBAAe,yBAAY;AACvB,eAAO,KAAK1B,MAAL,GAAc,GAAd,GAAoB,KAAKC,IAAhC;AACH,KA/DkC;;AAiEnC0B,cAAU,oBAAY;AAClB,eAAO,KAAKxB,SAAZ;AACH;AAnEkC,CAAT,CAA9B","file":"PlayerReviveFrenzyComponent.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\component\\player","sourcesContent":["/**\r\n * @fileoverview PlayerFrenzyComponent\r\n * @author meifan@gameley.cn (梅凡)\r\n */\r\n\r\nconst FrenzyAddType = require('Types').FrenzyAddType;\r\nconst FrenzyAddNums = [1, 1, 300, 1000, 1000, 300];\r\nconst BuffState = require('Types').BuffState;\r\nconst ConfigData = require('ConfigData');\r\n\r\nconst PlayerFrenzyComponent = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        _count: 0,\r\n        _max: 1000,\r\n        _time: 5,\r\n        _isFrenzy: false,\r\n        _speed: 1.0,\r\n    },\r\n\r\n\r\n    init: function () {\r\n\r\n        var data = ConfigData.instance.getBuffDataById(BuffState.Frenzy);\r\n        this._count = 0;\r\n        this._max = 1000;\r\n        this._time = data.keepTime;\r\n        this._normalSpeed = this._max * 1.0 / this._time;\r\n        this._frenzySpeed = this._max * 1.0 / 5.0;\r\n        this._speed = this._normalSpeed;\r\n        this._normalTime = this._time;\r\n        this._frenzyTime = 5.0;\r\n\r\n        this.node.on('onReviveFrenzyAdd', this.onFrenzyAdd, this);\r\n    },\r\n\r\n    onFrenzyAdd: function (addType) {\r\n        if (this._isFrenzy) {\r\n            return;\r\n        }\r\n\r\n        if (addType < 0 || addType >= FrenzyAddNums.length) {\r\n            return;\r\n        }\r\n\r\n        this._count += FrenzyAddNums[addType];\r\n\r\n        if (this._count >= this._max) {\r\n            this._count = this._max;\r\n            this._speed = (addType === FrenzyAddType.tryFrenzy) ? this._frenzySpeed : this._normalSpeed;\r\n            var customTime = (addType === FrenzyAddType.tryFrenzy) ? this._frenzyTime : -1;\r\n            this._isFrenzy = true;\r\n            this.node.emit('updateBuffState', BuffState.Frenzy, customTime);\r\n        }\r\n    },\r\n\r\n    onFrenzyEnd: function () {\r\n        this._isFrenzy = false;\r\n        this._count = 0;\r\n    },\r\n\r\n    update(dt) {\r\n        if (this._isFrenzy) {\r\n            this._count -= this._speed * dt;\r\n            if (this._count <= 0) {\r\n                this.onFrenzyEnd();\r\n            }\r\n        }\r\n    },\r\n\r\n    getFrenzyRate: function () {\r\n        return this._count * 1.0 / this._max;\r\n    },\r\n\r\n    isFrenzy: function () {\r\n        return this._isFrenzy;\r\n    }\r\n});"]}