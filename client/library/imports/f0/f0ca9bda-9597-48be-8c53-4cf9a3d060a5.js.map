{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui/assets\\scripts\\battle\\ui\\PanelKnifeShop.js"],"names":["Tools","require","ConfigData","PlayerData","AdvertMgr","AdverType","ShareMgr","ShareType","TaskType","GameData","PlatformMgr","cc","Class","extends","Component","properties","topNode","Node","itemScrollView","ScrollView","itemScrollViewBar","itemScrollViewWindow","content","itemKnifeSkin","Prefab","buyNode","unLockNode","nameLabel","Label","introduceLabel","initCountLabel","countLabel","propertyNode","propertyLabel","taskStartLabel","taskProgressLabel","taskFinalLabel","taskMoreLabel","taskInfoNode","watchAdverBtnNode","downNode","watchAdverLabel","buyLangLabel","goLangLabel","jumpNode","shareIcon","adverIcon","suitNode","suitNameLabel","suiProcessLabel","suitCloseIcon","suitActiveIcon","suitHeroNameLabel","suitKnifeNameLabel","suitSkillLabel","suitHeroFlag","suitKnifeFlag","suitHeroFalseFlag","suitKnifeFalseFlag","suitIconNode","_itemCells","_itemNodes","init","world","instance","isPad","y","node","height","localPlayer","knifeSkinDatas","slice","curTime","getCurTime","ownKnifeSkins","filterDataByTime","clientData","hideSpecialSkin","isIOS","isApp","sort","a","b","newDate","isBeforeOtherTime","i","length","data","itemNode","instantiate","parent","position","v2","Math","floor","itemComp","getComponent","setOnItemClick","refresh","onScrollView","curScrollHeight","getScrollOffset","active","index","line","count","isGet","isOwnKnifeSkin","id","canUnlock","arrContains","completeTaskIds","taskId","needCheck","needCheckTaskIds","isNew","processStr","getWay","taskType","RANK","DUANWU","process","getTaskProcess","taskParam","knifeSkin","onItemClick","setCheck","string","buyBtnClick","lastCheckItem","item","priceType","gold","price","addKnifeSkin","updateGold","uiMgr","showTips","zongZi","updateZongZi","jumpBtnClick","closePanelShop","jumpParam","showPanelInvite","showPanelDailyTask","showPanelAddTop","showPanelSign","showPanelHolidayRank","unLockBtnClick","self","closeFunc","success","LOGIN","updateSignCount","refreshRedDot","showShare","showAdver","share","UnlockSkin","errFunc","event","customEventData","isInit","indexOf","scrollToOffset","onEquipKnifeSkin","lastEquipItem","setEquip","unlockWay","ADVERCOUNT","name","introduce","initKnifeCount","propertyTips","str","getStringByFormat","getUITipStr","suit","suitData","getSuitData","heroData","getHeroSkinById","heroSkin","knifeData","isOwnHeroSkin","equipHero","isCurEquipHeroSkin","equipKnife","isCurEquipKnifeSkin","skillTips","children","showActiveSuitEffect","onWathAdverBtnClick","taskMgr","refreshTaskInHome","WatchAdver","close","closeCallcack","clearNeedCheckTaskIds","setCloseCallback","callback"],"mappings":"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","file":"PanelKnifeShop.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui","sourcesContent":["const Tools = require('Tools');\r\nconst ConfigData = require('ConfigData');\r\nconst PlayerData = require('PlayerData');\r\nconst AdvertMgr = require('AdvertMgr');\r\nconst AdverType = require('Types').AdverType;\r\nconst ShareMgr = require('ShareMgr');\r\nconst ShareType = require('Types').ShareType;\r\nconst TaskType = require('Types').TaskType;\r\nconst GameData = require('GameData');\r\nconst PlatformMgr = require('PlatformMgr');\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        topNode: cc.Node,\r\n        itemScrollView: cc.ScrollView,\r\n        itemScrollViewBar: cc.Node,\r\n        itemScrollViewWindow: cc.Node,\r\n        content: cc.Node,\r\n        itemKnifeSkin: cc.Prefab,\r\n\r\n        buyNode: cc.Node,\r\n        unLockNode: cc.Node,\r\n        nameLabel: cc.Label,\r\n        introduceLabel: cc.Label,\r\n        initCountLabel: cc.Label,\r\n        countLabel: cc.Label,\r\n        propertyNode: cc.Node,\r\n        propertyLabel: cc.Label,\r\n\r\n        taskStartLabel: cc.Label,\r\n        taskProgressLabel: cc.Label,\r\n        taskFinalLabel: cc.Label,\r\n        taskMoreLabel: cc.Label,\r\n\r\n        taskInfoNode: cc.Node,\r\n        watchAdverBtnNode: cc.Node,\r\n        downNode: cc.Node,\r\n\r\n        watchAdverLabel: cc.Label,\r\n        buyLangLabel: cc.Label,\r\n        goLangLabel: cc.Label,\r\n\r\n        jumpNode: cc.Node,\r\n        //解锁btn的图标\r\n        shareIcon: cc.Node,\r\n        adverIcon: cc.Node,\r\n\r\n\r\n        //套装\r\n        suitNode: cc.Node,\r\n        suitNameLabel: cc.Label,\r\n        suiProcessLabel: cc.Label,\r\n        suitCloseIcon: cc.Node,\r\n        suitActiveIcon: cc.Node,\r\n        suitHeroNameLabel: cc.Label,\r\n        suitKnifeNameLabel: cc.Label,\r\n        suitSkillLabel: cc.Label,\r\n        suitHeroFlag: cc.Node,\r\n        suitKnifeFlag: cc.Node,\r\n        suitHeroFalseFlag: cc.Node,\r\n        suitKnifeFalseFlag: cc.Node,\r\n        suitIconNode: cc.Node,\r\n\r\n        _itemCells: [],\r\n        _itemNodes: [],\r\n    },\r\n\r\n    init: function (world) {\r\n\r\n        if (GameData.instance.isPad()) {\r\n            this.topNode.y = -200;\r\n            this.itemScrollView.node.height = 200;\r\n            this.itemScrollViewWindow.height = 200;\r\n            this.itemScrollViewBar.height = 200;\r\n        } else {\r\n            this.topNode.y = 0;\r\n            this.itemScrollView.node.height = 400;\r\n            this.itemScrollViewWindow.height = 400;\r\n            this.itemScrollViewBar.height = 400;\r\n        }\r\n\r\n\r\n        this.world = world;\r\n        this.localPlayer = world.localPlayer;\r\n        var knifeSkinDatas = ConfigData.instance.knifeSkinDatas.slice();\r\n\r\n\r\n        var curTime = PlayerData.instance.getCurTime();\r\n        var ownKnifeSkins = PlayerData.instance.ownKnifeSkins;\r\n        Tools.filterDataByTime(knifeSkinDatas, ownKnifeSkins, curTime, GameData.instance, ConfigData.instance.clientData.hideSpecialSkin, PlatformMgr.isIOS(), PlatformMgr.isApp());\r\n\r\n\r\n        knifeSkinDatas.sort((a, b) => {\r\n            if (a.newDate && Tools.isBeforeOtherTime(a.newDate, curTime)) {\r\n                return -1;\r\n            } else if (b.newDate && Tools.isBeforeOtherTime(b.newDate, curTime)) {\r\n                return 1;\r\n            } else {\r\n                return a.sort - b.sort;\r\n            }\r\n        })\r\n\r\n        // this.myScrollView = Tools.getOrAddComponent(this.itemScrollView.node, 'MyScrollView');\r\n        // this._itemCells = this.myScrollView.init(knifeSkinDatas, (line) => {\r\n        //     console.log(line);\r\n        // }, {\r\n        //     target: this, //点击时触发的脚本\r\n        //     itemPrefab: this.itemKnifeSkin,\r\n        //     className: 'ItemKnifeSkin',\r\n        //     startX: -235,\r\n        //     gapX: 15,\r\n        //     gapY: 10,\r\n        //     perLine: 3,\r\n        // })\r\n        for (let i = 0; i < knifeSkinDatas.length; i++) {\r\n            var data = knifeSkinDatas[i];\r\n            // if (data.showDate&&Tools.isBeforeOtherTime(curTime, data.showDate)) {\r\n            //     i--;\r\n            //     continue;\r\n            // }\r\n\r\n            if (!this._itemNodes[i]) {\r\n                let itemNode = cc.instantiate(this.itemKnifeSkin);\r\n                itemNode.parent = this.content;\r\n                itemNode.position = cc.v2(i % 3 * 230 - 235, -78 - Math.floor(i / 3) * 146);\r\n                this._itemNodes[i] = itemNode;\r\n                var itemComp = itemNode.getComponent('ItemKnifeSkin')\r\n                itemComp.init(data);\r\n                this._itemCells[i] = itemComp;\r\n                itemComp.setOnItemClick(this, itemComp);\r\n            } else {\r\n                var itemComp = this._itemNodes[i].getComponent('ItemKnifeSkin')\r\n                itemComp.init(data);\r\n            }\r\n\r\n        }\r\n        this.content.height = Math.floor(this._itemCells.length / 3) * 150 + 150;\r\n        // var scrollViewCulling = Tools.getOrAddComponent(this.itemScrollView.node, 'ScrollViewCulling');\r\n        // scrollViewCulling.init(this.itemScrollView, this._itemCells, {\r\n        //     countPerLine: 3,\r\n        // });\r\n\r\n        this.refresh();\r\n        this.onScrollView();\r\n    },\r\n\r\n    onScrollView: function () {\r\n        // this.myScrollView.onScrollView();\r\n        // return\r\n        //当前滑动所在位置\r\n        var curScrollHeight = this.itemScrollView.getScrollOffset().y;\r\n        if (curScrollHeight < Math.floor((this._itemCells.length - 1) / 3) * 150 - 300) {\r\n            if (!this.downNode.active) this.downNode.active = true;\r\n        } else {\r\n            if (this.downNode.active) this.downNode.active = false;\r\n        };\r\n\r\n        var index = Math.floor((curScrollHeight) / 150);\r\n        // console.log(curScrollHeight)\r\n        // console.log(index)\r\n        for (let i = 0; i < this._itemCells.length; i++) {\r\n            var line = Math.floor(i / 3);\r\n            if (line <= index + 3 && line >= index) {\r\n                if (!this._itemNodes[i].active) this._itemNodes[i].active = true;\r\n            } else {\r\n                if (this._itemNodes[i].active) this._itemNodes[i].active = false;\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    // refreshItem: function (itemComp) {\r\n    //     var data = itemComp.data;\r\n    //     var isGet = PlayerData.instance.isOwnKnifeSkin(data.id);\r\n    //     var canUnlock = Tools.arrContains(PlayerData.instance.completeTaskIds, data.taskId);\r\n    //     var needCheck = Tools.arrContains(PlayerData.instance.needCheckTaskIds, data.taskId);\r\n    //     var isNew = data.newDate && Tools.isBeforeOtherTime(data.newDate, PlayerData.instance.getCurTime());\r\n\r\n    //     var processStr = '';\r\n    //     if (data.getWay === 1) {\r\n    //         if (data.taskType !== TaskType.RANK && data.taskType !== TaskType.DUANWU) {\r\n    //             var process = PlayerData.instance.getTaskProcess(data.taskType);\r\n    //             processStr = process + '/' + data.taskParam;\r\n    //         }\r\n    //     }\r\n\r\n    //     itemComp.refresh(isGet, canUnlock, needCheck, isNew, processStr);\r\n    //     // if (isGet) count++;\r\n    //     // if (PlayerData.instance.knifeSkin.id === data.id) {\r\n    //     //     this.onItemClick(null, itemComp, true)\r\n    //     //     itemComp.setCheck(false);\r\n    //     // }\r\n    // },\r\n\r\n    refresh: function () {\r\n        var count = 0;\r\n        for (const itemComp of this._itemCells) {\r\n            if (!itemComp) continue;\r\n            var data = itemComp.data;\r\n            var isGet = PlayerData.instance.isOwnKnifeSkin(data.id);\r\n            var canUnlock = Tools.arrContains(PlayerData.instance.completeTaskIds, data.taskId);\r\n            var needCheck = Tools.arrContains(PlayerData.instance.needCheckTaskIds, data.taskId);\r\n            var isNew = data.newDate && Tools.isBeforeOtherTime(data.newDate, PlayerData.instance.getCurTime());\r\n\r\n            var processStr = '';\r\n            if (data.getWay === 1) {\r\n                if (data.taskType !== TaskType.RANK && data.taskType !== TaskType.DUANWU) {\r\n                    var process = PlayerData.instance.getTaskProcess(data.taskType);\r\n                    processStr = process + '/' + data.taskParam;\r\n                }\r\n            }\r\n\r\n            itemComp.refresh(isGet, canUnlock, needCheck, isNew, processStr);\r\n            if (isGet) count++;\r\n            if (PlayerData.instance.knifeSkin.id === data.id) {\r\n                this.onItemClick(null, itemComp, true)\r\n                itemComp.setCheck(false);\r\n            }\r\n        }\r\n        this.countLabel.string = count + '/' + this._itemCells.length;\r\n    },\r\n\r\n    buyBtnClick: function () {\r\n        if (this.lastCheckItem) {\r\n            var item = this.lastCheckItem;\r\n            switch (item.data.priceType) {\r\n                case 0: {\r\n                    if (PlayerData.instance.gold >= item.data.price) {\r\n                        PlayerData.instance.addKnifeSkin(item.data.id);\r\n                        PlayerData.instance.updateGold(-(item.data.price));\r\n                        this.refresh();\r\n                        this.onItemClick(null, item);\r\n                    } else {\r\n                        this.world.uiMgr.showTips(7)\r\n                    }\r\n                    break;\r\n                }\r\n                case 1: {\r\n                    if (PlayerData.instance.zongZi >= item.data.price) {\r\n                        PlayerData.instance.addKnifeSkin(item.data.id);\r\n                        PlayerData.instance.updateZongZi(-(item.data.price));\r\n                        this.refresh();\r\n                        this.onItemClick(null, item);\r\n                    } else {\r\n                        this.world.uiMgr.showTips('Insufficient Diamond');\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    jumpBtnClick: function () {\r\n        if (this.lastCheckItem) {\r\n            this.world.uiMgr.closePanelShop();\r\n            // this.close();\r\n            var item = this.lastCheckItem;\r\n            switch (item.data.jumpParam) {\r\n                case 'PanelInvite': {\r\n                    this.world.uiMgr.showPanelInvite();\r\n                    break;\r\n                }\r\n                case 'PanelDailyTask': {\r\n                    this.world.uiMgr.showPanelDailyTask();\r\n                    break;\r\n                }\r\n                case 'PanelAddTop': {\r\n                    this.world.uiMgr.showPanelAddTop();\r\n                    break;\r\n                }\r\n                case 'PanelSign': {\r\n                    this.world.uiMgr.showPanelSign();\r\n                    break;\r\n                }\r\n                case 'PanelHolidayRank': {\r\n                    this.world.uiMgr.showPanelHolidayRank(true);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    //解锁皮肤按钮\r\n    unLockBtnClick: function () {\r\n        var self = this;\r\n        // 关闭广告时回调\r\n        var closeFunc = (success) => {\r\n            if (self.lastCheckItem && success) {\r\n                var item = self.lastCheckItem;\r\n                PlayerData.instance.addKnifeSkin(item.data.id);\r\n                self.refresh();\r\n                self.onItemClick(null, item);\r\n                if (item.data.taskType === TaskType.LOGIN) {\r\n                    PlayerData.instance.updateSignCount();\r\n                }\r\n                self.world.uiMgr.refreshRedDot();\r\n            }\r\n        }\r\n\r\n        if (this.shareIcon.active) {\r\n            this.showShare(closeFunc);\r\n        } else {\r\n            this.showAdver(closeFunc);\r\n        }\r\n    },\r\n\r\n    showShare: function (closeFunc) {\r\n        ShareMgr.share(ShareType.UnlockSkin, closeFunc);\r\n    },\r\n\r\n    showAdver: function (closeFunc) {\r\n        var self = this;\r\n        var errFunc = () => {\r\n            this.showShare(closeFunc);\r\n        }\r\n        AdvertMgr.instance.showAdver(AdverType.UnlockSkin, closeFunc, errFunc);\r\n    },\r\n\r\n    onItemClick: function (event, customEventData, isInit = false) {\r\n        var itemComp = customEventData;\r\n        var data = itemComp.data;\r\n\r\n        // if (data.sort > 6) {\r\n        var index = this._itemCells.indexOf(itemComp);\r\n        this.itemScrollView.scrollToOffset(cc.v2(0, Math.floor(index / 3) * 150 - 150 + (GameData.instance.isPad() ? 150 : 0)), 1);\r\n        // }\r\n\r\n        if (this.lastCheckItem) this.lastCheckItem.setCheck(false);\r\n        itemComp.setCheck(true);\r\n        this.lastCheckItem = itemComp;\r\n\r\n        this.buyNode.active = false;\r\n        this.unLockNode.active = false;\r\n        this.watchAdverBtnNode.active = false;\r\n        this.jumpNode.active = false;\r\n\r\n        this.world.onEquipKnifeSkin(data, itemComp.isGet, false);\r\n        if (itemComp.isGet) {\r\n            if (this.lastEquipItem) this.lastEquipItem.setEquip(false)\r\n            this.lastEquipItem = itemComp;\r\n            itemComp.setEquip(true);\r\n        } else {\r\n            if (data.getWay === 0) {\r\n                this.buyNode.active = true;\r\n            } else if (data.getWay === 1) {\r\n                if (Tools.arrContains(PlayerData.instance.completeTaskIds, data.taskId)) {\r\n                    this.unLockNode.active = true;\r\n                    this.shareIcon.active = data.unlockWay === 1;\r\n                    this.adverIcon.active = data.unlockWay === 2;\r\n\r\n                    // if (data.unlockWay === 1) {\r\n                    //     if (GameData.instance.isInReview) {\r\n                    //         this.shareIcon.active = false;\r\n                    //         this.adverIcon.active = true;\r\n                    //     } \r\n                    // }\r\n\r\n                } else if (data.taskType === TaskType.ADVERCOUNT) {\r\n                    this.watchAdverBtnNode.active = true;\r\n                } else if (data.jumpParam) {\r\n                    this.jumpNode.active = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        this.nameLabel.string = data.name;\r\n        this.introduceLabel.string = data.introduce;\r\n        this.initCountLabel.string = data.initKnifeCount;\r\n        this.propertyNode.active = data.propertyTips ? true : false;\r\n        this.propertyLabel.string = data.propertyTips ? data.propertyTips : '';\r\n\r\n        this.taskInfoNode.active = data.getWay === 1;\r\n        if (this.taskInfoNode.active) {\r\n            var process = PlayerData.instance.getTaskProcess(data.taskType);\r\n            var str = process < data.taskParam ? process : data.taskParam;\r\n            this.taskStartLabel.string = '(';\r\n            this.taskProgressLabel.string = str ? str : 0;\r\n            this.taskFinalLabel.string = '/' + data.taskParam;\r\n            this.taskMoreLabel.string = ')';\r\n\r\n            if (data.taskType === TaskType.RANK || data.taskType === TaskType.DUANWU) {\r\n                this.taskStartLabel.string = '';\r\n                this.taskProgressLabel.string = '';\r\n                this.taskFinalLabel.string = '';\r\n                this.taskMoreLabel.string = '';\r\n            }\r\n\r\n            this.watchAdverLabel.string = Tools.getStringByFormat(ConfigData.instance.getUITipStr(20), str, data.taskParam)\r\n        }\r\n        this.buyLangLabel.string = 'Buy'\r\n        this.goLangLabel.string = 'Go'\r\n\r\n        this.suitNode.active = data.suit;\r\n        if (data.suit) {\r\n            var suitData = ConfigData.instance.getSuitData(data.suit);\r\n            var heroData = ConfigData.instance.getHeroSkinById(suitData.heroSkin);\r\n            var knifeData = data;\r\n            var isOwnHeroSkin = PlayerData.instance.isOwnHeroSkin(suitData.heroSkin);\r\n            var isOwnKnifeSkin = PlayerData.instance.isOwnKnifeSkin(suitData.knifeSkin);\r\n            var equipHero = PlayerData.instance.isCurEquipHeroSkin(heroData.id);\r\n            var equipKnife = PlayerData.instance.isCurEquipKnifeSkin(knifeData.id);\r\n\r\n\r\n            this.suitNameLabel.string = suitData.name;\r\n            var process = 0;\r\n            if (isOwnHeroSkin) process++;\r\n            if (isOwnKnifeSkin) process++;\r\n            this.suiProcessLabel.string = '(' + process + '/2)';\r\n            this.suitHeroNameLabel.string = heroData.name;\r\n            this.suitKnifeNameLabel.string = knifeData.name;\r\n            this.suitSkillLabel.string = suitData.skillTips;\r\n            for (let i = 0; i < this.suitIconNode.children.length; i++) {\r\n                if (this.suitIconNode.children[i]) {\r\n                    this.suitIconNode.children[i].active = (i + 1) == data.suit;\r\n                }\r\n            }\r\n\r\n\r\n            this.suitHeroFlag.active = equipHero;\r\n            this.suitKnifeFlag.active = equipKnife;\r\n            this.suitHeroFalseFlag.active = !equipHero;\r\n            this.suitKnifeFalseFlag.active = !equipKnife;\r\n\r\n\r\n            this.suitActiveIcon.active = isOwnHeroSkin && isOwnKnifeSkin && equipHero && equipKnife;\r\n            this.suitCloseIcon.active = !(isOwnHeroSkin && isOwnKnifeSkin && equipHero && equipKnife);\r\n\r\n            if (this.suitActiveIcon.active && !isInit) {\r\n                this.world.uiMgr.showActiveSuitEffect();\r\n            }\r\n        }\r\n    },\r\n\r\n    //累计看广告按钮\r\n    onWathAdverBtnClick: function () {\r\n        var self = this;\r\n        // 关闭广告时回调\r\n        var closeFunc = function (success) {\r\n            if (self.lastCheckItem && success) {\r\n                var item = self.lastCheckItem;\r\n                self.world.taskMgr.refreshTaskInHome();\r\n                self.refresh();\r\n                self.onItemClick(null, item);\r\n                // self.world.uiMgr.showTips('累计观看广告次数+1')\r\n            }\r\n        }\r\n        // 打开广告失败时回调,失败回调\r\n        var errFunc = function () {\r\n            self.world.uiMgr.showTips(4)\r\n        }\r\n\r\n        AdvertMgr.instance.showAdver(AdverType.WatchAdver, closeFunc, errFunc);\r\n\r\n    },\r\n\r\n    close: function () {\r\n        this.lastEquipItem.setEquip(false);\r\n        if (this.lastCheckItem) this.lastCheckItem.setCheck(false);\r\n        if (this.closeCallcack) this.closeCallcack();\r\n        this.world.onEquipKnifeSkin(PlayerData.instance.knifeSkin, true);\r\n        PlayerData.instance.clearNeedCheckTaskIds();\r\n    },\r\n\r\n    setCloseCallback: function (callback) {\r\n        this.closeCallcack = callback;\r\n    },\r\n    // update (dt) {},\r\n});"]}