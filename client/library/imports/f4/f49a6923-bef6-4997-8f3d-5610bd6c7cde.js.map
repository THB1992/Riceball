{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\component\\move/assets\\scripts\\battle\\component\\move\\MoveByKeyboard.js"],"names":["cc","Class","extends","Component","onLoad","_moveL","_moveU","_moveR","_moveD","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","onDestroy","off","event","keyCode","macro","KEY","a","w","d","s","j","node","emit","needStop","cycleMoveByKeyboard","curPos","v2","add","dPos","update","dt"],"mappings":"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","file":"MoveByKeyboard.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\component\\move","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    onLoad: function () {\n        this._moveL = false;\n        this._moveU = false;\n        this._moveR = false;\n        this._moveD = false;\n\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n    },\n\n    onDestroy: function () {\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n    },\n\n    onKeyDown: function (event) {\n        // 有按键按下时，判断是否是我们指定的方向控制键，并设置向对应方向加速\n        switch (event.keyCode) {\n            case cc.macro.KEY.a:\n                this._moveL = true;\n                break;\n            case cc.macro.KEY.w:\n                this._moveU = true;\n                break;\n            case cc.macro.KEY.d:\n                this._moveR = true;\n                break;\n            case cc.macro.KEY.s:\n                this._moveD = true;\n                break;\n            case cc.macro.KEY.j:\n                this.node.emit('onHoldAttackTrigger');\n                break;\n        }\n    },\n    \n    onKeyUp: function (event) {\n        // 松开按键时，停止向该方向的加速\n        var needStop = false;\n        switch (event.keyCode) {\n            case cc.macro.KEY.a:\n                this._moveL = false;\n                // this.node.emit('onStopMoving');\n                needStop = true;\n                break;\n            case cc.macro.KEY.w:\n                this._moveU = false;\n                // this.node.emit('onStopMoving');\n                needStop = true;\n                break;\n            case cc.macro.KEY.d:\n                this._moveR = false;\n                // this.node.emit('onStopMoving');\n                needStop = true;\n                break;\n            case cc.macro.KEY.s:\n                this._moveD = false;\n                // this.node.emit('onStopMoving');\n                needStop = true;\n                break;\n            case cc.macro.KEY.j:\n                this.node.emit('onReleaseAttackTrigger');\n                break;\n        }\n\n        if (needStop) {\n            if (!this._moveL && !this._moveU && !this._moveR && !this._moveD) {\n                this.node.emit('onStopMoving');\n            }\n        }\n    },\n\n    // cal the pos move by keyboard \n    cycleMoveByKeyboard() {\n        if (this._moveL || this._moveU || this._moveR || this._moveD) {\n\n            var curPos = cc.v2(0, 0);\n            if (this._moveL) {\n                curPos = curPos.add(cc.v2(-1, 0));\n            }\n            if (this._moveU) {\n                curPos = curPos.add(cc.v2(0, 1));\n            }\n            if (this._moveR) {\n                curPos = curPos.add(cc.v2(1, 0));\n            }\n            if (this._moveD) {\n                curPos = curPos.add(cc.v2(0, -1));\n            }\n            this.node.emit('onMoveBy', {\n                dPos: curPos\n            });\n        }\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    update: function (dt) {\n        this.cycleMoveByKeyboard();\n    },\n});\n"]}