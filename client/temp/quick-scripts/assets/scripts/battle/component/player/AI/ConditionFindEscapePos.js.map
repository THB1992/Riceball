{"version":3,"sources":["ConditionFindEscapePos.js"],"names":["ConditionBaseComponent","require","GameData","Tools","MapType","ConditionFindEscapePos","cc","Class","extends","properties","init","setMapSize","instance","mapWidth","mapHeight","_speed","node","on","initWalls","type","wallType","_Width","_height","detail","width","height","getReal","_min","v2","_max","value","ret","Circle","doResultWithParam","heros","result","hero","position","sub","addSelf","mulSelf","clampf"],"mappings":";;;;;;AAAA;;;;;AAKA,IAAMA,yBAAyBC,QAAQ,wBAAR,CAA/B;AACA,IAAMC,WAAWD,QAAQ,UAAR,CAAjB;AACA,IAAME,QAAQF,QAAQ,OAAR,CAAd;AACA,IAAMG,UAAUH,QAAQ,OAAR,EAAiBG,OAAjC;;AAEA;AACA,IAAMC,yBAAyBC,GAAGC,KAAH,CAAS;AACpCC,aAASR,sBAD2B;;AAGpCS,gBAAY,EAHwB;;AAKpCC,UAAM,gBAAY;;AAEd,aAAKC,UAAL,CAAgB,CAACT,SAASU,QAAT,CAAkBC,QAAnB,EAA6BX,SAASU,QAAT,CAAkBE,SAA/C,CAAhB;AACA,aAAKC,MAAL,GAAc,CAAd;;AAEA,aAAKC,IAAL,CAAUC,EAAV,CAAa,YAAb,EAA2B,KAAKN,UAAhC,EAA4C,IAA5C;AACA,aAAKK,IAAL,CAAUC,EAAV,CAAa,WAAb,EAA0B,KAAKC,SAA/B,EAA0C,IAA1C;AACH,KAZmC;;AAcpCA,eAAW,mBAAUC,IAAV,EAAgB;AACvB,aAAKC,QAAL,GAAgBD,IAAhB;AACA,aAAKR,UAAL,CAAgB,CAAC,KAAKU,MAAN,EAAc,KAAKC,OAAnB,CAAhB;AACH,KAjBmC;;AAmBpCX,gBAAY,oBAAUY,MAAV,EAAkB;AAC1B,YAAMC,QAAQD,OAAO,CAAP,CAAd;AACA,YAAME,SAASF,OAAO,CAAP,CAAf;;AAEA,aAAKF,MAAL,GAAc,KAAKK,OAAL,CAAaF,KAAb,CAAd;AACA,aAAKF,OAAL,GAAe,KAAKI,OAAL,CAAaD,MAAb,CAAf;;AAEA,aAAKE,IAAL,GAAYrB,GAAGsB,EAAH,CAAM,CAAC,KAAKP,MAAN,GAAe,CAArB,EAAwB,CAAC,KAAKC,OAAN,GAAgB,CAAxC,CAAZ;AACA,aAAKO,IAAL,GAAYvB,GAAGsB,EAAH,CAAM,KAAKP,MAAL,GAAc,CAApB,EAAuB,KAAKC,OAAL,GAAe,CAAtC,CAAZ;AACH,KA5BmC;;AA8BpCI,aAAS,iBAAUI,KAAV,EAAiB;AACtB,YAAIC,MAAMD,QAAQ,GAAlB;;AAEA,YAAG,KAAKV,QAAR,EAAkB;AACd,gBAAG,KAAKA,QAAL,KAAkBhB,QAAQ4B,MAA7B,EAAqC;AACjCD,sBAAMA,MAAM,GAAZ;AACH;AACJ;;AAED,eAAOA,GAAP;AACH,KAxCmC;;AA0CpC;AACAE,uBAAmB,2BAAUC,KAAV,EAAiB;AAChC,YAAI,CAAC,KAAKC,MAAV,EAAkB,CAEjB;;AAED,YAAIP,KAAK,IAAT;AALgC;AAAA;AAAA;;AAAA;AAMhC,iCAAiBM,KAAjB,8HAAwB;AAAA,oBAAfE,IAAe;;AACpBR,qBAAK,KAAKZ,IAAL,CAAUqB,QAAV,CAAmBC,GAAnB,CAAuBF,KAAKpB,IAAL,CAAUqB,QAAjC,CAAL;AACA,qBAAKF,MAAL,GAAc,KAAKA,MAAL,GAAc,KAAKA,MAAL,CAAYI,OAAZ,CAAoBX,EAApB,EAAwBY,OAAxB,CAAgC,GAAhC,CAAd,GAAqDZ,EAAnE;AACH;AAT+B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAWhC,aAAKO,MAAL,GAAc,KAAKA,MAAL,CAAYK,OAAZ,CAAoB,KAAKzB,MAAzB,EAAiCwB,OAAjC,CAAyC,KAAKvB,IAAL,CAAUqB,QAAnD,EAA6DI,MAA7D,CAAoE,KAAKd,IAAzE,EAA+E,KAAKE,IAApF,CAAd;AACH;;AAED;;AAEA;AA3DoC,CAAT,CAA/B","file":"ConditionFindEscapePos.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\component\\player\\AI","sourcesContent":["/**\n * @fileoverview 离其他ai太近条件\n * @author meifan@gameley.cn (梅凡)\n */\n\nconst ConditionBaseComponent = require('ConditionBaseComponent');\nconst GameData = require('GameData');\nconst Tools = require('Tools');\nconst MapType = require('Types').MapType;\n\n// result从PlayerDistanceSystem确定，是另外多个ai的Entity的数组\nconst ConditionFindEscapePos = cc.Class({\n    extends: ConditionBaseComponent,\n\n    properties: {},\n\n    init: function () {\n        \n        this.setMapSize([GameData.instance.mapWidth, GameData.instance.mapHeight]);\n        this._speed = 3;\n\n        this.node.on('setMapSize', this.setMapSize, this);\n        this.node.on('initWalls', this.initWalls, this);\n    },\n\n    initWalls: function (type) {\n        this.wallType = type;\n        this.setMapSize([this._Width, this._height]);\n    },\n\n    setMapSize: function (detail) {\n        const width = detail[0];\n        const height = detail[1];\n\n        this._Width = this.getReal(width);\n        this._height = this.getReal(height);\n\n        this._min = cc.v2(-this._Width / 2, -this._height / 2);\n        this._max = cc.v2(this._Width / 2, this._height / 2);\n    },\n\n    getReal: function (value) {\n        var ret = value * 0.9;\n        \n        if(this.wallType) {\n            if(this.wallType === MapType.Circle) {\n                ret = ret / 1.5;\n            }\n        }\n\n        return ret;\n    },\n\n    /** overwrite */\n    doResultWithParam: function (heros) {\n        if (!this.result) {\n\n        }\n\n        var v2 = null;\n        for (var hero of heros) {\n            v2 = this.node.position.sub(hero.node.position);\n            this.result = this.result ? this.result.addSelf(v2).mulSelf(0.5) : v2;\n        }\n\n        this.result = this.result.mulSelf(this._speed).addSelf(this.node.position).clampf(this._min, this._max);\n    },\n\n    // updateGameLogic: function (dt) {}\n\n    // update: {}\n});"]}