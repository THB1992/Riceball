{"version":3,"sources":["PlayerSuitComponent.js"],"names":["SuitType","require","ConfigData","KnifeState","KnifeMomentState","cc","Class","extends","Component","properties","buffRemainTimes","lightTime","lightKeepTime","rayTime","init","player","changeSuit","node","on","catchEnemyByBatMan","suit","ULTRAMAN","rayNode","active","colliders","getComponentsInChildren","Collider","i","length","collider","notColliderFlag","tag","teamID","updateGameLogic","dt","world","knifes","isStopCtrl","PIKAQIU","_pikaKeepEffect","stop","_ultraAttackEffect","SPIDERMAN","multip","heroScale","newScaleMultip","newScale","scale","index","knife","knifeStateComp","state","Normal","knifeColliderNodeCtrl","attackCollider","dir","position","sub","dis","mag","normalize","mul","finalPosition","draw","knifeMoveCtrl","isSpider","_pikaAttackEffect","vec","v2","x","y","rotate","parent","rotation","Math","PI","add","emit","root","children","scaleX","angle","playOnce","play","NEZHA","nezhaAttackEffect","_nezhaAttackEffect","getComponent","curKnife","isNEZHA","setNeZhaPosition","scaleY","setTimeout","BATMAN","isStartGame","time","isBefore","myGuide","myGuideComp","playBeforeAnim","canClose","changeColliderState","changePosArrTarget","changeOpacity","moveByTouch","touchEndEvent","action","setTarget","myCamera","targetNode","playStartAnim","setShadow","startAnim","a0","moveTo","easing","easeBackOut","runAction","entityWorld","setTimeScale","playEndAnim","YELLOWMAN","getKnifeNum","l","_yellowManEffect","open","addBuff","openShadow","closeShadow","closeNode","die","drawLighting","ctx","step","per","random","lineTo","stroke"],"mappings":";;;;;;AAAA,IAAMA,WAAWC,QAAQ,OAAR,EAAiBD,QAAlC;AACA,IAAME,aAAaD,QAAQ,YAAR,CAAnB;AACA,IAAME,aAAaF,QAAQ,OAAR,EAAiBE,UAApC;AACA,IAAMC,mBAAmBH,QAAQ,OAAR,EAAiBG,gBAA1C;AACAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,yBAAiB,EADT;AAERC,mBAAW,CAFH;AAGRC,uBAAe,CAHP;;AAKRC,iBAAS;AALD,KAHP;;AAYLC,UAAM,cAAUC,MAAV,EAAkB;AACpB,aAAKA,MAAL,GAAcA,MAAd;AACA;AACA;AACA;AACA;AACA,aAAKC,UAAL;AACA,aAAKC,IAAL,CAAUC,EAAV,CAAa,oBAAb,EAAmC,KAAKC,kBAAxC,EAA4D,IAA5D;AACH,KApBI;;AAsBLH,gBAAY,sBAAY;AACpB,YAAI,KAAKD,MAAL,CAAYK,IAAZ,KAAqBpB,SAASqB,QAAlC,EAA4C;AACxC,iBAAKN,MAAL,CAAYO,OAAZ,CAAoBC,MAApB,GAA6B,IAA7B;;AAEA,iBAAKC,SAAL,GAAiB,KAAKT,MAAL,CAAYO,OAAZ,CAAoBG,uBAApB,CAA4CpB,GAAGqB,QAA/C,CAAjB;AACA;AACA,iBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAI,KAAKH,SAAL,CAAeI,MAAnC,EAA2CD,GAA3C,EAAgD;AAC5C,oBAAIE,WAAW,KAAKL,SAAL,CAAeG,CAAf,CAAf;AACAE,yBAASC,eAAT,GAA2B,IAA3B;AACAD,yBAASE,GAAT,GAAe,KAAKhB,MAAL,CAAYiB,MAA3B;AACH;AACJ,SAVD,MAUO;AACH,iBAAKjB,MAAL,CAAYO,OAAZ,CAAoBC,MAApB,GAA6B,KAA7B;AACH;AACJ,KApCI;;AAsCLU,mBAtCK,2BAsCWC,EAtCX,EAsCeC,KAtCf,EAsCsBC,MAtCtB,EAsC8B;AAAA;;AAC/B,YAAI,KAAKrB,MAAL,CAAYsB,UAAhB,EAA4B;;AAE5B,YAAI,KAAKtB,MAAL,CAAYK,IAAZ,KAAqBpB,SAASsC,OAAlC,EAA2C;AACvC,iBAAKvB,MAAL,CAAYwB,eAAZ,CAA4BC,IAA5B;AACH;AACD,YAAI,KAAKzB,MAAL,CAAYK,IAAZ,KAAqBpB,SAASqB,QAAlC,EAA4C;AACxC,iBAAKN,MAAL,CAAY0B,kBAAZ,CAA+BD,IAA/B;AACH;;AAED,gBAAQ,KAAKzB,MAAL,CAAYK,IAApB;AACI,iBAAKpB,SAAS0C,SAAd;AAAyB;AACrB;AACA,wBAAIC,SAAS,KAAK5B,MAAL,CAAY6B,SAAZ,CAAsBC,cAAnC;AACA,wBAAIC,WAAY,CAAC,KAAK/B,MAAL,CAAYE,IAAZ,CAAiB8B,KAAjB,GAAyBJ,MAA1B,IAAoC,GAArC,GAA4CA,MAA3D;AACA,wBAAIK,QAAQ,CAAZ;AAJqB;AAAA;AAAA;;AAAA;AAKrB,6CAAoBZ,MAApB,8HAA4B;AAAA,gCAAjBa,KAAiB;;AACxB,gCAAIA,MAAMjB,MAAN,KAAiB,CAAjB,IAAsBiB,MAAMC,cAAN,CAAqBC,KAArB,KAA+BhD,WAAWiD,MAAhE,IAA0E,CAACH,MAAMI,qBAAN,CAA4BC,cAA5B,CAA2CxB,eAA1H,EAA2I;AACvI;AACA;AACA;AACA,oCAAIyB,MAAMN,MAAMhC,IAAN,CAAWuC,QAAX,CAAoBC,GAApB,CAAwB,KAAK1C,MAAL,CAAYE,IAAZ,CAAiBuC,QAAzC,CAAV;AACA,oCAAIE,MAAMH,IAAII,GAAJ,EAAV;AACA;;AAEA,oCAAID,MAAO,MAAMZ,QAAjB,EAA4B;AACxBE;AACA;AACAO,0CAAMA,IAAIK,SAAJ,GAAgBC,GAAhB,CAAoB,EAApB,CAAN;AACA,wCAAIC,gBAAgB,KAAK/C,MAAL,CAAYE,IAAZ,CAAiBuC,QAArC;AACAP,0CAAMc,IAAN,CAAWD,aAAX;AACAb,0CAAMe,aAAN,CAAoBC,QAApB,GAA+B,IAA/B;AACAhB,0CAAMe,aAAN,CAAoBF,aAApB,GAAoCA,aAApC;AACA;AACH;AAEJ;AACD,gCAAId,SAAS,CAAb,EAAgB;AACZ;AACH;AACJ;AA7BoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AA8BrB;AACH;AACD,iBAAKhD,SAASsC,OAAd;AAAuB;AACnB,yBAAK3B,SAAL,IAAkBuB,EAAlB;AACA,yBAAKtB,aAAL,IAAsBsB,EAAtB;AACA,wBAAIgC,oBAAoB,KAAKnD,MAAL,CAAYmD,iBAApC;AACA,wBAAI,CAACA,iBAAL,EAAwB;AACxB;AACA;AACA;;AAEA,wBAAI,KAAKtD,aAAL,GAAqB,CAAzB,EAA4B;AACxB;AACA,4BAAI,KAAKD,SAAL,GAAiB,GAArB,EAA0B;AACtB,gCAAIgC,SAAS,KAAK5B,MAAL,CAAY6B,SAAZ,CAAsBC,cAAnC;AACA,gCAAIC,WAAY,CAAC,KAAK7B,IAAL,CAAU8B,KAAV,GAAkBJ,MAAnB,IAA6B,GAA9B,GAAqCA,MAApD;AAFsB;AAAA;AAAA;;AAAA;AAGtB,sDAAoBP,MAApB,mIAA4B;AAAA,wCAAjBa,MAAiB;;AACxB,wCAAIA,OAAMjB,MAAN,KAAiB,CAAjB,IAAsBiB,OAAMjB,MAAN,KAAiB,KAAKjB,MAAL,CAAYiB,MAAnD,IAA6DiB,OAAMC,cAAN,CAAqBC,KAArB,KAA+BhD,WAAWiD,MAA3G,EAAmH;AAAE;AACjH,4CAAIe,MAAM9D,GAAG+D,EAAH,CAAMnB,OAAMhC,IAAN,CAAWoD,CAAjB,EAAoBpB,OAAMhC,IAAN,CAAWqD,CAA/B,EAAkCC,MAAlC,CAAyCtB,OAAMhC,IAAN,CAAWuD,MAAX,CAAkBC,QAAlB,GAA6BC,KAAKC,EAAlC,GAAuC,GAAhF,CAAV;AACA,4CAAIpB,MAAMY,IAAIS,GAAJ,CAAQ3B,OAAMhC,IAAN,CAAWuD,MAAX,CAAkBhB,QAA1B,EAAoCC,GAApC,CAAwC,KAAKxC,IAAL,CAAUuC,QAAlD,CAAV;AACA,4CAAIE,MAAMH,IAAII,GAAJ,EAAV;AACA,4CAAID,MAAO,MAAMZ,QAAjB,EAA4B;AACxB;AACAG,mDAAMhC,IAAN,CAAW4D,IAAX,CAAgB,YAAhB;AACA1C,kDAAMlB,IAAN,CAAW4D,IAAX,CAAgB,qBAAhB,EAAuC5B,OAAMhC,IAA7C;;AAEA;AACA;AACA,gDAAI6D,OAAOZ,kBAAkBjD,IAAlB,CAAuB8D,QAAvB,CAAgC,CAAhC,CAAX;AACAD,iDAAKE,MAAL,GAAczB,IAAII,GAAJ,KAAY,GAAZ,GAAkBmB,KAAKN,MAAL,CAAYQ,MAA5C;;AAEA,gDAAIP,WAAW,CAAf;AACA,gDAAIlB,IAAIc,CAAJ,KAAU,CAAV,IAAed,IAAIe,CAAJ,KAAU,CAA7B,EAAgC;AAC5BG,2DAAWlB,IAAI0B,KAAJ,CAAU5E,GAAG+D,EAAH,CAAM,CAAC,CAAP,EAAU,CAAV,CAAV,KAA2B,MAAMM,KAAKC,EAAtC,CAAX;AACH;AACD,gDAAIpB,IAAIe,CAAJ,GAAQ,CAAZ,EAAe;AACXG,2DAAW,CAACA,QAAZ;AACH;AACDK,iDAAKL,QAAL,GAAgBA,QAAhB;AACAP,8DAAkBgB,QAAlB;AACA;AACA,iDAAKvE,SAAL,GAAiB,CAAjB;AACA;AACH;AACJ;AACJ;AAhCqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiCzB;AACJ,qBApCD,MAoCO,IAAI,KAAKC,aAAL,GAAqB,CAAzB,EAA4B;AAC/B,6BAAKG,MAAL,CAAYwB,eAAZ,CAA4BC,IAA5B;AACA;AACA;AACH,qBAJM,MAIA;AACH,6BAAK5B,aAAL,GAAqB,CAArB;AACA,6BAAKG,MAAL,CAAYwB,eAAZ,CAA4B4C,IAA5B;AACH;AACD;AACA;AACA;AACA;AACH;AACD,iBAAKnF,SAASoF,KAAd;AAAqB;;AAEjB,yBAAKzE,SAAL,IAAkBuB,EAAlB;AACA,yBAAKtB,aAAL,IAAsBsB,EAAtB;AACA,wBAAImD,oBAAoB,KAAKtE,MAAL,CAAYuE,kBAAZ,CAA+BC,YAA/B,CAA4C,cAA5C,CAAxB;AACA,wBAAI,CAACF,iBAAL,EAAwB;AACxB;AACA;AACA;;AAEA;;AAEA,wBAAI1C,SAAS,KAAK5B,MAAL,CAAY6B,SAAZ,CAAsBC,cAAnC;AACA,wBAAIC,WAAY,CAAC,KAAK7B,IAAL,CAAU8B,KAAV,GAAkBJ,MAAnB,IAA6B,GAA9B,GAAqCA,MAApD;;AAEA,wBAAI,KAAK6C,QAAT,EAAmB;AACf,4BAAIvC,UAAQ,KAAKuC,QAAjB;AACA,4BAAIrB,MAAM9D,GAAG+D,EAAH,CAAMnB,QAAMhC,IAAN,CAAWoD,CAAjB,EAAoBpB,QAAMhC,IAAN,CAAWqD,CAA/B,EAAkCC,MAAlC,CAAyCtB,QAAMhC,IAAN,CAAWuD,MAAX,CAAkBC,QAAlB,GAA6BC,KAAKC,EAAlC,GAAuC,GAAhF,CAAV;AACA,4BAAIpB,MAAMY,IAAIS,GAAJ,CAAQ3B,QAAMhC,IAAN,CAAWuD,MAAX,CAAkBhB,QAA1B,EAAoCC,GAApC,CAAwC,KAAKxC,IAAL,CAAUuC,QAAlD,CAAV;AACA,4BAAIE,MAAMH,IAAII,GAAJ,EAAV;AACA,4BAAIV,QAAMjB,MAAN,KAAiB,CAAjB,IAAsB0B,MAAO,MAAMZ,QAAvC,EAAkD;AAC9C;AACAG,oCAAMe,aAAN,CAAoByB,OAApB,GAA8B,IAA9B;AACAxC,oCAAMe,aAAN,CAAoBF,aAApB,GAAoC,KAAK/C,MAAL,CAAYE,IAAZ,CAAiBuC,QAArD;AACA,gCAAIsB,OAAOO,kBAAkBpE,IAA7B;AACA,gCAAIwD,WAAW,CAAf;AACA,gCAAIlB,IAAIc,CAAJ,KAAU,CAAV,IAAed,IAAIe,CAAJ,KAAU,CAA7B,EAAgC;AAC5BG,2CAAWlB,IAAI0B,KAAJ,CAAU5E,GAAG+D,EAAH,CAAM,CAAC,CAAP,EAAU,CAAV,CAAV,KAA2B,MAAMM,KAAKC,EAAtC,CAAX;AACH;AACD,gCAAIpB,IAAIe,CAAJ,GAAQ,CAAZ,EAAe;AACXG,2CAAW,CAACA,QAAZ;AACH;AACDK,iCAAKL,QAAL,GAAgBA,WAAW,EAA3B;AACH,yBAbD,MAaO;AACH,iCAAKe,QAAL,GAAgB,IAAhB;AACH;AACJ,qBArBD,MAqBO;AACH,4BAAI,KAAK5E,aAAL,GAAqB,CAAzB,EAA4B;AAAA;AAAA;AAAA;;AAAA;AACxB,sDAAoBwB,MAApB,mIAA4B;AAAA,wCAAjBa,OAAiB;;AACxB,wCAAIA,QAAMjB,MAAN,KAAiB,CAAjB,IAAsBiB,QAAMjB,MAAN,KAAiB,KAAKjB,MAAL,CAAYiB,MAAnD,IAA6DiB,QAAMC,cAAN,CAAqBC,KAArB,KAA+BhD,WAAWiD,MAA3G,EAAmH;AAAE;AACjH,4CAAIe,MAAM9D,GAAG+D,EAAH,CAAMnB,QAAMhC,IAAN,CAAWoD,CAAjB,EAAoBpB,QAAMhC,IAAN,CAAWqD,CAA/B,EAAkCC,MAAlC,CAAyCtB,QAAMhC,IAAN,CAAWuD,MAAX,CAAkBC,QAAlB,GAA6BC,KAAKC,EAAlC,GAAuC,GAAhF,CAAV;AACA,4CAAIpB,MAAMY,IAAIS,GAAJ,CAAQ3B,QAAMhC,IAAN,CAAWuD,MAAX,CAAkBhB,QAA1B,EAAoCC,GAApC,CAAwC,KAAKxC,IAAL,CAAUuC,QAAlD,CAAV;AACA,4CAAIE,MAAMH,IAAII,GAAJ,EAAV;AACA,4CAAID,MAAO,MAAMZ,QAAjB,EAA4B;AACxBG,oDAAMhC,IAAN,CAAW4D,IAAX,CAAgB,YAAhB;AACA5B,oDAAMe,aAAN,CAAoB0B,gBAApB,CAAqC,KAAK3E,MAAL,CAAYE,IAAZ,CAAiBuC,QAAtD;AACA;AACA;AACAP,oDAAMhC,IAAN,CAAW8B,KAAX,GAAmB,CAAnB;AACA;AACAZ,kDAAMlB,IAAN,CAAW4D,IAAX,CAAgB,eAAhB,EAAiC5B,QAAMhC,IAAvC;AACA,gDAAI6D,OAAOO,kBAAkBpE,IAA7B;AACA6D,iDAAKa,MAAL,GAAcjC,MAAM,GAApB;AACA2B,8DAAkBH,QAAlB;AACA;AACA,iDAAKtE,aAAL,GAAqB,CAArB;AACA,iDAAKD,SAAL,GAAiB,CAAjB;AACA,iDAAK6E,QAAL,GAAgBvC,OAAhB;AACA;AACH;AACJ;AACJ;AAxBuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA0B3B;AACJ;AACD;AACA;AACA;AACA;AACH;AACD,iBAAKjD,SAASqB,QAAd;AAAwB;AACpB,yBAAKT,aAAL,IAAsBsB,EAAtB;AACA,wBAAI,KAAKtB,aAAL,GAAqB,EAAzB,EAA6B;AACzB,6BAAKG,MAAL,CAAY0B,kBAAZ,CAA+ByC,QAA/B;AACAU,mCAAW,YAAM;AACb,gCAAI,SAAQ,MAAKpE,SAAjB,EAA4B;AACxB,qCAAK,IAAIG,IAAI,CAAb,EAAgBA,IAAI,MAAKH,SAAL,CAAeI,MAAnC,EAA2CD,GAA3C,EAAgD;AAC5C,wCAAIE,WAAW,MAAKL,SAAL,CAAeG,CAAf,CAAf;AACA,wCAAIE,QAAJ,EAAcA,SAASC,eAAT,GAA2B,KAA3B;AACjB;AACJ;AACJ,yBAPD,EAOG,IAPH;;AASA8D,mCAAW,YAAM;AACb,gCAAI,SAAQ,MAAKpE,SAAjB,EAA4B;AACxB,qCAAK,IAAIG,IAAI,CAAb,EAAgBA,IAAI,MAAKH,SAAL,CAAeI,MAAnC,EAA2CD,GAA3C,EAAgD;AAC5C,wCAAIE,WAAW,MAAKL,SAAL,CAAeG,CAAf,CAAf;AACA,wCAAIE,QAAJ,EAAcA,SAASC,eAAT,GAA2B,IAA3B;AACjB;AACJ;AACJ,yBAPD,EAOG,IAPH;;AASA,6BAAKlB,aAAL,GAAqB,CAArB;AACH;AACD;AACH;AACD,iBAAKZ,SAAS6F,MAAd;AAAsB;AAClB,wBAAI,CAAC,KAAK9E,MAAL,CAAY+E,WAAjB,EAA8B;AAC9B,yBAAKlF,aAAL,IAAsBsB,EAAtB;;AAEA,wBAAI6D,OAAO,EAAX;AACA,wBAAI,KAAKnF,aAAL,GAAsBmF,OAAO,GAA7B,IAAqC,KAAKnF,aAAL,IAAuBmF,OAAO,CAAvE,EAA2E;AACvE,4BAAI,CAAC,KAAKC,QAAV,EAAoB;AAChB,iCAAKA,QAAL,GAAgB,IAAhB;AACA,iCAAKjF,MAAL,CAAYkF,OAAZ,CAAoB1E,MAApB,GAA6B,IAA7B;AACA,iCAAKR,MAAL,CAAYmF,WAAZ,CAAwBC,cAAxB;AACH;AACD,6BAAKpF,MAAL,CAAYkF,OAAZ,CAAoBzC,QAApB,GAA+B,KAAKvC,IAAL,CAAUuC,QAAzC;AACA,6BAAKzC,MAAL,CAAYkF,OAAZ,CAAoBlD,KAApB,GAA4B,KAAK9B,IAAL,CAAU8B,KAAtC;AACH;;AAED,wBAAI,KAAKnC,aAAL,GAAsBmF,OAAO,CAAjC,EAAqC;AACjC,4BAAI,CAAC,KAAKhF,MAAL,CAAYkF,OAAZ,CAAoBG,QAAzB,EAAmC;AAC/B,iCAAKrF,MAAL,CAAYkF,OAAZ,CAAoBG,QAApB,GAA+B,IAA/B;AACA,iCAAKrF,MAAL,CAAYsF,mBAAZ,CAAgC,KAAhC;AACA,iCAAKtF,MAAL,CAAYuF,kBAAZ,CAA+B,KAAKvF,MAAL,CAAYmF,WAA3C;AACA,iCAAKjF,IAAL,CAAU4D,IAAV,CAAe,YAAf,EAA6B,IAA7B;AACA,iCAAK9D,MAAL,CAAYwF,aAAZ,CAA0B,GAA1B;AACA,gCAAI,KAAKxF,MAAL,CAAYyF,WAAhB,EAA6B;AACzB,qCAAKzF,MAAL,CAAYyF,WAAZ,CAAwBC,aAAxB;AACA,oCAAI,KAAK1F,MAAL,CAAYyF,WAAhB,EAA6B,KAAKzF,MAAL,CAAYyF,WAAZ,CAAwB1F,IAAxB,CAA6B,KAAKC,MAAL,CAAYmF,WAAzC;AAChC,6BAHD,MAGO;AACH,oCAAIQ,SAAS,KAAKzF,IAAL,CAAUsE,YAAV,CAAuB,YAAvB,CAAb;AACA,oCAAImB,MAAJ,EAAYA,OAAOC,SAAP,CAAiB,KAAK5F,MAAL,CAAYkF,OAA7B;AACf;;AAED;AACA,iCAAKlF,MAAL,CAAYkF,OAAZ,CAAoBpB,IAApB,CAAyB,YAAzB,EAAuC,KAAvC;AACA,gCAAI,KAAK9D,MAAL,CAAY6F,QAAhB,EAA0B,KAAK7F,MAAL,CAAY6F,QAAZ,CAAqBC,UAArB,GAAkC,KAAK9F,MAAL,CAAYkF,OAA9C;AAC1B,iCAAKlF,MAAL,CAAYmF,WAAZ,CAAwBY,aAAxB;AACA,iCAAK/F,MAAL,CAAYmF,WAAZ,CAAwBa,SAAxB,CAAkC,IAAlC;AACH;AACJ;;AAED,wBAAI,KAAKnG,aAAL,GAAsBmF,OAAO,EAAjC,EAAsC;AAClC,6BAAKnF,aAAL,GAAqB,CAArB;AACA,6BAAKoF,QAAL,GAAgB,KAAhB;AACA,4BAAI,KAAKjF,MAAL,CAAYkF,OAAZ,CAAoBG,QAAxB,EAAkC;AAC9B,iCAAKrF,MAAL,CAAYkF,OAAZ,CAAoBG,QAApB,GAA+B,KAA/B;AACA,iCAAKrF,MAAL,CAAYkF,OAAZ,CAAoBlD,KAApB,GAA4B,KAAKhC,MAAL,CAAYE,IAAZ,CAAiB8B,KAA7C;AACA,iCAAKhC,MAAL,CAAYmF,WAAZ,CAAwBc,SAAxB,CAAkC/F,IAAlC,CAAuCM,MAAvC,GAAgD,KAAhD;AACA,iCAAKR,MAAL,CAAYmF,WAAZ,CAAwBa,SAAxB,CAAkC,KAAlC;AACA,gCAAIE,KAAK5G,GAAG6G,MAAH,CAAU,GAAV,EAAe,KAAKnG,MAAL,CAAYkF,OAAZ,CAAoBzC,QAAnC,EAA6C2D,MAA7C,CAAoD9G,GAAG+G,WAAH,CAAe,GAAf,CAApD,CAAT;AACA,iCAAKnG,IAAL,CAAUoG,SAAV,CAAoBJ,EAApB;AACArB,uCAAW,YAAM;AACb,oCAAI,SAAQ,MAAK7E,MAAb,IAAuB,MAAKA,MAAL,CAAYuG,WAAvC,EAAoD,MAAKvG,MAAL,CAAYuG,WAAZ,CAAwBC,YAAxB,CAAqC,GAArC;AACvD,6BAFD,EAEG,GAFH;;AAIA3B,uCAAW,YAAM;AACb,oCAAI,SAAQ,MAAK7E,MAAjB,EAAyB,MAAKA,MAAL,CAAYmF,WAAZ,CAAwBsB,WAAxB;AAC5B,6BAFD,EAEG,GAFH;;AAIA,iCAAKvG,IAAL,CAAU4D,IAAV,CAAe,YAAf,EAA6B,IAA7B;AACA,iCAAK9D,MAAL,CAAYwF,aAAZ,CAA0B,GAA1B;AACA,gCAAI,KAAKxF,MAAL,CAAYyF,WAAhB,EAA6B;AACzB,qCAAKzF,MAAL,CAAYyF,WAAZ,CAAwBC,aAAxB;AACA,qCAAK1F,MAAL,CAAYyF,WAAZ,CAAwB1F,IAAxB,CAA6B,IAA7B;AACH,6BAHD,MAGO;AACH,oCAAI4F,SAAS,KAAKzF,IAAL,CAAUsE,YAAV,CAAuB,YAAvB,CAAb;AACA,oCAAImB,MAAJ,EAAYA,OAAOC,SAAP,CAAiB,KAAK1F,IAAtB;AACf;;AAED2E,uCAAW,YAAM;AACb,oCAAI,SAAQ,MAAK7E,MAAjB,EAAyB;AACrB,wCAAI,MAAKA,MAAL,CAAYuG,WAAhB,EAA6B,MAAKvG,MAAL,CAAYuG,WAAZ,CAAwBC,YAAxB,CAAqC,CAArC;AAChC;AACJ,6BAJD,EAIG,IAJH;;AAMA3B,uCAAW,YAAM;AACb,oCAAI,SAAQ,MAAK7E,MAAjB,EAAyB;AACrB,0CAAKA,MAAL,CAAYsF,mBAAZ,CAAgC,IAAhC;AACA,0CAAKtF,MAAL,CAAYuF,kBAAZ,CAA+B,MAAKvF,MAApC;AACA,0CAAKE,IAAL,CAAU4D,IAAV,CAAe,YAAf,EAA6B,KAA7B;AACA,wCAAI,MAAK9D,MAAL,CAAY6F,QAAhB,EAA0B,MAAK7F,MAAL,CAAY6F,QAAZ,CAAqBC,UAArB,GAAkC,MAAK5F,IAAvC;AAC7B;AACJ,6BAPD,EAOG,IAPH;AAQH;AACJ;AACD;AACH;AACD,iBAAKjB,SAASyH,SAAd;AAAyB;AACrB,wBAAI,CAAC,KAAK1G,MAAL,CAAY+E,WAAjB,EAA8B;AAC9B,yBAAKlF,aAAL,IAAsBsB,EAAtB;AACA,wBAAI,KAAKnB,MAAL,CAAY2G,WAAZ,MAA6B,CAAjC,EAAoC;AACpC,wBAAI,KAAK9G,aAAL,GAAqB,EAAzB,EAA6B;AACzB,6BAAK,IAAIe,IAAI,CAAR,EAAWgG,IAAIvF,OAAOR,MAAtB,EAA8BqB,OAAnC,EAA0CtB,IAAIgG,CAA9C,EAAiDhG,GAAjD,EAAsD;AAClDsB,sCAAQb,OAAOT,CAAP,CAAR;AACA,gCAAIsB,QAAMjB,MAAN,KAAiB,KAAKjB,MAAL,CAAYiB,MAAjC,EAAyC;AACrCiB,wCAAMhC,IAAN,CAAW4D,IAAX,CAAgB,YAAhB;AACA5B,wCAAMhC,IAAN,CAAWM,MAAX,GAAoB,KAApB;AACA,qCAAKX,aAAL,GAAqB,CAArB;AACA,qCAAKG,MAAL,CAAY6G,gBAAZ,CAA6BC,IAA7B;AACAjC,2CAAW,YAAM;AACb,wCAAI,SAAQ,MAAK7E,MAAjB,EAAyB;AACrB,8CAAKA,MAAL,CAAY+G,OAAZ,CAAoB,CAApB;AACA,8CAAK/G,MAAL,CAAY+G,OAAZ,CAAoB,CAApB;AACA,8CAAK/G,MAAL,CAAYgH,UAAZ;AACH;AACJ,iCAND,EAMG,IANH;AAOAnC,2CAAW,YAAM;AACb,wCAAI,SAAQ,MAAK7E,MAAjB,EAAyB;AACrB,8CAAKA,MAAL,CAAYiH,WAAZ;AACA,8CAAKjH,MAAL,CAAY6G,gBAAZ,CAA6BK,SAA7B;AACH;AACJ,iCALD,EAKG,IALH;AAMA;AACH;AACJ;AACJ;;AAED;AACH;AACD;AAAS;AACL;AACA;AACH;;AAlTL;AAqTH,KArWI;AAwWLC,OAxWK,iBAwWC;AACF,aAAKnH,MAAL,CAAYwB,eAAZ,CAA4BC,IAA5B;AACA,aAAKzB,MAAL,CAAY0B,kBAAZ,CAA+BD,IAA/B;AACA,aAAKzB,MAAL,CAAY6G,gBAAZ,CAA6BK,SAA7B;AACH,KA5WI;AA8WLE,gBA9WK,wBA8WQ5E,GA9WR,EA8Wa;AACd,YAAI6E,MAAM,KAAKrH,MAAL,CAAYqH,GAAtB;AACA,YAAIC,OAAO,CAAX;AACA,YAAIrF,QAAQ,CAAZ;AACAoF,YAAIlB,MAAJ,CAAW,CAAX,EAAc,CAAd;AACA,eAAOlE,QAAQqF,IAAf,EAAqB;AACjBrF;AACA,gBAAIsF,MAAMtF,QAAQqF,IAAlB;AACA,gBAAIlE,MAAM9D,GAAG+D,EAAH,CAAMkE,MAAM/E,IAAIc,CAAhB,EAAmBiE,MAAM/E,IAAIe,CAA7B,CAAV;AACA;AACA;AACA;;AAEAH,gBAAIE,CAAJ,GAAQF,IAAIE,CAAJ,GAAQ,CAACK,KAAK6D,MAAL,KAAgB,GAAjB,IAAwBhF,IAAIc,CAA5C;;AAEA;;;AAGA+D,gBAAII,MAAJ,CAAWrE,IAAIE,CAAf,EAAkBF,IAAIG,CAAtB;AACH;AACD8D,YAAII,MAAJ,CAAWjF,IAAIc,CAAf,EAAkBd,IAAIe,CAAtB;AACA8D,YAAIK,MAAJ;AACH,KApYI;AAsYLtH,sBAtYK,gCAsYgB;AACjB,aAAKP,aAAL,GAAqB,GAArB;AACH;AAxYI,CAAT","file":"PlayerSuitComponent.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\component\\player","sourcesContent":["const SuitType = require('Types').SuitType;\r\nconst ConfigData = require('ConfigData');\r\nconst KnifeState = require('Types').KnifeState;\r\nconst KnifeMomentState = require('Types').KnifeMomentState;\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        buffRemainTimes: [],\r\n        lightTime: 0,\r\n        lightKeepTime: 0,\r\n\r\n        rayTime: 0,\r\n    },\r\n\r\n\r\n    init: function (player) {\r\n        this.player = player;\r\n        // this.colliders = this.player.rayNode.getComponentsInChildren(cc.Collider);\r\n        // for (var collider of this.colliders) {\r\n        //     collider.notColliderFlag = true;\r\n        // }\r\n        this.changeSuit();\r\n        this.node.on('catchEnemyByBatMan', this.catchEnemyByBatMan, this)\r\n    },\r\n\r\n    changeSuit: function () {\r\n        if (this.player.suit === SuitType.ULTRAMAN) {\r\n            this.player.rayNode.active = true;\r\n\r\n            this.colliders = this.player.rayNode.getComponentsInChildren(cc.Collider);\r\n            // for (var collider of this.colliders) {\r\n            for (var i = 0; i < this.colliders.length; i++) {\r\n                var collider = this.colliders[i];\r\n                collider.notColliderFlag = true;\r\n                collider.tag = this.player.teamID;\r\n            }\r\n        } else {\r\n            this.player.rayNode.active = false;\r\n        }\r\n    },\r\n\r\n    updateGameLogic(dt, world, knifes) {\r\n        if (this.player.isStopCtrl) return;\r\n\r\n        if (this.player.suit !== SuitType.PIKAQIU) {\r\n            this.player._pikaKeepEffect.stop();\r\n        }\r\n        if (this.player.suit !== SuitType.ULTRAMAN) {\r\n            this.player._ultraAttackEffect.stop();\r\n        }\r\n\r\n        switch (this.player.suit) {\r\n            case SuitType.SPIDERMAN: {\r\n                // this.player._pikaKeepEffect.stop();\r\n                var multip = this.player.heroScale.newScaleMultip;\r\n                var newScale = ((this.player.node.scale - multip) / 1.5) + multip;\r\n                var index = 0;\r\n                for (const knife of knifes) {\r\n                    if (knife.teamID === 0 && knife.knifeStateComp.state === KnifeState.Normal && !knife.knifeColliderNodeCtrl.attackCollider.notColliderFlag) {\r\n                        // var worldPos = knife.node.parent.convertToWorldSpaceAR(knife.node.position);\r\n                        // var dir = this.player.node.convertToNodeSpaceAR(worldPos);\r\n                        // var dis = dir.mag()\r\n                        var dir = knife.node.position.sub(this.player.node.position);\r\n                        var dis = dir.mag();\r\n                        // knife.dislabel.string = Math.floor(dis);\r\n\r\n                        if (dis < (380 * newScale)) {\r\n                            index++;\r\n                            // knife.node.emit('onPickUpKnife', this.player.pickCollider);\r\n                            dir = dir.normalize().mul(20)\r\n                            var finalPosition = this.player.node.position;\r\n                            knife.draw(finalPosition);\r\n                            knife.knifeMoveCtrl.isSpider = true;\r\n                            knife.knifeMoveCtrl.finalPosition = finalPosition;\r\n                            // console.log(knife.node.position, finalPosition)\r\n                        }\r\n\r\n                    }\r\n                    if (index >= 1) {\r\n                        break;\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n            case SuitType.PIKAQIU: {\r\n                this.lightTime += dt;\r\n                this.lightKeepTime += dt;\r\n                var _pikaAttackEffect = this.player._pikaAttackEffect;\r\n                if (!_pikaAttackEffect) return;\r\n                // ctx.clear();\r\n                // ctx.node.scale = 1 / this.node.scale;\r\n                // ctx.node.rotation = -this.node.rotation;\r\n\r\n                if (this.lightKeepTime < 4) {\r\n                    // console.log('放电中', Math.floor(this.lightKeepTime))\r\n                    if (this.lightTime > 0.4) {\r\n                        var multip = this.player.heroScale.newScaleMultip;\r\n                        var newScale = ((this.node.scale - multip) / 1.5) + multip;\r\n                        for (const knife of knifes) {\r\n                            if (knife.teamID !== 0 && knife.teamID !== this.player.teamID && knife.knifeStateComp.state !== KnifeState.Normal) { // && knife.knifeColliderNodeCtrl.attackCollider.notColliderFlag) {\r\n                                var vec = cc.v2(knife.node.x, knife.node.y).rotate(knife.node.parent.rotation * Math.PI / 180)\r\n                                var dir = vec.add(knife.node.parent.position).sub(this.node.position);\r\n                                var dis = dir.mag();\r\n                                if (dis < (400 * newScale)) {\r\n                                    // this.drawLighting(dir);\r\n                                    knife.node.emit('throwKnife');\r\n                                    world.node.emit('destroyDefenceKnife', knife.node);\r\n\r\n                                    // if (!ctx.active) this.ropeNode.active = true;\r\n                                    // var dir = this.drawPos.sub(this.node.position)\r\n                                    var root = _pikaAttackEffect.node.children[0];\r\n                                    root.scaleX = dir.mag() / 240 / root.parent.scaleX;\r\n\r\n                                    var rotation = 0;\r\n                                    if (dir.x !== 0 && dir.y !== 0) {\r\n                                        rotation = dir.angle(cc.v2(-1, 0)) * (180 / Math.PI);\r\n                                    }\r\n                                    if (dir.y < 0) {\r\n                                        rotation = -rotation;\r\n                                    }\r\n                                    root.rotation = rotation;\r\n                                    _pikaAttackEffect.playOnce();\r\n                                    // this.drawLighting(dir);\r\n                                    this.lightTime = 0;\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                } else if (this.lightKeepTime < 7) {\r\n                    this.player._pikaKeepEffect.stop();\r\n                    // console.log('冷却中', Math.floor(this.lightKeepTime))\r\n                    //冷却中\r\n                } else {\r\n                    this.lightKeepTime = 0;\r\n                    this.player._pikaKeepEffect.play();\r\n                }\r\n                //  else if (this.lightTime > 0.1) {\r\n                //     ctx.clear();\r\n                // }\r\n                break\r\n            }\r\n            case SuitType.NEZHA: {\r\n\r\n                this.lightTime += dt;\r\n                this.lightKeepTime += dt;\r\n                var nezhaAttackEffect = this.player._nezhaAttackEffect.getComponent('EntityEffect');\r\n                if (!nezhaAttackEffect) return;\r\n                // ctx.clear();\r\n                // ctx.node.scale = 1 / this.node.scale;\r\n                // ctx.node.rotation = -this.node.rotation;\r\n\r\n                // console.log('放电中', Math.floor(this.lightKeepTime))\r\n\r\n                var multip = this.player.heroScale.newScaleMultip;\r\n                var newScale = ((this.node.scale - multip) / 1.5) + multip;\r\n\r\n                if (this.curKnife) {\r\n                    let knife = this.curKnife;\r\n                    var vec = cc.v2(knife.node.x, knife.node.y).rotate(knife.node.parent.rotation * Math.PI / 180)\r\n                    var dir = vec.add(knife.node.parent.position).sub(this.node.position);\r\n                    var dis = dir.mag();\r\n                    if (knife.teamID === 0 && dis > (100 * newScale)) {\r\n                        // knife.draw(this.player.node.position);\r\n                        knife.knifeMoveCtrl.isNEZHA = true;\r\n                        knife.knifeMoveCtrl.finalPosition = this.player.node.position;\r\n                        var root = nezhaAttackEffect.node;\r\n                        var rotation = 0;\r\n                        if (dir.x !== 0 && dir.y !== 0) {\r\n                            rotation = dir.angle(cc.v2(-1, 0)) * (180 / Math.PI);\r\n                        }\r\n                        if (dir.y < 0) {\r\n                            rotation = -rotation;\r\n                        }\r\n                        root.rotation = rotation - 90;\r\n                    } else {\r\n                        this.curKnife = null\r\n                    }\r\n                } else {\r\n                    if (this.lightKeepTime > 0) {\r\n                        for (const knife of knifes) {\r\n                            if (knife.teamID !== 0 && knife.teamID !== this.player.teamID && knife.knifeStateComp.state !== KnifeState.Normal) { // && knife.knifeColliderNodeCtrl.attackCollider.notColliderFlag) {\r\n                                var vec = cc.v2(knife.node.x, knife.node.y).rotate(knife.node.parent.rotation * Math.PI / 180)\r\n                                var dir = vec.add(knife.node.parent.position).sub(this.node.position);\r\n                                var dis = dir.mag();\r\n                                if (dis < (400 * newScale)) {\r\n                                    knife.node.emit('throwKnife');\r\n                                    knife.knifeMoveCtrl.setNeZhaPosition(this.player.node.position);\r\n                                    // knife.node.emit('updateState', KnifeState.Normal);\r\n                                    // knife.node.emit('updateMomentState', KnifeMomentState.ReleaseFinish)\r\n                                    knife.node.scale = 2;\r\n                                    // world.node.emit('destroyDefenceKnife', knife.node);\r\n                                    world.node.emit('onNeZhaAttack', knife.node);\r\n                                    var root = nezhaAttackEffect.node;\r\n                                    root.scaleY = dis / 600;\r\n                                    nezhaAttackEffect.playOnce();\r\n                                    // this.drawLighting(dir);\r\n                                    this.lightKeepTime = 0;\r\n                                    this.lightTime = 0;\r\n                                    this.curKnife = knife;\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                    }\r\n                }\r\n                //  else if (this.lightTime > 0.1) {\r\n                //     ctx.clear();\r\n                // }\r\n                break\r\n            }\r\n            case SuitType.ULTRAMAN: {\r\n                this.lightKeepTime += dt;\r\n                if (this.lightKeepTime > 10) {\r\n                    this.player._ultraAttackEffect.playOnce();\r\n                    setTimeout(() => {\r\n                        if (this && this.colliders) {\r\n                            for (var i = 0; i < this.colliders.length; i++) {\r\n                                var collider = this.colliders[i];\r\n                                if (collider) collider.notColliderFlag = false;\r\n                            }\r\n                        }\r\n                    }, 2300)\r\n\r\n                    setTimeout(() => {\r\n                        if (this && this.colliders) {\r\n                            for (var i = 0; i < this.colliders.length; i++) {\r\n                                var collider = this.colliders[i];\r\n                                if (collider) collider.notColliderFlag = true;\r\n                            }\r\n                        }\r\n                    }, 2500)\r\n\r\n                    this.lightKeepTime = 0;\r\n                }\r\n                break;\r\n            }\r\n            case SuitType.BATMAN: {\r\n                if (!this.player.isStartGame) return;\r\n                this.lightKeepTime += dt;\r\n\r\n                var time = 10;\r\n                if (this.lightKeepTime > (time + 2.8) && this.lightKeepTime <= (time + 5)) {\r\n                    if (!this.isBefore) {\r\n                        this.isBefore = true;\r\n                        this.player.myGuide.active = true;\r\n                        this.player.myGuideComp.playBeforeAnim();\r\n                    }\r\n                    this.player.myGuide.position = this.node.position;\r\n                    this.player.myGuide.scale = this.node.scale;\r\n                }\r\n\r\n                if (this.lightKeepTime > (time + 5)) {\r\n                    if (!this.player.myGuide.canClose) {\r\n                        this.player.myGuide.canClose = true;\r\n                        this.player.changeColliderState(false);\r\n                        this.player.changePosArrTarget(this.player.myGuideComp);\r\n                        this.node.emit('onStopMove', true);\r\n                        this.player.changeOpacity(100);\r\n                        if (this.player.moveByTouch) {\r\n                            this.player.moveByTouch.touchEndEvent();\r\n                            if (this.player.moveByTouch) this.player.moveByTouch.init(this.player.myGuideComp);\r\n                        } else {\r\n                            var action = this.node.getComponent('ActionMove');\r\n                            if (action) action.setTarget(this.player.myGuide)\r\n                        }\r\n\r\n                        // this.player.myGuide.scale = 1;\r\n                        this.player.myGuide.emit('onStopMove', false)\r\n                        if (this.player.myCamera) this.player.myCamera.targetNode = this.player.myGuide;\r\n                        this.player.myGuideComp.playStartAnim();\r\n                        this.player.myGuideComp.setShadow(true);\r\n                    }\r\n                }\r\n\r\n                if (this.lightKeepTime > (time + 10)) {\r\n                    this.lightKeepTime = 0;\r\n                    this.isBefore = false;\r\n                    if (this.player.myGuide.canClose) {\r\n                        this.player.myGuide.canClose = false;\r\n                        this.player.myGuide.scale = this.player.node.scale;\r\n                        this.player.myGuideComp.startAnim.node.active = false;\r\n                        this.player.myGuideComp.setShadow(false);\r\n                        var a0 = cc.moveTo(0.5, this.player.myGuide.position).easing(cc.easeBackOut(3.0));\r\n                        this.node.runAction(a0);\r\n                        setTimeout(() => {\r\n                            if (this && this.player && this.player.entityWorld) this.player.entityWorld.setTimeScale(0.2)\r\n                        }, 300)\r\n\r\n                        setTimeout(() => {\r\n                            if (this && this.player) this.player.myGuideComp.playEndAnim();\r\n                        }, 500)\r\n\r\n                        this.node.emit('onStopMove', true)\r\n                        this.player.changeOpacity(255);\r\n                        if (this.player.moveByTouch) {\r\n                            this.player.moveByTouch.touchEndEvent();\r\n                            this.player.moveByTouch.init(this);\r\n                        } else {\r\n                            var action = this.node.getComponent('ActionMove');\r\n                            if (action) action.setTarget(this.node)\r\n                        }\r\n\r\n                        setTimeout(() => {\r\n                            if (this && this.player) {\r\n                                if (this.player.entityWorld) this.player.entityWorld.setTimeScale(1)\r\n                            }\r\n                        }, 1000)\r\n\r\n                        setTimeout(() => {\r\n                            if (this && this.player) {\r\n                                this.player.changeColliderState(true);\r\n                                this.player.changePosArrTarget(this.player);\r\n                                this.node.emit('onStopMove', false);\r\n                                if (this.player.myCamera) this.player.myCamera.targetNode = this.node;\r\n                            }\r\n                        }, 1500);\r\n                    }\r\n                }\r\n                break\r\n            }\r\n            case SuitType.YELLOWMAN: {\r\n                if (!this.player.isStartGame) return;\r\n                this.lightKeepTime += dt;\r\n                if (this.player.getKnifeNum() <= 2) return;\r\n                if (this.lightKeepTime > 10) {\r\n                    for (let i = 0, l = knifes.length, knife; i < l; i++) {\r\n                        knife = knifes[i];\r\n                        if (knife.teamID === this.player.teamID) {\r\n                            knife.node.emit('throwKnife');\r\n                            knife.node.active = false;\r\n                            this.lightKeepTime = 0;\r\n                            this.player._yellowManEffect.open();\r\n                            setTimeout(() => {\r\n                                if (this && this.player) {\r\n                                    this.player.addBuff(5);\r\n                                    this.player.addBuff(6);\r\n                                    this.player.openShadow()\r\n                                }\r\n                            }, 1000);\r\n                            setTimeout(() => {\r\n                                if (this && this.player) {\r\n                                    this.player.closeShadow()\r\n                                    this.player._yellowManEffect.closeNode()\r\n                                }\r\n                            }, 6000);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                break\r\n            }\r\n            default: {\r\n                // this.player._pikaKeepEffect.stop();\r\n                break;\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n\r\n    die() {\r\n        this.player._pikaKeepEffect.stop();\r\n        this.player._ultraAttackEffect.stop();\r\n        this.player._yellowManEffect.closeNode()\r\n    },\r\n\r\n    drawLighting(dir) {\r\n        var ctx = this.player.ctx;\r\n        var step = 8;\r\n        var index = 0;\r\n        ctx.moveTo(0, 0);\r\n        while (index < step) {\r\n            index++;\r\n            var per = index / step;\r\n            var vec = cc.v2(per * dir.x, per * dir.y)\r\n            // var rota = index % 2 ? 1 : -1;\r\n            // var ro = vec.rotate(rota * Math.PI / 2).mul(0.5 - Math.abs(per - 0.5));\r\n            // vec = vec.add(ro);\r\n\r\n            vec.x = vec.x + (Math.random() - 0.5) * dir.x;\r\n\r\n            // vec.y += Math.floor(Math.random() * 5) * dir.y / 10;\r\n\r\n\r\n            ctx.lineTo(vec.x, vec.y);\r\n        }\r\n        ctx.lineTo(dir.x, dir.y);\r\n        ctx.stroke();\r\n    },\r\n\r\n    catchEnemyByBatMan() {\r\n        this.lightKeepTime = 999;\r\n    },\r\n\r\n});"]}