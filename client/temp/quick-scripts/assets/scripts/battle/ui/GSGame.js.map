{"version":3,"sources":["GSGame.js"],"names":["Tools","require","UIUtil","GameData","PlayerData","GSGame","cc","Class","extends","Component","properties","panelTop","Node","gameOverPanel","panelNotice","panelHeroPosArr","panelGuide","panelRevive","panelTips","panelTaskNotice","panelVictory","guideTime","countDownNode","panelKill","panelReviveTips","effectKey","Animation","init","world","instance","isGuide","active","node","parent","position","v2","checkPad","y","isPad","getComponent","Widget","top","isLongScreen","cleanUp","destroyAllChildren","startLoadPrefab","logUseTime","needLoadPanel","loadedPanel","self","callF","index","children","length","setSiblingIndex","panelKeyCount","panelTreasureBox","loadUIPrefab","resource","panelFirstGuide","addPlayerRankItem","entityPlayer","openGameOverPanel","console","log","AdvertMgr","showBanner","showPanelTreasureBox","closeGameOverPanel","update","dt","localPlayer","isDefence","touchTime","addHeroPosArr","otherPlayer","camera","addSpecialNotice","type","anyPanelOpen","showImportantNotice","closePanelNotice","notice","isOpen","close","startCountDown","time","showKillMsg","hero","otherHero","showKillNotice","killNum","showReviveNotice","openRevivePanel","callback","reviveCount","scale","action","scaleTo","runAction","showTips","tips","showTaskNotice","data","moveBy","easing","easeBackOut","delay","delayTime","action2","easeBackIn","callFunc","sequence","showCountDownNode","onBigBuff","emit","onFastBuff","onHardBuff","onMagnetBuff","onFrenzyBuff","showGuideStart","state","showGuideEnd","showGuideSpecial","refreshGuideProcess","str","showPanelVictory","getChildByName","play","killNoticeNode","showPanelKeyCount","show","openPanelKeyCount","open"],"mappings":"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","file":"GSGame.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui","sourcesContent":["/**\n * @fileoverview GSGame\n * @author meifan@gameley.cn (梅凡)\n */\n\nconst Tools = require('Tools');\nconst UIUtil = require('UIUtil');\nconst GameData = require('GameData');\nconst PlayerData = require('PlayerData');\nconst GSGame = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        panelTop: cc.Node,\n        gameOverPanel: cc.Node,\n        panelNotice: cc.Node,\n        panelHeroPosArr: cc.Node,\n        panelGuide: cc.Node,\n        panelRevive: cc.Node,\n        panelTips: cc.Node,\n        panelTaskNotice: cc.Node,\n        panelVictory: cc.Node,\n        guideTime: 0,\n        countDownNode: cc.Node,\n        panelKill: cc.Node,\n        panelReviveTips: cc.Node,\n        effectKey: cc.Animation,\n    },\n\n\n    init(world) {\n        this.world = world;\n        if (PlayerData.instance.isGuide) {\n            this.panelTop.active = false;\n        }\n\n        this.effectKey.node.parent.position = cc.v2(0, 200);\n        this.checkPad();\n    },\n\n    checkPad() {\n        this.panelKill.y = GameData.instance.isPad() ? 380 : 588;\n        this.panelReviveTips.y = GameData.instance.isPad() ? 350 : 380;\n        this.panelTop.getComponent(cc.Widget).top = GameData.instance.isLongScreen() ? 100 : 0;\n    },\n\n    cleanUp: function () {\n        this.panelTop.getComponent('PanelTop').cleanUp();\n        this.panelHeroPosArr.destroyAllChildren();\n        if (this.gameOverPanel) {\n            this.gameOverPanel.getComponent('PanelGameOver').cleanUp();\n        }\n        if (this.panelGuide) {\n            this.panelGuide.active = true;\n        }\n        this.guideTime = 0;\n        if (this.panelVictory) {\n            this.panelVictory.active = false;\n        }\n        this.panelKill.active = true;\n        if (this.panelNotice) {\n            this.panelNotice.active = true;\n        }\n    },\n\n    startLoadPrefab: function () {\n        GameData.instance.logUseTime('start prefab load');\n\n        this.needLoadPanel = 0;\n        this.loadedPanel = 0;\n\n        const self = this;\n        var callF = function () {\n            self.loadedPanel++;\n\n            if (self.needLoadPanel === self.loadedPanel) {\n\n                const index = self.node.children.length;\n                self.panelTips.setSiblingIndex(index);\n                if (self.panelNotice) {\n                    self.panelNotice.setSiblingIndex(1);\n                }\n                if (self.panelKeyCount) {\n                    self.panelKeyCount.parent = self.node;\n                }\n                if (self.panelTreasureBox) {\n                    self.panelTreasureBox.parent = self.node;\n                }\n\n            }\n        }\n\n\n        if (!this.panelNotice) {\n            UIUtil.loadUIPrefab('prefab/ui/gsgame/PanelNotice', (resource) => {\n                if (resource) {\n                    this.panelNotice = resource;\n                    this.panelNotice.parent = this.node;\n                    if (PlayerData.instance.isGuide) {\n                        this.panelNotice.active = false;\n                    }\n\n                    GameData.instance.logUseTime('panelNotice prefab loaded');\n                    callF();\n                }\n            });\n            this.needLoadPanel++;\n        }\n\n        this.panelTop.getComponent('PanelTop').startLoadPrefab();\n\n        if (!this.panelRevive) {\n            UIUtil.loadUIPrefab('prefab/ui/gsgame/PanelRevive', (resource) => {\n                if (resource) {\n                    this.panelRevive = resource;\n                    this.panelRevive.parent = this.node;\n                    GameData.instance.logUseTime('panelRevive prefab loaded');\n                    callF();\n                }\n            });\n            this.needLoadPanel++;\n        }\n\n        if (!this.gameOverPanel) {\n            UIUtil.loadUIPrefab('prefab/ui/gsgame/PanelGameOver', (resource) => {\n                if (resource) {\n                    this.gameOverPanel = resource;\n                    this.gameOverPanel.parent = this.node;\n                    GameData.instance.logUseTime('gameOverPanel prefab loaded');\n                    callF();\n                }\n            });\n            this.needLoadPanel++;\n        }\n\n        if (!this.panelGuide) {\n            UIUtil.loadUIPrefab('prefab/ui/gsgame/panelGuide', (resource) => {\n                if (resource) {\n                    this.panelGuide = resource;\n                    this.panelGuide.parent = this.node;\n                    this.panelGuide.y = GameData.instance.isPad() ? -213 : -313;\n                    GameData.instance.logUseTime('panelGuide prefab loaded');\n                    callF();\n                }\n            });\n            this.needLoadPanel++;\n        }\n\n        if (!this.panelFirstGuide && PlayerData.instance.isGuide) {\n            UIUtil.loadUIPrefab('prefab/ui/gsgame/PanelFirstGuide', (resource) => {\n                if (resource) {\n                    this.panelFirstGuide = resource;\n                    this.panelFirstGuide.parent = this.node;\n                    GameData.instance.logUseTime('panelFirstGuide prefab loaded');\n                    callF();\n                }\n            });\n            this.needLoadPanel++;\n        }\n\n        if (!this.panelVictory) {\n            UIUtil.loadUIPrefab('prefab/ui/gsgame/PanelVictory', (resource) => {\n                if (resource) {\n                    this.panelVictory = resource;\n                    this.panelVictory.parent = this.node;\n                    GameData.instance.logUseTime('panelVictory prefab loaded');\n                    callF();\n                }\n            });\n            this.needLoadPanel++;\n        }\n\n        if (!this.panelTreasureBox) {\n            UIUtil.loadUIPrefab('prefab/ui/gsgame/PanelTreasureBox', (resource) => {\n                if (resource) {\n                    this.panelTreasureBox = resource;\n                    // this.panelTreasureBox.parent = this.node;\n                    GameData.instance.logUseTime('PanelTreasureBox prefab loaded');\n                    callF();\n                }\n            });\n            this.needLoadPanel++;\n        }\n\n\n        if (!this.panelKeyCount) {\n            UIUtil.loadUIPrefab('prefab/ui/gsgame/KeyCount', (resource) => {\n                if (resource) {\n                    this.panelKeyCount = resource;\n                    GameData.instance.logUseTime('panelKeyCount prefab loaded');\n                    callF();\n                }\n            });\n            this.needLoadPanel++;\n        }\n    },\n\n    /**\n     * 创建玩家rankItem\n     */\n    addPlayerRankItem: function (entityPlayer) {\n        this.panelTop.getComponent('PanelTop').addPlayerRankItem(entityPlayer);\n    },\n\n    openGameOverPanel: function () {\n        if (this.gameOverPanel) {\n            this.gameOverPanel.active = true;\n            this.gameOverPanel.getComponent('PanelGameOver').init(this.world);\n            console.log(\"showBanner openGameOverPanel\")\n            AdvertMgr.instance.showBanner();\n        }\n\n\n    },\n\n    showPanelTreasureBox: function () {\n        if (this.panelTreasureBox) {\n            this.panelTreasureBox.active = true;\n            this.panelTreasureBox.getComponent('PanelTreasureBox').init(this.world);\n        }\n    },\n\n\n\n    closeGameOverPanel: function () {\n        if (this.gameOverPanel) {\n            this.gameOverPanel.active = false;\n        }\n    },\n\n    update: function (dt) {\n        if (!this.panelGuide) return;\n        if (!this.panelGuide.active) return;\n        this.guideTime += dt;\n        if (this.world.localPlayer.isDefence) {\n            this.touchTime = this.guideTime;\n        }\n        if (this.guideTime > this.touchTime + 1) {\n            this.panelGuide.active = false;\n        }\n        if (this.guideTime > 3) {\n            this.panelGuide.active = false;\n        }\n    },\n\n    addHeroPosArr: function (localPlayer, otherPlayer, camera) {\n        this.panelHeroPosArr.getComponent('PanelHeroPosArr').addHeroPosArr(localPlayer, otherPlayer, camera);\n    },\n\n    addSpecialNotice: function (type) {\n        if (!this.panelTop.getComponent('PanelTop').anyPanelOpen()) {\n            if (this.panelNotice) {\n                this.panelNotice.getComponent('PanelNotice').addSpecialNotice(type);\n            }\n        }\n    },\n\n    showImportantNotice: function (type) {\n        if (!this.panelTop.getComponent('PanelTop').anyPanelOpen()) {\n            if (this.panelNotice) {\n                this.panelNotice.getComponent('PanelNotice').showImportantNotice(type);\n            }\n        }\n    },\n\n    closePanelNotice: function () {\n        if (this.panelNotice) {\n            var notice = this.panelNotice.getComponent('PanelNotice');\n            if (notice.isOpen) {\n                notice.close();\n            }\n        }\n    },\n\n\n\n    startCountDown: function (time) {\n        this.panelTop.getComponent('PanelTop').startCountDown(time);\n    },\n\n    showKillMsg: function (hero, otherHero) {\n        this.closePanelNotice();\n        this.panelTop.getComponent('PanelTop').showKillMsg(hero, otherHero);\n    },\n\n    showKillNotice: function (killNum) {\n        this.panelTop.getComponent('PanelTop').showKillNotice(killNum);\n    },\n\n    showReviveNotice: function (hero) {\n        this.closePanelNotice();\n        this.panelTop.getComponent('PanelTop').showReviveNotice(hero);\n    },\n\n    // setFrenzyComp : function (player) {\n    //     this.panelTop.getComponent('PanelTop').setFrenzyComp(player);\n    // },\n\n    openRevivePanel: function (callback, reviveCount) {\n        if (this.panelRevive) {\n            this.panelRevive.active = true;\n            this.panelRevive.getComponent('PanelRevive').init(callback, reviveCount, this);\n            this.panelRevive.children[0].scale = 0;\n            var action = cc.scaleTo(0.2, 1)\n            this.panelRevive.children[0].runAction(action);\n        }\n    },\n\n    showTips: function (tips) {\n        this.panelTips.getComponent('PanelTips').init(tips);\n    },\n\n    showTaskNotice: function (data, callback) {\n        var action = cc.moveBy(0.3, cc.v2(-200, 0)).easing(cc.easeBackOut());\n        var delay = cc.delayTime(2);\n        var action2 = cc.moveBy(0.3, cc.v2(200, 0)).easing(cc.easeBackIn());;\n        var callF = cc.callFunc(() => {\n            callback();\n        })\n        this.panelTaskNotice.active = true;\n        this.panelTaskNotice.runAction(cc.sequence(action, delay, action2, callF));\n        this.panelTaskNotice.getComponent('PanelTaskNotice').init(data, callback);\n    },\n\n    showCountDownNode: function () {\n        if (this.panelNotice) {\n            this.panelNotice.active = false;\n        }\n        this.countDownNode.active = true;\n    },\n\n    onBigBuff: function () {\n        this.world.localPlayer.node.emit('updateBuffState', 0);\n    },\n\n    onFastBuff: function () {\n        this.world.localPlayer.node.emit('updateBuffState', 1);\n    },\n\n    onHardBuff: function () {\n        this.world.localPlayer.node.emit('updateBuffState', 2);\n    },\n\n    onMagnetBuff: function () {\n        this.world.localPlayer.node.emit('updateBuffState', 3);\n    },\n\n    onFrenzyBuff: function () {\n        this.world.localPlayer.node.emit('onFrenzyAdd', 3);\n    },\n\n    showGuideStart: function (state) {\n        if (this.panelFirstGuide) {\n            this.panelFirstGuide.getComponent('PanelFirstGuide').showGuideStart(state);\n        }\n    },\n\n\n    showGuideEnd: function (state) {\n        if (this.panelFirstGuide) {\n            this.panelFirstGuide.getComponent('PanelFirstGuide').showGuideEnd(state);\n        }\n    },\n\n    showGuideSpecial: function (state) {\n        if (this.panelFirstGuide) {\n            this.panelFirstGuide.getComponent('PanelFirstGuide').showGuideSpecial(state);\n        }\n    },\n\n    refreshGuideProcess: function (str) {\n        if (this.panelFirstGuide) {\n            this.panelFirstGuide.getComponent('PanelFirstGuide').refreshGuideProcess(str);\n        }\n    },\n\n    showPanelVictory: function () {\n        if (this.panelVictory) {\n            this.panelVictory.active = true;\n            this.panelVictory.getChildByName('victory').getChildByName('victory').getComponent(cc.Animation).play('ani-victory', 0);\n        }\n        this.panelKill.active = false;\n        if (this.panelNotice) {\n            this.panelNotice.active = false;\n        }\n        this.panelTop.getComponent('PanelTop').killNoticeNode.active = false;\n        // setTimeout(() => {\n        //     if(this.panelVictory) {\n        //         this.panelVictory.active = false;\n        //     }\n        // }, 1500)\n    },\n\n    showPanelKeyCount(node) {\n        if (this.panelKeyCount) {\n            this.panelKeyCount.getComponent('KeyCount').show(this.effectKey.node.parent);\n            this.effectKey.play();\n        }\n    },\n\n    openPanelKeyCount(active) {\n        if (this.panelKeyCount) {\n            this.panelKeyCount.getComponent('KeyCount').open(active);\n        }\n    },\n});"]}