{"version":3,"sources":["ItemDailyTask.js"],"names":["ListItemBase","require","PlayerData","ItemType","UIUtil","CONPLETE_COLOR","cc","Color","fromHEX","NOT_CONPLETE_COLOR","Class","extends","properties","nameLabel","Label","introduceLabel","tipsNode","Node","taskStartLabel","taskProgressLabel","taskFinalLabel","newNode","rewardIcon","Sprite","rewardLabel","isCompleteNode","jumpBtn","getBtn","hasGetNode","zongZiIcon","coinIcon","skinIcon","refreshAnim","Animation","isProcessNode","processBar","adverIcon","shareIcon","refresh","data","item","isGet","isTrggle","hasAdver","string","name","tips","process","lastProcess","str","param","isComplete","active","width","finalWidth","needUpdate","instance","saveUserData","labelOutlines","getComponentsInChildren","LabelOutline","line","color","newbie","degree","num","mult","finalReceiveMult","type","MONEY","ZONG_ZI","node","loadResSprite","itemData","url","setJumpCallback","callback","jumpCallback","onJump","playRefreshAnim","play","setIcon","closeIcon","update","dt","needShowAnim"],"mappings":";;;;;;AAAA,IAAMA,eAAeC,QAAQ,cAAR,CAArB;AACA,IAAMC,aAAaD,QAAQ,YAAR,CAAnB;AACA,IAAME,WAAWF,QAAQ,OAAR,EAAiBE,QAAlC;AACA,IAAMC,SAASH,QAAQ,QAAR,CAAf;AACA,IAAMI,iBAAiB,IAAIC,GAAGC,KAAP,GAAeC,OAAf,CAAuB,SAAvB,CAAvB;AACA,IAAMC,qBAAqB,IAAIH,GAAGC,KAAP,GAAeC,OAAf,CAAuB,SAAvB,CAA3B;AACAF,GAAGI,KAAH,CAAS;AACLC,aAASX,YADJ;;AAGLY,gBAAY;AACRC,mBAAWP,GAAGQ,KADN;AAERC,wBAAgBT,GAAGQ,KAFX;;AAIRE,kBAAUV,GAAGW,IAJL;AAKRC,wBAAgBZ,GAAGQ,KALX;AAMRK,2BAAmBb,GAAGQ,KANd;AAORM,wBAAgBd,GAAGQ,KAPX;;AASRO,iBAASf,GAAGW,IATJ;AAURK,oBAAYhB,GAAGiB,MAVP;AAWRC,qBAAalB,GAAGQ,KAXR;;AAaRW,wBAAgBnB,GAAGW,IAbX;AAcRS,iBAASpB,GAAGW,IAdJ;AAeRU,gBAAQrB,GAAGW,IAfH;AAgBRW,oBAAYtB,GAAGW,IAhBP;;AAkBRY,oBAAYvB,GAAGW,IAlBP;AAmBRa,kBAAUxB,GAAGW,IAnBL;AAoBRc,kBAAUzB,GAAGiB,MApBL;;AAsBRS,qBAAa1B,GAAG2B,SAtBR;;AAwBRC,uBAAe5B,GAAGW,IAxBV;AAyBRkB,oBAAY7B,GAAGW,IAzBP;;AA2BRmB,mBAAW9B,GAAGW,IA3BN;AA4BRoB,mBAAW/B,GAAGW;AA5BN,KAHP;;AAoCLqB,WApCK,mBAoCGC,IApCH,EAoCSC,IApCT,EAoCeC,KApCf,EAoCsBC,QApCtB,EAoCgCC,QApChC,EAoC0C;;AAE3C,aAAKJ,IAAL,GAAYA,IAAZ;AACA,aAAKC,IAAL,GAAYA,IAAZ;AACA,aAAKC,KAAL,GAAaA,KAAb;AACA,aAAKC,QAAL,GAAgBA,QAAhB;AACA,aAAKC,QAAL,GAAgBA,QAAhB;;AAEA,aAAK9B,SAAL,CAAe+B,MAAf,GAAwBL,KAAKM,IAA7B;AACA,aAAK9B,cAAL,CAAoB6B,MAApB,GAA6BL,KAAKO,IAAlC;;AAEA;AACA,YAAIC,UAAUR,KAAKS,WAAnB;AACA,YAAIC,MAAMF,UAAUR,KAAKW,KAAf,GAAuBH,OAAvB,GAAiCR,KAAKW,KAAhD;AACA;AACA,aAAK/B,iBAAL,CAAuByB,MAAvB,GAAgC,OAAOK,MAAMA,GAAN,GAAY,CAAnB,IAAwB,GAAxB,GAA8BV,KAAKW,KAAnC,GAA2C,GAA3E;AACA;;AAEA,YAAIC,aAAaJ,WAAWR,KAAKW,KAAjC;AACA,aAAKxB,OAAL,CAAa0B,MAAb,GAAsB,CAACD,UAAvB;AACA,aAAK1B,cAAL,CAAoB2B,MAApB,GAA6BD,UAA7B;AACA,aAAKjB,aAAL,CAAmBkB,MAAnB,GAA4B,CAACD,UAA7B;;AAEA;AACA;AACA,YAAIE,QAAQd,KAAKS,WAAL,GAAmBT,KAAKW,KAAxB,GAAgC,KAAKhB,aAAL,CAAmBmB,KAA/D;AACA,aAAKlB,UAAL,CAAgBkB,KAAhB,GAAwBA,QAAQ,KAAKnB,aAAL,CAAmBmB,KAA3B,GAAmC,KAAKnB,aAAL,CAAmBmB,KAAtD,GAA8DA,KAAtF;AACA,YAAId,KAAKS,WAAL,KAAqBT,KAAKQ,OAA9B,EAAuC;AACnC,iBAAKO,UAAL,GAAkBf,KAAKQ,OAAL,GAAeR,KAAKW,KAApB,GAA4B,KAAKhB,aAAL,CAAmBmB,KAAjE;AACA,iBAAKC,UAAL,GAAkB,KAAKA,UAAL,GAAkB,KAAKpB,aAAL,CAAmBmB,KAArC,GAA6C,KAAKnB,aAAL,CAAmBmB,KAAhE,GAAwE,KAAKC,UAA/F;AACA,iBAAKC,UAAL,GAAkB,IAAlB;AACAhB,iBAAKS,WAAL,GAAmBT,KAAKQ,OAAxB;AACA7C,uBAAWsD,QAAX,CAAoBC,YAApB,CAAiC,YAAjC;AACH;;AAGD,YAAIC,gBAAgB,KAAK1C,QAAL,CAAc2C,uBAAd,CAAsCrD,GAAGsD,YAAzC,CAApB;AApC2C;AAAA;AAAA;;AAAA;AAqC3C,iCAAiBF,aAAjB,8HAAgC;AAAA,oBAAvBG,IAAuB;;AAC5BA,qBAAKC,KAAL,GAAaX,aAAa9C,cAAb,GAA8BI,kBAA3C;AACH;AAvC0C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAyC3C,aAAKmB,UAAL,CAAgBwB,MAAhB,GAAyBD,cAAcV,KAAvC;AACA,aAAKd,MAAL,CAAYyB,MAAZ,GAAqBD,cAAc,CAACV,KAApC;AACA,YAAIsB,SAASxB,KAAKyB,MAAL,KAAgB,CAAC,CAA9B,CA3C2C,CA2CV;AACjC,YAAIC,MAAOvB,YAAY,CAACqB,MAAd,GAAwBvB,KAAKyB,GAAL,GAAW,CAAnC,GAAuCzB,KAAKyB,GAAtD;AACA,YAAIxB,KAAJ,EAAW;AACP,gBAAIyB,OAAO3B,KAAK4B,gBAAL,GAAwB5B,KAAK4B,gBAA7B,GAAgD,CAA3D;AACAF,kBAAMzB,KAAKyB,GAAL,GAAWC,IAAjB;AACH;;AAED,aAAK1C,WAAL,CAAiBoB,MAAjB,GAA0B,MAAMqB,GAAhC;;AAEA;;;AAGA,aAAKnC,QAAL,CAAcsB,MAAd,GAAuBZ,KAAK4B,IAAL,KAAcjE,SAASkE,KAA9C;AACA,aAAKxC,UAAL,CAAgBuB,MAAhB,GAAyBZ,KAAK4B,IAAL,KAAcjE,SAASmE,OAAhD,CAAwD,CAxDb,CAwDe;AAC1D,YAAI,KAAKxC,QAAL,CAAcsB,MAAd,IAAwB,KAAKvB,UAAL,CAAgBuB,MAA5C,EAAoD;AAChD,iBAAKrB,QAAL,CAAcwC,IAAd,CAAmBnB,MAAnB,GAA4B,KAA5B;AACA,iBAAK5B,WAAL,CAAiB+C,IAAjB,CAAsBnB,MAAtB,GAA+B,IAA/B;AACH,SAHD,MAGO;AACH,iBAAK5B,WAAL,CAAiB+C,IAAjB,CAAsBnB,MAAtB,GAA+B,KAA/B;AACA,iBAAKrB,QAAL,CAAcwC,IAAd,CAAmBnB,MAAnB,GAA4B,IAA5B;AACAhD,mBAAOoE,aAAP,CAAqB,KAAKzC,QAA1B,EAAoCS,KAAKiC,QAAL,CAAcC,GAAlD;AACH;;AAED,YAAIhC,YAAa,CAACqB,MAAlB,EAA2B;AACvB,iBAAK3B,SAAL,CAAegB,MAAf,GAAwBT,QAAxB;AACA,iBAAKN,SAAL,CAAee,MAAf,GAAwB,CAACT,QAAzB;AACH,SAHD,MAGO;AACH,iBAAKP,SAAL,CAAegB,MAAf,GAAwB,KAAxB;AACA,iBAAKf,SAAL,CAAee,MAAf,GAAwB,KAAxB;AACH;AAIJ,KAhHI;;;AAkHLuB,qBAAiB,yBAAUC,QAAV,EAAoB;AACjC,aAAKC,YAAL,GAAoBD,QAApB;AACH,KApHI;AAqHLE,YAAQ,kBAAY;AAChB,YAAI,KAAKD,YAAT,EAAuB,KAAKA,YAAL;AAC1B,KAvHI;;AAyHLE,qBAAiB,2BAAY;AACzB,aAAK/C,WAAL,CAAiBgD,IAAjB;AACH,KA3HI;;AA6HLC,aAAS,iBAAUtC,QAAV,EAAoB;AACzB,aAAKP,SAAL,CAAegB,MAAf,GAAwBT,QAAxB;AACA,aAAKN,SAAL,CAAee,MAAf,GAAwB,CAACT,QAAzB;AACH,KAhII;;AAkILuC,eAAW,qBAAY;AACnB,aAAK9C,SAAL,CAAegB,MAAf,GAAwB,KAAxB;AACA,aAAKf,SAAL,CAAee,MAAf,GAAwB,KAAxB;AACH,KArII;;AAuIL+B,UAvIK,kBAuIEC,EAvIF,EAuIM;AACP,YAAI,KAAK7B,UAAT,EAAqB;AACjB,gBAAI,KAAKpB,UAAL,CAAgBkB,KAAhB,GAAwB,KAAKC,UAAjC,EAA6C;AACzC,qBAAKnB,UAAL,CAAgBkB,KAAhB,IAAyB,MAAM+B,EAA/B;AACH,aAFD,MAEO;AACH,qBAAK7B,UAAL,GAAkB,KAAlB;AACA,qBAAKpB,UAAL,CAAgBkB,KAAhB,GAAwB,KAAKC,UAA7B;AACA,qBAAKhB,OAAL,CAAa,KAAKC,IAAlB,EAAwB,KAAKC,IAA7B,EAAmC,KAAKC,KAAxC,EAA+C,KAAKC,QAApD,EAA8D,KAAKC,QAAnE;AACA,oBAAI,KAAK0C,YAAT,EAAuB;AACnB,yBAAKN,eAAL;AACA,yBAAKM,YAAL,GAAoB,KAApB;AACH;AACJ;AACJ;AAGJ;AAvJI,CAAT","file":"ItemDailyTask.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui","sourcesContent":["const ListItemBase = require('ListItemBase')\r\nconst PlayerData = require('PlayerData');\r\nconst ItemType = require('Types').ItemType;\r\nconst UIUtil = require('UIUtil');\r\nconst CONPLETE_COLOR = new cc.Color().fromHEX('#b55b12')\r\nconst NOT_CONPLETE_COLOR = new cc.Color().fromHEX('#2c325b')\r\ncc.Class({\r\n    extends: ListItemBase,\r\n\r\n    properties: {\r\n        nameLabel: cc.Label,\r\n        introduceLabel: cc.Label,\r\n\r\n        tipsNode: cc.Node,\r\n        taskStartLabel: cc.Label,\r\n        taskProgressLabel: cc.Label,\r\n        taskFinalLabel: cc.Label,\r\n\r\n        newNode: cc.Node,\r\n        rewardIcon: cc.Sprite,\r\n        rewardLabel: cc.Label,\r\n\r\n        isCompleteNode: cc.Node,\r\n        jumpBtn: cc.Node,\r\n        getBtn: cc.Node,\r\n        hasGetNode: cc.Node,\r\n\r\n        zongZiIcon: cc.Node,\r\n        coinIcon: cc.Node,\r\n        skinIcon: cc.Sprite,\r\n\r\n        refreshAnim: cc.Animation,\r\n\r\n        isProcessNode: cc.Node,\r\n        processBar: cc.Node,\r\n\r\n        adverIcon: cc.Node,\r\n        shareIcon: cc.Node,\r\n    },\r\n\r\n\r\n\r\n    refresh(data, item, isGet, isTrggle, hasAdver) {\r\n\r\n        this.data = data;\r\n        this.item = item;\r\n        this.isGet = isGet;\r\n        this.isTrggle = isTrggle;\r\n        this.hasAdver = hasAdver;\r\n\r\n        this.nameLabel.string = data.name;\r\n        this.introduceLabel.string = data.tips;\r\n\r\n        // var process = PlayerData.instance.getDailyTaskProcess(data.type);\r\n        var process = data.lastProcess;\r\n        var str = process < data.param ? process : data.param;\r\n        // this.taskStartLabel.string = '(';\r\n        this.taskProgressLabel.string = '(' + (str ? str : 0) + '/' + data.param + ')';\r\n        // this.taskFinalLabel.string = '/' + data.param + ')';\r\n\r\n        var isComplete = process >= data.param;\r\n        this.jumpBtn.active = !isComplete;\r\n        this.isCompleteNode.active = isComplete;\r\n        this.isProcessNode.active = !isComplete;\r\n\r\n        // data.lastProcess = data.lastProcess < data.param ? data.lastProcess : data.param;\r\n        // data.process = data.process < data.param ? data.lastProcess : data.param;\r\n        var width = data.lastProcess / data.param * this.isProcessNode.width;\r\n        this.processBar.width = width > this.isProcessNode.width ? this.isProcessNode.width : width;\r\n        if (data.lastProcess !== data.process) {\r\n            this.finalWidth = data.process / data.param * this.isProcessNode.width;\r\n            this.finalWidth = this.finalWidth > this.isProcessNode.width ? this.isProcessNode.width : this.finalWidth;\r\n            this.needUpdate = true;\r\n            data.lastProcess = data.process;\r\n            PlayerData.instance.saveUserData('刷新每日任务上次进度');\r\n        }\r\n\r\n\r\n        var labelOutlines = this.tipsNode.getComponentsInChildren(cc.LabelOutline);\r\n        for (let line of labelOutlines) {\r\n            line.color = isComplete ? CONPLETE_COLOR : NOT_CONPLETE_COLOR;\r\n        }\r\n\r\n        this.hasGetNode.active = isComplete && isGet;\r\n        this.getBtn.active = isComplete && !isGet;\r\n        var newbie = data.degree === -1; //新手任务\r\n        var num = (isTrggle && !newbie) ? item.num * 3 : item.num;\r\n        if (isGet) {\r\n            var mult = data.finalReceiveMult ? data.finalReceiveMult : 1;\r\n            num = item.num * mult;\r\n        }\r\n\r\n        this.rewardLabel.string = 'x' + num;\r\n\r\n        // this.newNode.active = data.degree === -1; //新手任务\r\n\r\n\r\n        this.coinIcon.active = item.type === ItemType.MONEY;\r\n        this.zongZiIcon.active = item.type === ItemType.ZONG_ZI;; //3是粽子的类型\r\n        if (this.coinIcon.active || this.zongZiIcon.active) {\r\n            this.skinIcon.node.active = false;\r\n            this.rewardLabel.node.active = true;\r\n        } else {\r\n            this.rewardLabel.node.active = false;\r\n            this.skinIcon.node.active = true;\r\n            UIUtil.loadResSprite(this.skinIcon, item.itemData.url);\r\n        }\r\n\r\n        if (isTrggle && (!newbie)) {\r\n            this.adverIcon.active = hasAdver;\r\n            this.shareIcon.active = !hasAdver;\r\n        } else {\r\n            this.adverIcon.active = false;\r\n            this.shareIcon.active = false;\r\n        }\r\n\r\n\r\n\r\n    },\r\n\r\n    setJumpCallback: function (callback) {\r\n        this.jumpCallback = callback;\r\n    },\r\n    onJump: function () {\r\n        if (this.jumpCallback) this.jumpCallback();\r\n    },\r\n\r\n    playRefreshAnim: function () {\r\n        this.refreshAnim.play();\r\n    },\r\n\r\n    setIcon: function (hasAdver) {\r\n        this.adverIcon.active = hasAdver;\r\n        this.shareIcon.active = !hasAdver;\r\n    },\r\n\r\n    closeIcon: function () {\r\n        this.adverIcon.active = false;\r\n        this.shareIcon.active = false;\r\n    },\r\n\r\n    update(dt) {\r\n        if (this.needUpdate) {\r\n            if (this.processBar.width < this.finalWidth) {\r\n                this.processBar.width += 400 * dt;\r\n            } else {\r\n                this.needUpdate = false;\r\n                this.processBar.width = this.finalWidth;\r\n                this.refresh(this.data, this.item, this.isGet, this.isTrggle, this.hasAdver)\r\n                if (this.needShowAnim) {\r\n                    this.playRefreshAnim();\r\n                    this.needShowAnim = false;\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n    },\r\n});"]}