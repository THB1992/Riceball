{"version":3,"sources":["KillMsg.js"],"names":["TEAM_COLOR","require","UIUtil","PlayerData","KillMsg","cc","Class","extends","Component","properties","_time","killNode","Node","_killNameNode","killMyBall","killOtherBall","_killMyName","Label","_killOtherName","effectAnim","Animation","isOpen","init","killNameNode","killMyName","killOtherName","killIconNode","killMyIcon","killOtherIcon","_killIconNode","_killMyIcon","_killOtherIcon","langFlag","cleanUp","close","update","dt","showKillMsg","hero","otherHero","node","active","play","myTid","teamID","otherTid","color","string","name","spriteFrame","iconUrl","isLocal","instance","loadResPortrait"],"mappings":"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","file":"KillMsg.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui","sourcesContent":["/**\n * @fileoverview KillMsg\n * @author meifan@gameley.cn (梅凡)\n */\n\nconst TEAM_COLOR = require('Types').TEAM_COLOR;\nconst UIUtil = require('UIUtil');\nconst PlayerData = require('PlayerData');\n\nconst KillMsg = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        _time: -1,\n        killNode: cc.Node,\n        _killNameNode: cc.Node,\n        killMyBall: cc.Node,\n        killOtherBall: cc.Node,\n        _killMyName: cc.Label,\n        _killOtherName: cc.Label,\n        effectAnim: cc.Animation,\n        isOpen: false,\n    },\n\n    init: function (killNameNode, killMyName, killOtherName, killIconNode, killMyIcon, killOtherIcon) {\n        this._killNameNode = killNameNode;\n        this._killMyName = killMyName;\n        this._killOtherName = killOtherName;\n\n        this._killIconNode = killIconNode;\n        this._killMyIcon = killMyIcon;\n        this._killOtherIcon = killOtherIcon;\n        this.isOpen = false;\n\n        this._killMyName.langFlag = true;\n        this._killOtherName.langFlag = true;\n    },\n\n    cleanUp: function () {\n        this.close();\n    },\n\n    update: function (dt) {\n        if (this._time > 0) {\n            this._time -= dt;\n            if (this._time < 0) {\n                this.close();\n            }\n        }\n    },\n\n    showKillMsg: function (hero, otherHero) {\n        this.isOpen = true;\n        this.effectAnim.node.active = true;\n        this.effectAnim.play();\n        // this.effectAnim.on('stop', () => {\n        //     this.effectAnim.off('stop');\n        //     this.effectAnim.node.active = false;\n        // })\n        this.killNode.active = true;\n        this._killNameNode.active = true;\n        this._killIconNode.active = true;\n        this._time = 2.0;\n\n        const myTid = hero.teamID;\n        const otherTid = otherHero.teamID;\n\n        this.killMyBall.color = TEAM_COLOR[myTid];\n        this.killOtherBall.color = TEAM_COLOR[otherTid];\n\n        this._killMyName.string = hero.name;\n        this._killMyIcon.spriteFrame = null;\n        this._killMyIcon.iconUrl = hero.isLocal ? PlayerData.instance.iconUrl : hero.iconUrl;\n        UIUtil.loadResPortrait(this._killMyIcon, hero);\n        // this._killMyName.node.color = hero.isLocal ? TEAM_COLOR[myTid] : TEAM_COLOR[0];\n        this._killOtherName.string = otherHero.name;\n        this._killOtherIcon.spriteFrame = null;\n        this._killOtherIcon.iconUrl = otherHero.isLocal ? PlayerData.instance.iconUrl : otherHero.iconUrl;\n        UIUtil.loadResPortrait(this._killOtherIcon, otherHero);\n        // this._killOtherName.node.color = otherHero.isLocal ? TEAM_COLOR[otherTid] : TEAM_COLOR[0];\n    },\n\n    close: function () {\n        this.killNode.active = false;\n        this._killNameNode.active = false;\n        this._killIconNode.active = false;\n        this.isOpen = false;\n    }\n\n});"]}