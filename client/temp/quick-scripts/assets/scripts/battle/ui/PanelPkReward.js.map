{"version":3,"sources":["PanelPkReward.js"],"names":["ConfigData","require","BagItem","ItemType","PlayerData","GameData","cc","Class","extends","Component","properties","rankLabel","Label","tipsText","RichText","diamondLabel","goldLabel","init","rankData","callback","world","rank","round","joinTime","data","instance","getPKRewardByRank","isShowLog","console","log","hasReceivePKRound","close","string","items","createItemsWithString","reward","i","length","type","MONEY","goldNum","num","ZONG_ZI","diamondNum","receive","updateGold","showGold","param","count","isMore","isLucky","uiMgr","showGetMoneyEffect","updateZongZi","showTips","Tools","getStringByFormat","getUITipStr","updateReceiveRound","updateDayRefreshPKReward","node","active"],"mappings":"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","file":"PanelPkReward.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui","sourcesContent":["const ConfigData = require('ConfigData');\r\nconst BagItem = require('BagItem');\r\nconst ItemType = require('Types').ItemType;\r\nconst PlayerData = require('PlayerData');\r\nconst GameData = require('GameData');\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        rankLabel: cc.Label,\r\n        tipsText: cc.RichText,\r\n        diamondLabel: cc.Label,\r\n        goldLabel: cc.Label,\r\n    },\r\n\r\n    //第几轮和第几名\r\n    init(rankData, callback, world) {\r\n        this.callback = callback;\r\n        this.world = world;\r\n        this.rankData = rankData;\r\n        var rank = rankData.rank;\r\n        var round = rankData.round;\r\n        var joinTime = rankData.joinTime;\r\n        var data = ConfigData.instance.getPKRewardByRank(rank);\r\n        if (GameData.instance.isShowLog()) {\r\n            console.log('--------------------------刷新小组排名奖励：', joinTime, '轮次:', round, '名次:', rank)\r\n        }\r\n\r\n        if (rank === -1 || PlayerData.instance.hasReceivePKRound(joinTime) || !data) {\r\n            this.close(false);\r\n        } else {\r\n            this.rankLabel.string = '小组第' + rank + '名';\r\n            this.tipsText.string = '恭喜你取得小组PK（第' + round + '轮）</color=##EEE50E>第' + rank + '名';\r\n            this.items = BagItem.createItemsWithString(data.reward);\r\n            for (let i = 0; i < this.items.length; i++) {\r\n                switch (this.items[i].type) {\r\n                    case ItemType.MONEY:\r\n                        this.goldNum = this.items[i].num;\r\n                        this.goldLabel.string = 'x' + this.goldNum;\r\n                        break;\r\n                    case ItemType.ZONG_ZI:\r\n                        this.diamondNum = this.items[i].num;\r\n                        this.diamondLabel.string = 'x' + this.diamondNum;\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    close(receive = true) {\r\n        if (receive) {\r\n            if (this.goldNum) {\r\n                PlayerData.instance.updateGold(this.goldNum);\r\n                PlayerData.instance.showGold -= this.goldNum;\r\n                var param = {\r\n                    count: this.goldNum,\r\n                    isMore: true,\r\n                    isLucky: false,\r\n                }\r\n                this.world.uiMgr.showGetMoneyEffect(param);\r\n            }\r\n\r\n            if (this.diamondNum) {\r\n                PlayerData.instance.updateZongZi(this.diamondNum);\r\n                this.world.uiMgr.showTips(Tools.getStringByFormat(ConfigData.instance.getUITipStr(15), count))\r\n            }\r\n            PlayerData.instance.updateReceiveRound(this.rankData.joinTime, true);\r\n        }\r\n\r\n        PlayerData.instance.updateDayRefreshPKReward();\r\n        this.node.active = false;\r\n        if (this.callback) this.callback();\r\n    }\r\n});"]}