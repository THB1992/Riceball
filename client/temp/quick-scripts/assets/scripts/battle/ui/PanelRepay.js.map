{"version":3,"sources":["PanelRepay.js"],"names":["PlayerData","require","ConfigData","Tools","ShareMgr","ShareType","AdvertMgr","AdverType","cc","Class","extends","Component","properties","goldLabel","Label","init","callback","world","repayData","instance","getRepayDataByRank","rankData","id","goldCount","reward","string","onClose","node","active","onReceiveBtnClick","self","updateRepay","updateGold","showGold","param","count","isMore","isLucky","uiMgr","showGetMoneyEffect","closeFunc","success","errFunc","showShare","showAdver","GrowNode","share"],"mappings":";;;;;;AAAA,IAAMA,aAAaC,QAAQ,YAAR,CAAnB;AACA,IAAMC,aAAaD,QAAQ,YAAR,CAAnB;AACA,IAAME,QAAQF,QAAQ,OAAR,CAAd;AACA,IAAMG,WAAWH,QAAQ,UAAR,CAAjB;AACA,IAAMI,YAAYJ,QAAQ,OAAR,EAAiBI,SAAnC;AACA,IAAMC,YAAYL,QAAQ,WAAR,CAAlB;AACA,IAAMM,YAAYN,QAAQ,OAAR,EAAiBM,SAAnC;;AAKAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,mBAAWL,GAAGM;AADN,KAHP;;AAOLC,QAPK,gBAOAC,QAPA,EAOUC,KAPV,EAOiB;AAClB,aAAKD,QAAL,GAAgBA,QAAhB;AACA,aAAKC,KAAL,GAAaA,KAAb;AACA,YAAIC,YAAYhB,WAAWiB,QAAX,CAAoBC,kBAApB,CAAuCpB,WAAWmB,QAAX,CAAoBE,QAApB,CAA6BC,EAApE,CAAhB;AACA,aAAKC,SAAL,GAAkBL,aAAaA,UAAUM,MAAxB,GAAkCN,UAAUM,MAA5C,GAAqD,CAAtE;AACA,aAAKX,SAAL,CAAeY,MAAf,GAAwB,KAAKF,SAA7B;AACH,KAbI;AAeLG,WAfK,qBAeK;AACN,aAAKC,IAAL,CAAUC,MAAV,GAAmB,KAAnB;AACA,YAAI,KAAKZ,QAAT,EAAmB,KAAKA,QAAL;AACtB,KAlBI;AAoBLa,qBApBK,+BAoBe;AAChB,YAAIC,OAAO,IAAX;AACA9B,mBAAWmB,QAAX,CAAoBY,WAApB;AACA/B,mBAAWmB,QAAX,CAAoBa,UAApB,CAA+BF,KAAKP,SAApC;AACAvB,mBAAWmB,QAAX,CAAoBc,QAApB,IAAgCH,KAAKP,SAArC;AACA,YAAIW,QAAQ;AACRC,mBAAOL,KAAKP,SADJ;AAERa,oBAAQ,IAFA;AAGRC,qBAAS;AAHD,SAAZ;AAKAP,aAAKb,KAAL,CAAWqB,KAAX,CAAiBC,kBAAjB,CAAoCL,KAApC;AACAJ,aAAKJ,OAAL;;AAGA;AACA,YAAII,OAAO,IAAX;AACA;AACA,YAAIU,YAAY,SAAZA,SAAY,CAAUC,OAAV,EAAmB;AAC/B,gBAAIA,OAAJ,EAAa;AACTzC,2BAAWmB,QAAX,CAAoBa,UAApB,CAA+BF,KAAKP,SAApC;AACAvB,2BAAWmB,QAAX,CAAoBc,QAApB,IAAgCH,KAAKP,SAArC;AACA,oBAAIW,QAAQ;AACRC,2BAAOL,KAAKP,SADJ;AAERa,4BAAQ,IAFA;AAGRC,6BAAS;AAHD,iBAAZ;AAKAP,qBAAKb,KAAL,CAAWqB,KAAX,CAAiBC,kBAAjB,CAAoCL,KAApC;AACAJ,qBAAKJ,OAAL;AACH;AACJ,SAZD;AAaA;AACA,YAAIgB,UAAU,SAAVA,OAAU,GAAY;AACtBZ,iBAAKa,SAAL,CAAeH,SAAf;AACH,SAFD;AAGAlC,kBAAUa,QAAV,CAAmByB,SAAnB,CAA6BrC,UAAUsC,QAAvC,EAAiDL,SAAjD,EAA4DE,OAA5D;AACH,KAvDI;;;AAyDLC,eAAW,mBAAUH,SAAV,EAAqB;AAC5BpC,iBAAS0C,KAAT,CAAezC,UAAUwC,QAAzB,EAAmCL,SAAnC;AACH;AACD;AA5DK,CAAT","file":"PanelRepay.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\battle\\ui","sourcesContent":["const PlayerData = require('PlayerData');\r\nconst ConfigData = require('ConfigData');\r\nconst Tools = require('Tools');\r\nconst ShareMgr = require('ShareMgr');\r\nconst ShareType = require('Types').ShareType;\r\nconst AdvertMgr = require('AdvertMgr');\r\nconst AdverType = require('Types').AdverType;\r\n\r\n\r\n\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        goldLabel: cc.Label,\r\n    },\r\n\r\n    init(callback, world) {\r\n        this.callback = callback;\r\n        this.world = world;\r\n        var repayData = ConfigData.instance.getRepayDataByRank(PlayerData.instance.rankData.id);\r\n        this.goldCount = (repayData && repayData.reward) ? repayData.reward : 0;\r\n        this.goldLabel.string = this.goldCount;\r\n    },\r\n\r\n    onClose() {\r\n        this.node.active = false;\r\n        if (this.callback) this.callback();\r\n    },\r\n\r\n    onReceiveBtnClick() {\r\n        var self = this;\r\n        PlayerData.instance.updateRepay();\r\n        PlayerData.instance.updateGold(self.goldCount);\r\n        PlayerData.instance.showGold -= self.goldCount;\r\n        var param = {\r\n            count: self.goldCount,\r\n            isMore: true,\r\n            isLucky: false,\r\n        }\r\n        self.world.uiMgr.showGetMoneyEffect(param);\r\n        self.onClose();\r\n\r\n\r\n        return;\r\n        var self = this;\r\n        // 关闭广告时回调\r\n        var closeFunc = function (success) {\r\n            if (success) {\r\n                PlayerData.instance.updateGold(self.goldCount);\r\n                PlayerData.instance.showGold -= self.goldCount;\r\n                var param = {\r\n                    count: self.goldCount,\r\n                    isMore: true,\r\n                    isLucky: false,\r\n                }\r\n                self.world.uiMgr.showGetMoneyEffect(param);\r\n                self.onClose();\r\n            }\r\n        }\r\n        // 打开广告失败时回调,失败回调\r\n        var errFunc = function () {\r\n            self.showShare(closeFunc);\r\n        }\r\n        AdvertMgr.instance.showAdver(AdverType.GrowNode, closeFunc, errFunc);\r\n    },\r\n\r\n    showShare: function (closeFunc) {\r\n        ShareMgr.share(ShareType.GrowNode, closeFunc)\r\n    },\r\n    // update (dt) {},\r\n});"]}