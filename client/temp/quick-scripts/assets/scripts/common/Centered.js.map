{"version":3,"sources":["Centered.js"],"names":["NodeEvent","cc","Node","EventType","Class","extends","Component","editor","CC_EDITOR","menu","executeInEditMode","properties","interval","widthMax","onEnable","_addEventListeners","_doLayoutDirty","onDisable","_removeEventListeners","_layoutDirty","director","on","Director","EVENT_AFTER_UPDATE","updateLayout","node","SIZE_CHANGED","ANCHOR_CHANGED","CHILD_ADDED","_childAdded","CHILD_REMOVED","_childRemoved","CHILD_REORDER","_addChildrenEventListeners","off","_removeChildrenEventListeners","children","i","length","child","SCALE_CHANGED","POSITION_CHANGED","dt","active","width","posX","x"],"mappings":"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","file":"Centered.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\common","sourcesContent":["//让子节点以父节点为中心居中\r\nconst NodeEvent = cc.Node.EventType;\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    editor: CC_EDITOR && {\r\n        menu: 'i18n:MAIN_MENU.component.ui/Centered',\r\n        executeInEditMode: true,\r\n    },\r\n\r\n    properties: {\r\n        interval: 5,\r\n        widthMax: 0,\r\n    },\r\n\r\n\r\n    onEnable: function () {\r\n        this._addEventListeners();\r\n        this._doLayoutDirty();\r\n    },\r\n\r\n    onDisable: function () {\r\n        this._removeEventListeners();\r\n    },\r\n\r\n    _doLayoutDirty: function () {\r\n        this._layoutDirty = true;\r\n    },\r\n\r\n\r\n    _addEventListeners: function () {\r\n        cc.director.on(cc.Director.EVENT_AFTER_UPDATE, this.updateLayout, this);\r\n        this.node.on(NodeEvent.SIZE_CHANGED, this._doLayoutDirty, this);\r\n        this.node.on(NodeEvent.ANCHOR_CHANGED, this._doLayoutDirty, this);\r\n        this.node.on(NodeEvent.CHILD_ADDED, this._childAdded, this);\r\n        this.node.on(NodeEvent.CHILD_REMOVED, this._childRemoved, this);\r\n        this.node.on(NodeEvent.CHILD_REORDER, this._doLayoutDirty, this);\r\n        this._addChildrenEventListeners();\r\n    },\r\n\r\n    _removeEventListeners: function () {\r\n        cc.director.off(cc.Director.EVENT_AFTER_UPDATE, this.updateLayout, this);\r\n        this.node.off(NodeEvent.SIZE_CHANGED, this._doLayoutDirty, this);\r\n        this.node.off(NodeEvent.ANCHOR_CHANGED, this._doLayoutDirty, this);\r\n        this.node.off(NodeEvent.CHILD_ADDED, this._childAdded, this);\r\n        this.node.off(NodeEvent.CHILD_REMOVED, this._childRemoved, this);\r\n        this.node.off(NodeEvent.CHILD_REORDER, this._doLayoutDirty, this);\r\n        this._removeChildrenEventListeners();\r\n    },\r\n\r\n    _addChildrenEventListeners: function () {\r\n        var children = this.node.children;\r\n        for (var i = 0; i < children.length; ++i) {\r\n            var child = children[i];\r\n            child.on(NodeEvent.SCALE_CHANGED, this._doLayoutDirty, this);\r\n            child.on(NodeEvent.SIZE_CHANGED, this._doLayoutDirty, this);\r\n            child.on(NodeEvent.POSITION_CHANGED, this._doLayoutDirty, this);\r\n            child.on(NodeEvent.ANCHOR_CHANGED, this._doLayoutDirty, this);\r\n            child.on('active-in-hierarchy-changed', this._doLayoutDirty, this);\r\n        }\r\n    },\r\n\r\n    _removeChildrenEventListeners: function () {\r\n        var children = this.node.children;\r\n        for (var i = 0; i < children.length; ++i) {\r\n            var child = children[i];\r\n            child.off(NodeEvent.SCALE_CHANGED, this._doLayoutDirty, this);\r\n            child.off(NodeEvent.SIZE_CHANGED, this._doLayoutDirty, this);\r\n            child.off(NodeEvent.POSITION_CHANGED, this._doLayoutDirty, this);\r\n            child.off(NodeEvent.ANCHOR_CHANGED, this._doLayoutDirty, this);\r\n            child.off('active-in-hierarchy-changed', this._doLayoutDirty, this);\r\n        }\r\n    },\r\n\r\n    _childAdded: function (child) {\r\n        child.on(NodeEvent.SCALE_CHANGED, this._doLayoutDirty, this);\r\n        child.on(NodeEvent.SIZE_CHANGED, this._doLayoutDirty, this);\r\n        child.on(NodeEvent.POSITION_CHANGED, this._doLayoutDirty, this);\r\n        child.on(NodeEvent.ANCHOR_CHANGED, this._doLayoutDirty, this);\r\n        child.on('active-in-hierarchy-changed', this._doLayoutDirty, this);\r\n\r\n        this._doLayoutDirty();\r\n    },\r\n\r\n    _childRemoved: function (child) {\r\n        child.off(NodeEvent.SCALE_CHANGED, this._doLayoutDirty, this);\r\n        child.off(NodeEvent.SIZE_CHANGED, this._doLayoutDirty, this);\r\n        child.off(NodeEvent.POSITION_CHANGED, this._doLayoutDirty, this);\r\n        child.off(NodeEvent.ANCHOR_CHANGED, this._doLayoutDirty, this);\r\n        child.off('active-in-hierarchy-changed', this._doLayoutDirty, this);\r\n\r\n        this._doLayoutDirty();\r\n    },\r\n\r\n\r\n    updateLayout(dt) {\r\n        if (!this._layoutDirty) return\r\n        this._layoutDirty = false;\r\n\r\n        this.widthMax = 0;\r\n        for (const node of this.node.children) {\r\n            if (node.active) {\r\n                this.widthMax += node.width + this.interval;\r\n            }\r\n        }\r\n        this.widthMax -= this.interval;\r\n\r\n        var posX = -this.widthMax / 2;\r\n        for (const node of this.node.children) {\r\n            if (node.active) {\r\n                node.x = posX + node.width / 2;\r\n                posX += node.width + this.interval;\r\n            }\r\n        }\r\n    },\r\n});"]}