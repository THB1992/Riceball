{"version":3,"sources":["Quee.js"],"names":["Quee","itemVals","slotItems","isScroll","seTimes","isReSort","unlockScroll","updateList","id","length","curItem","i","sz","j","getComponent","updateItem","WeiShuSdk","require","cc","Class","extends","Component","properties","item_template","type","Prefab","default","scroll_view","ScrollView","dir","onLoad","processCfg","scrolls","scrolling","curPos","getScrollOffset","maxScrollOffset","getMaxScrollOffset","stillTime","x","swTimes","Math","abs","scrollToRight","scrollToLeft","update","dt","curX","self","url","baseUrl","loader","load","err","res","data","content","item","instantiate","addChild","push","module","exports"],"mappings":"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","file":"Quee.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\sdk","sourcesContent":["var Quee = {\r\n    itemVals:[],\r\n    slotItems:[],\r\n    isScroll:false, //是否滚动\r\n    seTimes: 20,\r\n    isReSort: false, //是否重排列表\r\n    unlockScroll: false,\r\n    updateList(id) { //重排列表\r\n        if(Quee.isReSort){\r\n            if(id ==Quee.itemVals.length - 1) return;\r\n            let curItem = Quee.itemVals[id];\r\n            let i=id+1,sz=Quee.itemVals.length;\r\n            for(;i<sz;i++){\r\n                Quee.itemVals[i-1] = Quee.itemVals[i];\r\n            }\r\n            Quee.itemVals[sz-1] = curItem;\r\n            for(var j=0;j<Quee.slotItems.length;j++) {\r\n                Quee.slotItems[j].getComponent('Item').updateItem(j);\r\n            }\r\n        }\r\n        Quee.unlockScroll = true;\r\n    },\r\n}\r\nvar WeiShuSdk = require(\"WeiShuSdk\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        item_template:{ //项的资源预制体 \r\n            type:cc.Prefab, \r\n            default:null, \r\n        }, \r\n        scroll_view:{ //获取scrollview组件 \r\n            type:cc.ScrollView, \r\n            default:null, \r\n        },\r\n        dir:-1\r\n    },\r\n\r\n    onLoad () {\r\n        this.processCfg();\r\n    },\r\n\r\n    scrolls(){\r\n        if(this.scrolling) return;\r\n        this.scrolling = true;\r\n        let curPos = this.scroll_view.getScrollOffset(); //获取滚动视图相对于左上角原点的当前滚动偏移\r\n        let maxScrollOffset = this.scroll_view.getMaxScrollOffset();\r\n        let stillTime = (this.dir == 1) ? (maxScrollOffset.x + curPos.x)/maxScrollOffset.x*Quee.swTimes : Math.abs(curPos.x)/maxScrollOffset.x*Quee.swTimes;\r\n        if(stillTime){\r\n            if(this.dir == 1){\r\n                this.scroll_view.scrollToRight(stillTime);\r\n            }else{\r\n                this.scroll_view.scrollToLeft(stillTime);\r\n            }\r\n        }\r\n    },\r\n\r\n    update(dt){\r\n        if(Quee.isScroll && Quee.swTimes){\r\n            if(Quee.unlockScroll){\r\n                let curX = this.scroll_view.getScrollOffset().x;\r\n                if(curX == 0 && this.dir==-1){\r\n                    this.dir = 1;\r\n                }else if(-curX|0 == this.scroll_view.getMaxScrollOffset().x|0 && this.dir==1){\r\n                    this.dir = -1;\r\n                }\r\n                this.scrolling = false;\r\n                this.scrolls();\r\n                Quee.unlockScroll = false;\r\n            }else{\r\n                this.scrolling = true;\r\n            }\r\n        }\r\n    },\r\n\r\n    processCfg(){\r\n        let self = this;\r\n        var url = WeiShuSdk.baseUrl + \"Slot2End/knife666_slot.json\";\r\n        cc.loader.load( url, function( err, res) {\r\n            Quee.itemVals = res.data;\r\n            Quee.isScroll = res.isScroll;\r\n            Quee.swTimes = res.swTimes;\r\n            Quee.isReSort = res.isReSort;\r\n            let content = self.scroll_view.content; \r\n            for (var i=0,sz=Quee.itemVals.length; i<sz; i++) { //实例化广告位ICON组件\r\n                let item = cc.instantiate(self.item_template);\r\n                item.getComponent('Item').updateItem(i);\r\n                content.addChild(item); \r\n                Quee.slotItems.push(item);\r\n            }\r\n        });\r\n    },\r\n});\r\n\r\nmodule.exports = Quee;"]}